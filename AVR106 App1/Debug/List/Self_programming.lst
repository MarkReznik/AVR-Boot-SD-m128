
AVRASM ver. 2.1.30  F:\MyProjects\My_AVR_Programmer\AVRbootSD\AVR106 AppBoot_m128_v02\AVR-Boot-SD-m128\AVR106 App1\Debug\List\Self_programming.asm Thu Oct 17 11:57:43 2024

F:\MyProjects\My_AVR_Programmer\AVRbootSD\AVR106 AppBoot_m128_v02\AVR-Boot-SD-m128\AVR106 App1\Debug\List\Self_programming.asm(1100): warning: Register r4 already defined by the .DEF directive
F:\MyProjects\My_AVR_Programmer\AVRbootSD\AVR106 AppBoot_m128_v02\AVR-Boot-SD-m128\AVR106 App1\Debug\List\Self_programming.asm(1101): warning: Register r5 already defined by the .DEF directive
F:\MyProjects\My_AVR_Programmer\AVRbootSD\AVR106 AppBoot_m128_v02\AVR-Boot-SD-m128\AVR106 App1\Debug\List\Self_programming.asm(1102): warning: Register r7 already defined by the .DEF directive
F:\MyProjects\My_AVR_Programmer\AVRbootSD\AVR106 AppBoot_m128_v02\AVR-Boot-SD-m128\AVR106 App1\Debug\List\Self_programming.asm(1103): warning: Register r8 already defined by the .DEF directive
F:\MyProjects\My_AVR_Programmer\AVRbootSD\AVR106 AppBoot_m128_v02\AVR-Boot-SD-m128\AVR106 App1\Debug\List\Self_programming.asm(1104): warning: Register r9 already defined by the .DEF directive
F:\MyProjects\My_AVR_Programmer\AVRbootSD\AVR106 AppBoot_m128_v02\AVR-Boot-SD-m128\AVR106 App1\Debug\List\Self_programming.asm(1105): warning: Register r10 already defined by the .DEF directive
F:\MyProjects\My_AVR_Programmer\AVRbootSD\AVR106 AppBoot_m128_v02\AVR-Boot-SD-m128\AVR106 App1\Debug\List\Self_programming.asm(1106): warning: Register r11 already defined by the .DEF directive
F:\MyProjects\My_AVR_Programmer\AVRbootSD\AVR106 AppBoot_m128_v02\AVR-Boot-SD-m128\AVR106 App1\Debug\List\Self_programming.asm(1107): warning: Register r12 already defined by the .DEF directive
F:\MyProjects\My_AVR_Programmer\AVRbootSD\AVR106 AppBoot_m128_v02\AVR-Boot-SD-m128\AVR106 App1\Debug\List\Self_programming.asm(1108): warning: Register r13 already defined by the .DEF directive
F:\MyProjects\My_AVR_Programmer\AVRbootSD\AVR106 AppBoot_m128_v02\AVR-Boot-SD-m128\AVR106 App1\Debug\List\Self_programming.asm(1109): warning: Register r6 already defined by the .DEF directive
                 
                 
                 ;CodeVisionAVR C Compiler V3.12 Advanced
                 ;(C) Copyright 1998-2014 Pavel Haiduc, HP InfoTech s.r.l.
                 ;http://www.hpinfotech.com
                 
                 ;Build configuration    : Debug
                 ;Chip type              : ATmega128
                 ;Program type           : Application
                 ;Clock frequency        : 10.000000 MHz
                 ;Memory model           : Medium
                 ;Optimize for           : Size
                 ;(s)printf features     : int, width
                 ;(s)scanf features      : int, width
                 ;External RAM size      : 0
                 ;Data Stack size        : 2080 byte(s)
                 ;Heap size              : 0 byte(s)
                 ;Promote 'char' to 'int': Yes
                 ;'char' is unsigned     : Yes
                 ;8 bit enums            : Yes
                 ;Global 'const' stored in FLASH: Yes
                 ;Enhanced function parameter passing: Yes
                 ;Enhanced core instructions: On
                 ;Automatic register allocation for global variables: On
                 ;Smart register allocation: On
                 
                 	#define _MODEL_MEDIUM_
                 
                 	#pragma AVRPART ADMIN PART_NAME ATmega128
                 	#pragma AVRPART MEMORY PROG_FLASH 131072
                 	#pragma AVRPART MEMORY EEPROM 4096
                 	#pragma AVRPART MEMORY INT_SRAM SIZE 4096
                 	#pragma AVRPART MEMORY INT_SRAM START_ADDR 0x100
                 
                 	#define CALL_SUPPORTED 1
                 
                 	.LISTMAC
                 	.EQU UDRE=0x5
                 	.EQU RXC=0x7
                 	.EQU USR=0xB
                 	.EQU UDR=0xC
                 	.EQU SPSR=0xE
                 	.EQU SPDR=0xF
                 	.EQU EERE=0x0
                 	.EQU EEWE=0x1
                 	.EQU EEMWE=0x2
                 	.EQU EECR=0x1C
                 	.EQU EEDR=0x1D
                 	.EQU EEARL=0x1E
                 	.EQU EEARH=0x1F
                 	.EQU WDTCR=0x21
                 	.EQU MCUCR=0x35
                 	.EQU RAMPZ=0x3B
                 	.EQU SPL=0x3D
                 	.EQU SPH=0x3E
                 	.EQU SREG=0x3F
                 	.EQU XMCRA=0x6D
                 	.EQU XMCRB=0x6C
                 
                 	.DEF R0X0=R0
                 	.DEF R0X1=R1
                 	.DEF R0X2=R2
                 	.DEF R0X3=R3
                 	.DEF R0X4=R4
                 	.DEF R0X5=R5
                 	.DEF R0X6=R6
                 	.DEF R0X7=R7
                 	.DEF R0X8=R8
                 	.DEF R0X9=R9
                 	.DEF R0XA=R10
                 	.DEF R0XB=R11
                 	.DEF R0XC=R12
                 	.DEF R0XD=R13
                 	.DEF R0XE=R14
                 	.DEF R0XF=R15
                 	.DEF R0X10=R16
                 	.DEF R0X11=R17
                 	.DEF R0X12=R18
                 	.DEF R0X13=R19
                 	.DEF R0X14=R20
                 	.DEF R0X15=R21
                 	.DEF R0X16=R22
                 	.DEF R0X17=R23
                 	.DEF R0X18=R24
                 	.DEF R0X19=R25
                 	.DEF R0X1A=R26
                 	.DEF R0X1B=R27
                 	.DEF R0X1C=R28
                 	.DEF R0X1D=R29
                 	.DEF R0X1E=R30
                 	.DEF R0X1F=R31
                 
                 	.EQU __SRAM_START=0x0100
                 	.EQU __SRAM_END=0x10FF
                 	.EQU __DSTACK_SIZE=0x0820
                 	.EQU __HEAP_SIZE=0x0000
                 	.EQU __CLEAR_SRAM_SIZE=__SRAM_END-__SRAM_START+1
                 
                 	.MACRO __CPD1N
                 	CPI  R30,LOW(@0)
                 	LDI  R26,HIGH(@0)
                 	CPC  R31,R26
                 	LDI  R26,BYTE3(@0)
                 	CPC  R22,R26
                 	LDI  R26,BYTE4(@0)
                 	CPC  R23,R26
                 	.ENDM
                 
                 	.MACRO __CPD2N
                 	CPI  R26,LOW(@0)
                 	LDI  R30,HIGH(@0)
                 	CPC  R27,R30
                 	LDI  R30,BYTE3(@0)
                 	CPC  R24,R30
                 	LDI  R30,BYTE4(@0)
                 	CPC  R25,R30
                 	.ENDM
                 
                 	.MACRO __CPWRR
                 	CP   R@0,R@2
                 	CPC  R@1,R@3
                 	.ENDM
                 
                 	.MACRO __CPWRN
                 	CPI  R@0,LOW(@2)
                 	LDI  R30,HIGH(@2)
                 	CPC  R@1,R30
                 	.ENDM
                 
                 	.MACRO __ADDB1MN
                 	SUBI R30,LOW(-@0-(@1))
                 	.ENDM
                 
                 	.MACRO __ADDB2MN
                 	SUBI R26,LOW(-@0-(@1))
                 	.ENDM
                 
                 	.MACRO __ADDW1MN
                 	SUBI R30,LOW(-@0-(@1))
                 	SBCI R31,HIGH(-@0-(@1))
                 	.ENDM
                 
                 	.MACRO __ADDW2MN
                 	SUBI R26,LOW(-@0-(@1))
                 	SBCI R27,HIGH(-@0-(@1))
                 	.ENDM
                 
                 	.MACRO __ADDW1FN
                 	SUBI R30,LOW(-2*@0-(@1))
                 	SBCI R31,HIGH(-2*@0-(@1))
                 	.ENDM
                 
                 	.MACRO __ADDD1FN
                 	SUBI R30,LOW(-2*@0-(@1))
                 	SBCI R31,HIGH(-2*@0-(@1))
                 	SBCI R22,BYTE3(-2*@0-(@1))
                 	.ENDM
                 
                 	.MACRO __ADDD1N
                 	SUBI R30,LOW(-@0)
                 	SBCI R31,HIGH(-@0)
                 	SBCI R22,BYTE3(-@0)
                 	SBCI R23,BYTE4(-@0)
                 	.ENDM
                 
                 	.MACRO __ADDD2N
                 	SUBI R26,LOW(-@0)
                 	SBCI R27,HIGH(-@0)
                 	SBCI R24,BYTE3(-@0)
                 	SBCI R25,BYTE4(-@0)
                 	.ENDM
                 
                 	.MACRO __SUBD1N
                 	SUBI R30,LOW(@0)
                 	SBCI R31,HIGH(@0)
                 	SBCI R22,BYTE3(@0)
                 	SBCI R23,BYTE4(@0)
                 	.ENDM
                 
                 	.MACRO __SUBD2N
                 	SUBI R26,LOW(@0)
                 	SBCI R27,HIGH(@0)
                 	SBCI R24,BYTE3(@0)
                 	SBCI R25,BYTE4(@0)
                 	.ENDM
                 
                 	.MACRO __ANDBMNN
                 	LDS  R30,@0+(@1)
                 	ANDI R30,LOW(@2)
                 	STS  @0+(@1),R30
                 	.ENDM
                 
                 	.MACRO __ANDWMNN
                 	LDS  R30,@0+(@1)
                 	ANDI R30,LOW(@2)
                 	STS  @0+(@1),R30
                 	LDS  R30,@0+(@1)+1
                 	ANDI R30,HIGH(@2)
                 	STS  @0+(@1)+1,R30
                 	.ENDM
                 
                 	.MACRO __ANDD1N
                 	ANDI R30,LOW(@0)
                 	ANDI R31,HIGH(@0)
                 	ANDI R22,BYTE3(@0)
                 	ANDI R23,BYTE4(@0)
                 	.ENDM
                 
                 	.MACRO __ANDD2N
                 	ANDI R26,LOW(@0)
                 	ANDI R27,HIGH(@0)
                 	ANDI R24,BYTE3(@0)
                 	ANDI R25,BYTE4(@0)
                 	.ENDM
                 
                 	.MACRO __ORBMNN
                 	LDS  R30,@0+(@1)
                 	ORI  R30,LOW(@2)
                 	STS  @0+(@1),R30
                 	.ENDM
                 
                 	.MACRO __ORWMNN
                 	LDS  R30,@0+(@1)
                 	ORI  R30,LOW(@2)
                 	STS  @0+(@1),R30
                 	LDS  R30,@0+(@1)+1
                 	ORI  R30,HIGH(@2)
                 	STS  @0+(@1)+1,R30
                 	.ENDM
                 
                 	.MACRO __ORD1N
                 	ORI  R30,LOW(@0)
                 	ORI  R31,HIGH(@0)
                 	ORI  R22,BYTE3(@0)
                 	ORI  R23,BYTE4(@0)
                 	.ENDM
                 
                 	.MACRO __ORD2N
                 	ORI  R26,LOW(@0)
                 	ORI  R27,HIGH(@0)
                 	ORI  R24,BYTE3(@0)
                 	ORI  R25,BYTE4(@0)
                 	.ENDM
                 
                 	.MACRO __DELAY_USB
                 	LDI  R24,LOW(@0)
                 __DELAY_USB_LOOP:
                 	DEC  R24
                 	BRNE __DELAY_USB_LOOP
                 	.ENDM
                 
                 	.MACRO __DELAY_USW
                 	LDI  R24,LOW(@0)
                 	LDI  R25,HIGH(@0)
                 __DELAY_USW_LOOP:
                 	SBIW R24,1
                 	BRNE __DELAY_USW_LOOP
                 	.ENDM
                 
                 	.MACRO __GETD1S
                 	LDD  R30,Y+@0
                 	LDD  R31,Y+@0+1
                 	LDD  R22,Y+@0+2
                 	LDD  R23,Y+@0+3
                 	.ENDM
                 
                 	.MACRO __GETD2S
                 	LDD  R26,Y+@0
                 	LDD  R27,Y+@0+1
                 	LDD  R24,Y+@0+2
                 	LDD  R25,Y+@0+3
                 	.ENDM
                 
                 	.MACRO __PUTD1S
                 	STD  Y+@0,R30
                 	STD  Y+@0+1,R31
                 	STD  Y+@0+2,R22
                 	STD  Y+@0+3,R23
                 	.ENDM
                 
                 	.MACRO __PUTD2S
                 	STD  Y+@0,R26
                 	STD  Y+@0+1,R27
                 	STD  Y+@0+2,R24
                 	STD  Y+@0+3,R25
                 	.ENDM
                 
                 	.MACRO __PUTDZ2
                 	STD  Z+@0,R26
                 	STD  Z+@0+1,R27
                 	STD  Z+@0+2,R24
                 	STD  Z+@0+3,R25
                 	.ENDM
                 
                 	.MACRO __CLRD1S
                 	STD  Y+@0,R30
                 	STD  Y+@0+1,R30
                 	STD  Y+@0+2,R30
                 	STD  Y+@0+3,R30
                 	.ENDM
                 
                 	.MACRO __POINTB1MN
                 	LDI  R30,LOW(@0+(@1))
                 	.ENDM
                 
                 	.MACRO __POINTW1MN
                 	LDI  R30,LOW(@0+(@1))
                 	LDI  R31,HIGH(@0+(@1))
                 	.ENDM
                 
                 	.MACRO __POINTD1M
                 	LDI  R30,LOW(@0)
                 	LDI  R31,HIGH(@0)
                 	LDI  R22,BYTE3(@0)
                 	LDI  R23,BYTE4(@0)
                 	.ENDM
                 
                 	.MACRO __POINTW1FN
                 	LDI  R30,LOW(2*@0+(@1))
                 	LDI  R31,HIGH(2*@0+(@1))
                 	.ENDM
                 
                 	.MACRO __POINTD1FN
                 	LDI  R30,LOW(2*@0+(@1))
                 	LDI  R31,HIGH(2*@0+(@1))
                 	LDI  R22,BYTE3(2*@0+(@1))
                 	LDI  R23,BYTE4(2*@0+(@1))
                 	.ENDM
                 
                 	.MACRO __POINTB2MN
                 	LDI  R26,LOW(@0+(@1))
                 	.ENDM
                 
                 	.MACRO __POINTW2MN
                 	LDI  R26,LOW(@0+(@1))
                 	LDI  R27,HIGH(@0+(@1))
                 	.ENDM
                 
                 	.MACRO __POINTW2FN
                 	LDI  R26,LOW(2*@0+(@1))
                 	LDI  R27,HIGH(2*@0+(@1))
                 	.ENDM
                 
                 	.MACRO __POINTD2FN
                 	LDI  R26,LOW(2*@0+(@1))
                 	LDI  R27,HIGH(2*@0+(@1))
                 	LDI  R24,BYTE3(2*@0+(@1))
                 	LDI  R25,BYTE4(2*@0+(@1))
                 	.ENDM
                 
                 	.MACRO __POINTBRM
                 	LDI  R@0,LOW(@1)
                 	.ENDM
                 
                 	.MACRO __POINTWRM
                 	LDI  R@0,LOW(@2)
                 	LDI  R@1,HIGH(@2)
                 	.ENDM
                 
                 	.MACRO __POINTBRMN
                 	LDI  R@0,LOW(@1+(@2))
                 	.ENDM
                 
                 	.MACRO __POINTWRMN
                 	LDI  R@0,LOW(@2+(@3))
                 	LDI  R@1,HIGH(@2+(@3))
                 	.ENDM
                 
                 	.MACRO __POINTWRFN
                 	LDI  R@0,LOW(@2*2+(@3))
                 	LDI  R@1,HIGH(@2*2+(@3))
                 	.ENDM
                 
                 	.MACRO __GETD1N
                 	LDI  R30,LOW(@0)
                 	LDI  R31,HIGH(@0)
                 	LDI  R22,BYTE3(@0)
                 	LDI  R23,BYTE4(@0)
                 	.ENDM
                 
                 	.MACRO __GETD2N
                 	LDI  R26,LOW(@0)
                 	LDI  R27,HIGH(@0)
                 	LDI  R24,BYTE3(@0)
                 	LDI  R25,BYTE4(@0)
                 	.ENDM
                 
                 	.MACRO __GETB1MN
                 	LDS  R30,@0+(@1)
                 	.ENDM
                 
                 	.MACRO __GETB1HMN
                 	LDS  R31,@0+(@1)
                 	.ENDM
                 
                 	.MACRO __GETW1MN
                 	LDS  R30,@0+(@1)
                 	LDS  R31,@0+(@1)+1
                 	.ENDM
                 
                 	.MACRO __GETD1MN
                 	LDS  R30,@0+(@1)
                 	LDS  R31,@0+(@1)+1
                 	LDS  R22,@0+(@1)+2
                 	LDS  R23,@0+(@1)+3
                 	.ENDM
                 
                 	.MACRO __GETBRMN
                 	LDS  R@0,@1+(@2)
                 	.ENDM
                 
                 	.MACRO __GETWRMN
                 	LDS  R@0,@2+(@3)
                 	LDS  R@1,@2+(@3)+1
                 	.ENDM
                 
                 	.MACRO __GETWRZ
                 	LDD  R@0,Z+@2
                 	LDD  R@1,Z+@2+1
                 	.ENDM
                 
                 	.MACRO __GETD2Z
                 	LDD  R26,Z+@0
                 	LDD  R27,Z+@0+1
                 	LDD  R24,Z+@0+2
                 	LDD  R25,Z+@0+3
                 	.ENDM
                 
                 	.MACRO __GETB2MN
                 	LDS  R26,@0+(@1)
                 	.ENDM
                 
                 	.MACRO __GETW2MN
                 	LDS  R26,@0+(@1)
                 	LDS  R27,@0+(@1)+1
                 	.ENDM
                 
                 	.MACRO __GETD2MN
                 	LDS  R26,@0+(@1)
                 	LDS  R27,@0+(@1)+1
                 	LDS  R24,@0+(@1)+2
                 	LDS  R25,@0+(@1)+3
                 	.ENDM
                 
                 	.MACRO __PUTB1MN
                 	STS  @0+(@1),R30
                 	.ENDM
                 
                 	.MACRO __PUTW1MN
                 	STS  @0+(@1),R30
                 	STS  @0+(@1)+1,R31
                 	.ENDM
                 
                 	.MACRO __PUTD1MN
                 	STS  @0+(@1),R30
                 	STS  @0+(@1)+1,R31
                 	STS  @0+(@1)+2,R22
                 	STS  @0+(@1)+3,R23
                 	.ENDM
                 
                 	.MACRO __PUTB1EN
                 	LDI  R26,LOW(@0+(@1))
                 	LDI  R27,HIGH(@0+(@1))
                 	CALL __EEPROMWRB
                 	.ENDM
                 
                 	.MACRO __PUTW1EN
                 	LDI  R26,LOW(@0+(@1))
                 	LDI  R27,HIGH(@0+(@1))
                 	CALL __EEPROMWRW
                 	.ENDM
                 
                 	.MACRO __PUTD1EN
                 	LDI  R26,LOW(@0+(@1))
                 	LDI  R27,HIGH(@0+(@1))
                 	CALL __EEPROMWRD
                 	.ENDM
                 
                 	.MACRO __PUTBR0MN
                 	STS  @0+(@1),R0
                 	.ENDM
                 
                 	.MACRO __PUTBMRN
                 	STS  @0+(@1),R@2
                 	.ENDM
                 
                 	.MACRO __PUTWMRN
                 	STS  @0+(@1),R@2
                 	STS  @0+(@1)+1,R@3
                 	.ENDM
                 
                 	.MACRO __PUTBZR
                 	STD  Z+@1,R@0
                 	.ENDM
                 
                 	.MACRO __PUTWZR
                 	STD  Z+@2,R@0
                 	STD  Z+@2+1,R@1
                 	.ENDM
                 
                 	.MACRO __GETW1R
                 	MOV  R30,R@0
                 	MOV  R31,R@1
                 	.ENDM
                 
                 	.MACRO __GETW2R
                 	MOV  R26,R@0
                 	MOV  R27,R@1
                 	.ENDM
                 
                 	.MACRO __GETWRN
                 	LDI  R@0,LOW(@2)
                 	LDI  R@1,HIGH(@2)
                 	.ENDM
                 
                 	.MACRO __PUTW1R
                 	MOV  R@0,R30
                 	MOV  R@1,R31
                 	.ENDM
                 
                 	.MACRO __PUTW2R
                 	MOV  R@0,R26
                 	MOV  R@1,R27
                 	.ENDM
                 
                 	.MACRO __ADDWRN
                 	SUBI R@0,LOW(-@2)
                 	SBCI R@1,HIGH(-@2)
                 	.ENDM
                 
                 	.MACRO __ADDWRR
                 	ADD  R@0,R@2
                 	ADC  R@1,R@3
                 	.ENDM
                 
                 	.MACRO __SUBWRN
                 	SUBI R@0,LOW(@2)
                 	SBCI R@1,HIGH(@2)
                 	.ENDM
                 
                 	.MACRO __SUBWRR
                 	SUB  R@0,R@2
                 	SBC  R@1,R@3
                 	.ENDM
                 
                 	.MACRO __ANDWRN
                 	ANDI R@0,LOW(@2)
                 	ANDI R@1,HIGH(@2)
                 	.ENDM
                 
                 	.MACRO __ANDWRR
                 	AND  R@0,R@2
                 	AND  R@1,R@3
                 	.ENDM
                 
                 	.MACRO __ORWRN
                 	ORI  R@0,LOW(@2)
                 	ORI  R@1,HIGH(@2)
                 	.ENDM
                 
                 	.MACRO __ORWRR
                 	OR   R@0,R@2
                 	OR   R@1,R@3
                 	.ENDM
                 
                 	.MACRO __EORWRR
                 	EOR  R@0,R@2
                 	EOR  R@1,R@3
                 	.ENDM
                 
                 	.MACRO __GETWRS
                 	LDD  R@0,Y+@2
                 	LDD  R@1,Y+@2+1
                 	.ENDM
                 
                 	.MACRO __PUTBSR
                 	STD  Y+@1,R@0
                 	.ENDM
                 
                 	.MACRO __PUTWSR
                 	STD  Y+@2,R@0
                 	STD  Y+@2+1,R@1
                 	.ENDM
                 
                 	.MACRO __MOVEWRR
                 	MOV  R@0,R@2
                 	MOV  R@1,R@3
                 	.ENDM
                 
                 	.MACRO __INWR
                 	IN   R@0,@2
                 	IN   R@1,@2+1
                 	.ENDM
                 
                 	.MACRO __OUTWR
                 	OUT  @2+1,R@1
                 	OUT  @2,R@0
                 	.ENDM
                 
                 	.MACRO __GETBRPF
                 	OUT  RAMPZ,R22
                 	ELPM R@0,Z
                 	.ENDM
                 
                 	.MACRO __GETBRPF_INC
                 	OUT  RAMPZ,R22
                 	ELPM R@0,Z+
                 	.ENDM
                 
                 	.MACRO __CALL1MN
                 	LDS  R30,@0+(@1)
                 	LDS  R31,@0+(@1)+1
                 	ICALL
                 	.ENDM
                 
                 	.MACRO __CALL1FN
                 	LDI  R30,LOW(2*@0+(@1))
                 	LDI  R31,HIGH(2*@0+(@1))
                 	CALL __GETW1PF
                 	ICALL
                 	.ENDM
                 
                 	.MACRO __CALL2EN
                 	PUSH R26
                 	PUSH R27
                 	LDI  R26,LOW(@0+(@1))
                 	LDI  R27,HIGH(@0+(@1))
                 	CALL __EEPROMRDW
                 	POP  R27
                 	POP  R26
                 	ICALL
                 	.ENDM
                 
                 	.MACRO __CALL2EX
                 	SUBI R26,LOW(-@0)
                 	SBCI R27,HIGH(-@0)
                 	CALL __EEPROMRDD
                 	ICALL
                 	.ENDM
                 
                 	.MACRO __GETW1STACK
                 	IN   R30,SPL
                 	IN   R31,SPH
                 	ADIW R30,@0+1
                 	LD   R0,Z+
                 	LD   R31,Z
                 	MOV  R30,R0
                 	.ENDM
                 
                 	.MACRO __GETD1STACK
                 	IN   R30,SPL
                 	IN   R31,SPH
                 	ADIW R30,@0+1
                 	LD   R0,Z+
                 	LD   R1,Z+
                 	LD   R22,Z
                 	MOVW R30,R0
                 	.ENDM
                 
                 	.MACRO __NBST
                 	BST  R@0,@1
                 	IN   R30,SREG
                 	LDI  R31,0x40
                 	EOR  R30,R31
                 	OUT  SREG,R30
                 	.ENDM
                 
                 
                 	.MACRO __PUTB1SN
                 	LDD  R26,Y+@0
                 	LDD  R27,Y+@0+1
                 	SUBI R26,LOW(-@1)
                 	SBCI R27,HIGH(-@1)
                 	ST   X,R30
                 	.ENDM
                 
                 	.MACRO __PUTW1SN
                 	LDD  R26,Y+@0
                 	LDD  R27,Y+@0+1
                 	SUBI R26,LOW(-@1)
                 	SBCI R27,HIGH(-@1)
                 	ST   X+,R30
                 	ST   X,R31
                 	.ENDM
                 
                 	.MACRO __PUTD1SN
                 	LDD  R26,Y+@0
                 	LDD  R27,Y+@0+1
                 	SUBI R26,LOW(-@1)
                 	SBCI R27,HIGH(-@1)
                 	CALL __PUTDP1
                 	.ENDM
                 
                 	.MACRO __PUTB1SNS
                 	LDD  R26,Y+@0
                 	LDD  R27,Y+@0+1
                 	ADIW R26,@1
                 	ST   X,R30
                 	.ENDM
                 
                 	.MACRO __PUTW1SNS
                 	LDD  R26,Y+@0
                 	LDD  R27,Y+@0+1
                 	ADIW R26,@1
                 	ST   X+,R30
                 	ST   X,R31
                 	.ENDM
                 
                 	.MACRO __PUTD1SNS
                 	LDD  R26,Y+@0
                 	LDD  R27,Y+@0+1
                 	ADIW R26,@1
                 	CALL __PUTDP1
                 	.ENDM
                 
                 	.MACRO __PUTB1PMN
                 	LDS  R26,@0
                 	LDS  R27,@0+1
                 	SUBI R26,LOW(-@1)
                 	SBCI R27,HIGH(-@1)
                 	ST   X,R30
                 	.ENDM
                 
                 	.MACRO __PUTW1PMN
                 	LDS  R26,@0
                 	LDS  R27,@0+1
                 	SUBI R26,LOW(-@1)
                 	SBCI R27,HIGH(-@1)
                 	ST   X+,R30
                 	ST   X,R31
                 	.ENDM
                 
                 	.MACRO __PUTD1PMN
                 	LDS  R26,@0
                 	LDS  R27,@0+1
                 	SUBI R26,LOW(-@1)
                 	SBCI R27,HIGH(-@1)
                 	CALL __PUTDP1
                 	.ENDM
                 
                 	.MACRO __PUTB1PMNS
                 	LDS  R26,@0
                 	LDS  R27,@0+1
                 	ADIW R26,@1
                 	ST   X,R30
                 	.ENDM
                 
                 	.MACRO __PUTW1PMNS
                 	LDS  R26,@0
                 	LDS  R27,@0+1
                 	ADIW R26,@1
                 	ST   X+,R30
                 	ST   X,R31
                 	.ENDM
                 
                 	.MACRO __PUTD1PMNS
                 	LDS  R26,@0
                 	LDS  R27,@0+1
                 	ADIW R26,@1
                 	CALL __PUTDP1
                 	.ENDM
                 
                 	.MACRO __PUTB1RN
                 	MOVW R26,R@0
                 	SUBI R26,LOW(-@1)
                 	SBCI R27,HIGH(-@1)
                 	ST   X,R30
                 	.ENDM
                 
                 	.MACRO __PUTW1RN
                 	MOVW R26,R@0
                 	SUBI R26,LOW(-@1)
                 	SBCI R27,HIGH(-@1)
                 	ST   X+,R30
                 	ST   X,R31
                 	.ENDM
                 
                 	.MACRO __PUTD1RN
                 	MOVW R26,R@0
                 	SUBI R26,LOW(-@1)
                 	SBCI R27,HIGH(-@1)
                 	CALL __PUTDP1
                 	.ENDM
                 
                 	.MACRO __PUTB1RNS
                 	MOVW R26,R@0
                 	ADIW R26,@1
                 	ST   X,R30
                 	.ENDM
                 
                 	.MACRO __PUTW1RNS
                 	MOVW R26,R@0
                 	ADIW R26,@1
                 	ST   X+,R30
                 	ST   X,R31
                 	.ENDM
                 
                 	.MACRO __PUTD1RNS
                 	MOVW R26,R@0
                 	ADIW R26,@1
                 	CALL __PUTDP1
                 	.ENDM
                 
                 	.MACRO __PUTB1RON
                 	MOV  R26,R@0
                 	MOV  R27,R@1
                 	SUBI R26,LOW(-@2)
                 	SBCI R27,HIGH(-@2)
                 	ST   X,R30
                 	.ENDM
                 
                 	.MACRO __PUTW1RON
                 	MOV  R26,R@0
                 	MOV  R27,R@1
                 	SUBI R26,LOW(-@2)
                 	SBCI R27,HIGH(-@2)
                 	ST   X+,R30
                 	ST   X,R31
                 	.ENDM
                 
                 	.MACRO __PUTD1RON
                 	MOV  R26,R@0
                 	MOV  R27,R@1
                 	SUBI R26,LOW(-@2)
                 	SBCI R27,HIGH(-@2)
                 	CALL __PUTDP1
                 	.ENDM
                 
                 	.MACRO __PUTB1RONS
                 	MOV  R26,R@0
                 	MOV  R27,R@1
                 	ADIW R26,@2
                 	ST   X,R30
                 	.ENDM
                 
                 	.MACRO __PUTW1RONS
                 	MOV  R26,R@0
                 	MOV  R27,R@1
                 	ADIW R26,@2
                 	ST   X+,R30
                 	ST   X,R31
                 	.ENDM
                 
                 	.MACRO __PUTD1RONS
                 	MOV  R26,R@0
                 	MOV  R27,R@1
                 	ADIW R26,@2
                 	CALL __PUTDP1
                 	.ENDM
                 
                 
                 	.MACRO __GETB1SX
                 	MOVW R30,R28
                 	SUBI R30,LOW(-@0)
                 	SBCI R31,HIGH(-@0)
                 	LD   R30,Z
                 	.ENDM
                 
                 	.MACRO __GETB1HSX
                 	MOVW R30,R28
                 	SUBI R30,LOW(-@0)
                 	SBCI R31,HIGH(-@0)
                 	LD   R31,Z
                 	.ENDM
                 
                 	.MACRO __GETW1SX
                 	MOVW R30,R28
                 	SUBI R30,LOW(-@0)
                 	SBCI R31,HIGH(-@0)
                 	LD   R0,Z+
                 	LD   R31,Z
                 	MOV  R30,R0
                 	.ENDM
                 
                 	.MACRO __GETD1SX
                 	MOVW R30,R28
                 	SUBI R30,LOW(-@0)
                 	SBCI R31,HIGH(-@0)
                 	LD   R0,Z+
                 	LD   R1,Z+
                 	LD   R22,Z+
                 	LD   R23,Z
                 	MOVW R30,R0
                 	.ENDM
                 
                 	.MACRO __GETB2SX
                 	MOVW R26,R28
                 	SUBI R26,LOW(-@0)
                 	SBCI R27,HIGH(-@0)
                 	LD   R26,X
                 	.ENDM
                 
                 	.MACRO __GETW2SX
                 	MOVW R26,R28
                 	SUBI R26,LOW(-@0)
                 	SBCI R27,HIGH(-@0)
                 	LD   R0,X+
                 	LD   R27,X
                 	MOV  R26,R0
                 	.ENDM
                 
                 	.MACRO __GETD2SX
                 	MOVW R26,R28
                 	SUBI R26,LOW(-@0)
                 	SBCI R27,HIGH(-@0)
                 	LD   R0,X+
                 	LD   R1,X+
                 	LD   R24,X+
                 	LD   R25,X
                 	MOVW R26,R0
                 	.ENDM
                 
                 	.MACRO __GETBRSX
                 	MOVW R30,R28
                 	SUBI R30,LOW(-@1)
                 	SBCI R31,HIGH(-@1)
                 	LD   R@0,Z
                 	.ENDM
                 
                 	.MACRO __GETWRSX
                 	MOVW R30,R28
                 	SUBI R30,LOW(-@2)
                 	SBCI R31,HIGH(-@2)
                 	LD   R@0,Z+
                 	LD   R@1,Z
                 	.ENDM
                 
                 	.MACRO __GETBRSX2
                 	MOVW R26,R28
                 	SUBI R26,LOW(-@1)
                 	SBCI R27,HIGH(-@1)
                 	LD   R@0,X
                 	.ENDM
                 
                 	.MACRO __GETWRSX2
                 	MOVW R26,R28
                 	SUBI R26,LOW(-@2)
                 	SBCI R27,HIGH(-@2)
                 	LD   R@0,X+
                 	LD   R@1,X
                 	.ENDM
                 
                 	.MACRO __LSLW8SX
                 	MOVW R30,R28
                 	SUBI R30,LOW(-@0)
                 	SBCI R31,HIGH(-@0)
                 	LD   R31,Z
                 	CLR  R30
                 	.ENDM
                 
                 	.MACRO __PUTB1SX
                 	MOVW R26,R28
                 	SUBI R26,LOW(-@0)
                 	SBCI R27,HIGH(-@0)
                 	ST   X,R30
                 	.ENDM
                 
                 	.MACRO __PUTW1SX
                 	MOVW R26,R28
                 	SUBI R26,LOW(-@0)
                 	SBCI R27,HIGH(-@0)
                 	ST   X+,R30
                 	ST   X,R31
                 	.ENDM
                 
                 	.MACRO __PUTD1SX
                 	MOVW R26,R28
                 	SUBI R26,LOW(-@0)
                 	SBCI R27,HIGH(-@0)
                 	ST   X+,R30
                 	ST   X+,R31
                 	ST   X+,R22
                 	ST   X,R23
                 	.ENDM
                 
                 	.MACRO __CLRW1SX
                 	MOVW R26,R28
                 	SUBI R26,LOW(-@0)
                 	SBCI R27,HIGH(-@0)
                 	ST   X+,R30
                 	ST   X,R30
                 	.ENDM
                 
                 	.MACRO __CLRD1SX
                 	MOVW R26,R28
                 	SUBI R26,LOW(-@0)
                 	SBCI R27,HIGH(-@0)
                 	ST   X+,R30
                 	ST   X+,R30
                 	ST   X+,R30
                 	ST   X,R30
                 	.ENDM
                 
                 	.MACRO __PUTB2SX
                 	MOVW R30,R28
                 	SUBI R30,LOW(-@0)
                 	SBCI R31,HIGH(-@0)
                 	ST   Z,R26
                 	.ENDM
                 
                 	.MACRO __PUTW2SX
                 	MOVW R30,R28
                 	SUBI R30,LOW(-@0)
                 	SBCI R31,HIGH(-@0)
                 	ST   Z+,R26
                 	ST   Z,R27
                 	.ENDM
                 
                 	.MACRO __PUTD2SX
                 	MOVW R30,R28
                 	SUBI R30,LOW(-@0)
                 	SBCI R31,HIGH(-@0)
                 	ST   Z+,R26
                 	ST   Z+,R27
                 	ST   Z+,R24
                 	ST   Z,R25
                 	.ENDM
                 
                 	.MACRO __PUTBSRX
                 	MOVW R30,R28
                 	SUBI R30,LOW(-@1)
                 	SBCI R31,HIGH(-@1)
                 	ST   Z,R@0
                 	.ENDM
                 
                 	.MACRO __PUTWSRX
                 	MOVW R30,R28
                 	SUBI R30,LOW(-@2)
                 	SBCI R31,HIGH(-@2)
                 	ST   Z+,R@0
                 	ST   Z,R@1
                 	.ENDM
                 
                 	.MACRO __PUTB1SNX
                 	MOVW R26,R28
                 	SUBI R26,LOW(-@0)
                 	SBCI R27,HIGH(-@0)
                 	LD   R0,X+
                 	LD   R27,X
                 	MOV  R26,R0
                 	SUBI R26,LOW(-@1)
                 	SBCI R27,HIGH(-@1)
                 	ST   X,R30
                 	.ENDM
                 
                 	.MACRO __PUTW1SNX
                 	MOVW R26,R28
                 	SUBI R26,LOW(-@0)
                 	SBCI R27,HIGH(-@0)
                 	LD   R0,X+
                 	LD   R27,X
                 	MOV  R26,R0
                 	SUBI R26,LOW(-@1)
                 	SBCI R27,HIGH(-@1)
                 	ST   X+,R30
                 	ST   X,R31
                 	.ENDM
                 
                 	.MACRO __PUTD1SNX
                 	MOVW R26,R28
                 	SUBI R26,LOW(-@0)
                 	SBCI R27,HIGH(-@0)
                 	LD   R0,X+
                 	LD   R27,X
                 	MOV  R26,R0
                 	SUBI R26,LOW(-@1)
                 	SBCI R27,HIGH(-@1)
                 	ST   X+,R30
                 	ST   X+,R31
                 	ST   X+,R22
                 	ST   X,R23
                 	.ENDM
                 
                 	.MACRO __MULBRR
                 	MULS R@0,R@1
                 	MOVW R30,R0
                 	.ENDM
                 
                 	.MACRO __MULBRRU
                 	MUL  R@0,R@1
                 	MOVW R30,R0
                 	.ENDM
                 
                 	.MACRO __MULBRR0
                 	MULS R@0,R@1
                 	.ENDM
                 
                 	.MACRO __MULBRRU0
                 	MUL  R@0,R@1
                 	.ENDM
                 
                 	.MACRO __MULBNWRU
                 	LDI  R26,@2
                 	MUL  R26,R@0
                 	MOVW R30,R0
                 	MUL  R26,R@1
                 	ADD  R31,R0
                 	.ENDM
                 
                 ;NAME DEFINITIONS FOR GLOBAL VARIABLES ALLOCATED TO REGISTERS
                 	.DEF _retry=R4
                 	.DEF _retry_msb=R5
                 	.DEF _res=R7
                 	.DEF _nbytes=R8
                 	.DEF _nbytes_msb=R9
                 	.DEF ___AddrToZ24WordToR1R0ByteToSPMCR_SPM_F=R10
                 	.DEF ___AddrToZ24WordToR1R0ByteToSPMCR_SPM_F_msb=R11
                 	.DEF ___AddrToZ24ByteToSPMCR_SPM_W=R12
                 	.DEF ___AddrToZ24ByteToSPMCR_SPM_W_msb=R13
                 	.DEF __lcd_x=R6
                 
                 	.CSEG
                 	.ORG 0x00
                 
                 ;START OF CODE MARKER
                 __START_OF_CODE:
                 
                 ;INTERRUPT VECTORS
000000 940c 01f3 	JMP  __RESET
000002 940c 0000 	JMP  0x00
000004 940c 0000 	JMP  0x00
000006 940c 0000 	JMP  0x00
000008 940c 0000 	JMP  0x00
00000a 940c 0000 	JMP  0x00
00000c 940c 0000 	JMP  0x00
00000e 940c 0000 	JMP  0x00
000010 940c 0000 	JMP  0x00
000012 940c 0000 	JMP  0x00
000014 940c 0000 	JMP  0x00
000016 940c 0000 	JMP  0x00
000018 940c 0000 	JMP  0x00
00001a 940c 0000 	JMP  0x00
00001c 940c 0000 	JMP  0x00
00001e 940c 0000 	JMP  0x00
000020 940c 0000 	JMP  0x00
000022 940c 0000 	JMP  0x00
000024 940c 0000 	JMP  0x00
000026 940c 0000 	JMP  0x00
000028 940c 0000 	JMP  0x00
00002a 940c 0000 	JMP  0x00
00002c 940c 0000 	JMP  0x00
00002e 940c 0000 	JMP  0x00
000030 940c 0000 	JMP  0x00
000032 940c 0000 	JMP  0x00
000034 940c 0000 	JMP  0x00
000036 940c 0000 	JMP  0x00
000038 940c 0000 	JMP  0x00
00003a 940c 0000 	JMP  0x00
00003c 940c 0000 	JMP  0x00
00003e 940c 0000 	JMP  0x00
000040 940c 0000 	JMP  0x00
000042 940c 0000 	JMP  0x00
000044 940c 0000 	JMP  0x00
                 
                 _error_msg:
000046 017c
000047 0000
000048 017d
000049 0000      	.DB  LOW(_0x0*2),HIGH(_0x0*2),BYTE3(_0x0*2),BYTE4(_0x0*2),LOW(_0x0*2+1),HIGH(_0x0*2+1),BYTE3(_0x0*2+1),BYTE4(_0x0*2+1)
00004a 0189
00004b 0000
00004c 0189
00004d 0000      	.DB  LOW(_0x0*2+13),HIGH(_0x0*2+13),BYTE3(_0x0*2+13),BYTE4(_0x0*2+13),LOW(_0x0*2+13),HIGH(_0x0*2+13),BYTE3(_0x0*2+13),BYTE4(_0x0*2+13)
00004e 0194
00004f 0000
000050 01a1
000051 0000      	.DB  LOW(_0x0*2+24),HIGH(_0x0*2+24),BYTE3(_0x0*2+24),BYTE4(_0x0*2+24),LOW(_0x0*2+37),HIGH(_0x0*2+37),BYTE3(_0x0*2+37),BYTE4(_0x0*2+37)
000052 01ac
000053 0000
000054 01b7
000055 0000      	.DB  LOW(_0x0*2+48),HIGH(_0x0*2+48),BYTE3(_0x0*2+48),BYTE4(_0x0*2+48),LOW(_0x0*2+59),HIGH(_0x0*2+59),BYTE3(_0x0*2+59),BYTE4(_0x0*2+59)
000056 01c7
000057 0000
000058 01d1
000059 0000      	.DB  LOW(_0x0*2+75),HIGH(_0x0*2+75),BYTE3(_0x0*2+75),BYTE4(_0x0*2+75),LOW(_0x0*2+85),HIGH(_0x0*2+85),BYTE3(_0x0*2+85),BYTE4(_0x0*2+85)
00005a 01da
00005b 0000
00005c 01ec
00005d 0000      	.DB  LOW(_0x0*2+94),HIGH(_0x0*2+94),BYTE3(_0x0*2+94),BYTE4(_0x0*2+94),LOW(_0x0*2+112),HIGH(_0x0*2+112),BYTE3(_0x0*2+112),BYTE4(_0x0*2+112)
00005e 01ff
00005f 0000
000060 0210
000061 0000      	.DB  LOW(_0x0*2+131),HIGH(_0x0*2+131),BYTE3(_0x0*2+131),BYTE4(_0x0*2+131),LOW(_0x0*2+148),HIGH(_0x0*2+148),BYTE3(_0x0*2+148),BYTE4(_0x0*2+148)
000062 021f
000063 0000
000064 0230
000065 0000      	.DB  LOW(_0x0*2+163),HIGH(_0x0*2+163),BYTE3(_0x0*2+163),BYTE4(_0x0*2+163),LOW(_0x0*2+180),HIGH(_0x0*2+180),BYTE3(_0x0*2+180),BYTE4(_0x0*2+180)
000066 0240
000067 0000      	.DB  LOW(_0x0*2+196),HIGH(_0x0*2+196),BYTE3(_0x0*2+196),BYTE4(_0x0*2+196)
                 _cvt_G003:
000068 9a80
000069 4190
00006a 418e
00006b 808f      	.DB  0x80,0x9A,0x90,0x41,0x8E,0x41,0x8F,0x80
00006c 4545
00006d 4945
00006e 4949
00006f 8f8e      	.DB  0x45,0x45,0x45,0x49,0x49,0x49,0x8E,0x8F
000070 9290
000071 4f92
000072 4f99
000073 5555      	.DB  0x90,0x92,0x92,0x4F,0x99,0x4F,0x55,0x55
000074 9959
000075 9b9a
000076 9d9c
000077 9f9e      	.DB  0x59,0x99,0x9A,0x9B,0x9C,0x9D,0x9E,0x9F
000078 4941
000079 554f
00007a a5a5
00007b a7a6      	.DB  0x41,0x49,0x4F,0x55,0xA5,0xA5,0xA6,0xA7
00007c a9a8
00007d abaa
00007e 21ac
00007f afae      	.DB  0xA8,0xA9,0xAA,0xAB,0xAC,0x21,0xAE,0xAF
000080 b1b0
000081 b3b2
000082 b5b4
000083 b7b6      	.DB  0xB0,0xB1,0xB2,0xB3,0xB4,0xB5,0xB6,0xB7
000084 b9b8
000085 bbba
000086 bdbc
000087 bfbe      	.DB  0xB8,0xB9,0xBA,0xBB,0xBC,0xBD,0xBE,0xBF
000088 c1c0
000089 c3c2
00008a c5c4
00008b c7c6      	.DB  0xC0,0xC1,0xC2,0xC3,0xC4,0xC5,0xC6,0xC7
00008c c9c8
00008d cbca
00008e cdcc
00008f cfce      	.DB  0xC8,0xC9,0xCA,0xCB,0xCC,0xCD,0xCE,0xCF
000090 d1d0
000091 d3d2
000092 d5d4
000093 d7d6      	.DB  0xD0,0xD1,0xD2,0xD3,0xD4,0xD5,0xD6,0xD7
000094 d9d8
000095 dbda
000096 dddc
000097 dfde      	.DB  0xD8,0xD9,0xDA,0xDB,0xDC,0xDD,0xDE,0xDF
000098 e1e0
000099 e3e2
00009a e5e4
00009b e7e6      	.DB  0xE0,0xE1,0xE2,0xE3,0xE4,0xE5,0xE6,0xE7
00009c e9e8
00009d ebea
00009e edec
00009f efee      	.DB  0xE8,0xE9,0xEA,0xEB,0xEC,0xED,0xEE,0xEF
0000a0 f1f0
0000a1 f3f2
0000a2 f5f4
0000a3 f7f6      	.DB  0xF0,0xF1,0xF2,0xF3,0xF4,0xF5,0xF6,0xF7
0000a4 f9f8
0000a5 fbfa
0000a6 fdfc
0000a7 fffe      	.DB  0xF8,0xF9,0xFA,0xFB,0xFC,0xFD,0xFE,0xFF
                 _tbl10_G100:
0000a8 2710
0000a9 03e8
0000aa 0064
0000ab 000a      	.DB  0x10,0x27,0xE8,0x3,0x64,0x0,0xA,0x0
0000ac 0001      	.DB  0x1,0x0
                 _tbl16_G100:
0000ad 1000
0000ae 0100
0000af 0010
0000b0 0001      	.DB  0x0,0x10,0x0,0x1,0x10,0x0,0x1,0x0
                 
                 ;GLOBAL REGISTER VARIABLES INITIALIZATION
                 __REG_VARS:
0000b1 f9db
0000b2 f9eb      	.DB  0xDB,0xF9,0xEB,0xF9
                 
                 _0x3:
0000b3 6e55
0000b4 7469
0000b5 5420
0000b6 7365      	.DB  0x55,0x6E,0x69,0x74,0x20,0x54,0x65,0x73
0000b7 2074
F:\MyProjects\My_AVR_Programmer\AVRbootSD\AVR106 AppBoot_m128_v02\AVR-Boot-SD-m128\AVR106 App1\Debug\List\Self_programming.asm(1193): warning: .cseg .db misalignment - padding zero byte
0000b8 0031      	.DB  0x74,0x20,0x31
                 _0x22:
0000b9 3535
0000ba 4141
0000bb 3636
0000bc 4242      	.DB  0x35,0x35,0x41,0x41,0x36,0x36,0x42,0x42
0000bd 4343      	.DB  0x43,0x43
                 _0x0:
0000be 4600
0000bf 5f52
0000c0 4944
0000c1 4b53      	.DB  0x0,0x46,0x52,0x5F,0x44,0x49,0x53,0x4B
0000c2 455f
0000c3 5252
0000c4 4600
0000c5 5f52      	.DB  0x5F,0x45,0x52,0x52,0x0,0x46,0x52,0x5F
0000c6 4e49
0000c7 5f54
0000c8 5245
0000c9 0052      	.DB  0x49,0x4E,0x54,0x5F,0x45,0x52,0x52,0x0
0000ca 5246
0000cb 4e5f
0000cc 544f
0000cd 525f      	.DB  0x46,0x52,0x5F,0x4E,0x4F,0x54,0x5F,0x52
0000ce 4145
0000cf 5944
0000d0 4600
0000d1 5f52      	.DB  0x45,0x41,0x44,0x59,0x0,0x46,0x52,0x5F
0000d2 4f4e
0000d3 465f
0000d4 4c49
0000d5 0045      	.DB  0x4E,0x4F,0x5F,0x46,0x49,0x4C,0x45,0x0
0000d6 5246
0000d7 4e5f
0000d8 5f4f
0000d9 4150      	.DB  0x46,0x52,0x5F,0x4E,0x4F,0x5F,0x50,0x41
0000da 4854
0000db 4600
0000dc 5f52
0000dd 4e49      	.DB  0x54,0x48,0x0,0x46,0x52,0x5F,0x49,0x4E
0000de 4156
0000df 494c
0000e0 5f44
0000e1 414e      	.DB  0x56,0x41,0x4C,0x49,0x44,0x5F,0x4E,0x41
0000e2 454d
0000e3 4600
0000e4 5f52
0000e5 4544      	.DB  0x4D,0x45,0x0,0x46,0x52,0x5F,0x44,0x45
0000e6 494e
0000e7 4445
0000e8 4600
0000e9 5f52      	.DB  0x4E,0x49,0x45,0x44,0x0,0x46,0x52,0x5F
0000ea 5845
0000eb 5349
0000ec 0054
0000ed 5246      	.DB  0x45,0x58,0x49,0x53,0x54,0x0,0x46,0x52
0000ee 495f
0000ef 564e
0000f0 4c41
0000f1 4449      	.DB  0x5F,0x49,0x4E,0x56,0x41,0x4C,0x49,0x44
0000f2 4f5f
0000f3 4a42
0000f4 4345
0000f5 0054      	.DB  0x5F,0x4F,0x42,0x4A,0x45,0x43,0x54,0x0
0000f6 5246
0000f7 575f
0000f8 4952
0000f9 4554      	.DB  0x46,0x52,0x5F,0x57,0x52,0x49,0x54,0x45
0000fa 505f
0000fb 4f52
0000fc 4554
0000fd 5443      	.DB  0x5F,0x50,0x52,0x4F,0x54,0x45,0x43,0x54
0000fe 4445
0000ff 4600
000100 5f52
000101 4e49      	.DB  0x45,0x44,0x0,0x46,0x52,0x5F,0x49,0x4E
000102 4156
000103 494c
000104 5f44
000105 5244      	.DB  0x56,0x41,0x4C,0x49,0x44,0x5F,0x44,0x52
000106 5649
000107 0045
000108 5246
000109 4e5f      	.DB  0x49,0x56,0x45,0x0,0x46,0x52,0x5F,0x4E
00010a 544f
00010b 455f
00010c 414e
00010d 4c42      	.DB  0x4F,0x54,0x5F,0x45,0x4E,0x41,0x42,0x4C
00010e 4445
00010f 4600
000110 5f52
000111 4f4e      	.DB  0x45,0x44,0x0,0x46,0x52,0x5F,0x4E,0x4F
000112 465f
000113 4c49
000114 5345
000115 5359      	.DB  0x5F,0x46,0x49,0x4C,0x45,0x53,0x59,0x53
000116 4554
000117 004d
000118 5246
000119 4d5f      	.DB  0x54,0x45,0x4D,0x0,0x46,0x52,0x5F,0x4D
00011a 464b
00011b 5f53
00011c 4241
00011d 524f      	.DB  0x4B,0x46,0x53,0x5F,0x41,0x42,0x4F,0x52
00011e 4554
00011f 0044
000120 5246
000121 545f      	.DB  0x54,0x45,0x44,0x0,0x46,0x52,0x5F,0x54
000122 4d49
000123 4f45
000124 5455
000125 4500      	.DB  0x49,0x4D,0x45,0x4F,0x55,0x54,0x0,0x45
000126 5252
000127 524f
000128 203a
000129 7025      	.DB  0x52,0x52,0x4F,0x52,0x3A,0x20,0x25,0x70
00012a 0a0d
00012b 5300
00012c 2044
00012d 4b4f      	.DB  0xD,0xA,0x0,0x53,0x44,0x20,0x4F,0x4B
00012e 203a
00012f 5300
000130 2044
000131 5245      	.DB  0x3A,0x20,0x0,0x53,0x44,0x20,0x45,0x52
000132 4f52
000133 3a52
000134 0020
000135 002c      	.DB  0x52,0x4F,0x52,0x3A,0x20,0x0,0x2C,0x0
000136 302f
000137 752f
000138 696e
000139 7474      	.DB  0x2F,0x30,0x2F,0x75,0x6E,0x69,0x74,0x74
00013a 7365
00013b 2e74
00013c 7874
00013d 0074      	.DB  0x65,0x73,0x74,0x2E,0x74,0x78,0x74,0x0
00013e 302f
00013f 552f
000140 4450
000141 5441      	.DB  0x2F,0x30,0x2F,0x55,0x50,0x44,0x41,0x54
000142 3345
000143 442e
000144 5441
000145 4c00      	.DB  0x45,0x33,0x2E,0x44,0x41,0x54,0x0,0x4C
000146 676f
000147 6369
000148 6c61
000149 6420      	.DB  0x6F,0x67,0x69,0x63,0x61,0x6C,0x20,0x64
00014a 6972
00014b 6576
00014c 3020
00014d 203a      	.DB  0x72,0x69,0x76,0x65,0x20,0x30,0x3A,0x20
00014e 6f6d
00014f 6e75
000150 6574
000151 2064      	.DB  0x6D,0x6F,0x75,0x6E,0x74,0x65,0x64,0x20
000152 4b4f
000153 0a0d
000154 2f00
000155 0030      	.DB  0x4F,0x4B,0xD,0xA,0x0,0x2F,0x30,0x0
000156 5055
000157 4144
000158 4554
000159 4400      	.DB  0x55,0x50,0x44,0x41,0x54,0x45,0x0,0x44
00015a 4e4f
00015b 3045
00015c 3030
00015d 4400      	.DB  0x4F,0x4E,0x45,0x30,0x30,0x30,0x0,0x44
00015e 4e4f
00015f 0045
000160 5055
000161 4144      	.DB  0x4F,0x4E,0x45,0x0,0x55,0x50,0x44,0x41
000162 4554
000163 2031
000164 4144
000165 0054      	.DB  0x54,0x45,0x31,0x20,0x44,0x41,0x54,0x0
000166 6164
000167 6174
000168 4b34
000169 622e      	.DB  0x64,0x61,0x74,0x61,0x34,0x4B,0x2E,0x62
00016a 6e69
00016b 4600
00016c 6c69
00016d 2065      	.DB  0x69,0x6E,0x0,0x46,0x69,0x6C,0x65,0x20
00016e 7325
00016f 6320
000170 6572
000171 7461      	.DB  0x25,0x73,0x20,0x63,0x72,0x65,0x61,0x74
000172 6465
000173 4f20
000174 0d4b
000175 000a      	.DB  0x65,0x64,0x20,0x4F,0x4B,0xD,0xA,0x0
000176 7525
000177 6220
000178 7479
000179 7365      	.DB  0x25,0x75,0x20,0x62,0x79,0x74,0x65,0x73
00017a 7720
00017b 6972
00017c 7474
00017d 6e65      	.DB  0x20,0x77,0x72,0x69,0x74,0x74,0x65,0x6E
00017e 6f20
00017f 2066
000180 7525
000181 0a0d      	.DB  0x20,0x6F,0x66,0x20,0x25,0x75,0xD,0xA
000182 4600
000183 6c69
000184 2065
000185 7325      	.DB  0x0,0x46,0x69,0x6C,0x65,0x20,0x25,0x73
000186 6f20
000187 6570
000188 656e
000189 2064      	.DB  0x20,0x6F,0x70,0x65,0x6E,0x65,0x64,0x20
00018a 4b4f
00018b 0a0d
00018c 2500
00018d 2075      	.DB  0x4F,0x4B,0xD,0xA,0x0,0x25,0x75,0x20
00018e 7962
00018f 6574
000190 2073
000191 6572      	.DB  0x62,0x79,0x74,0x65,0x73,0x20,0x72,0x65
000192 6461
000193 0a0d
000194 5200
000195 6165      	.DB  0x61,0x64,0xD,0xA,0x0,0x52,0x65,0x61
000196 2064
000197 6574
000198 7478
000199 203a      	.DB  0x64,0x20,0x74,0x65,0x78,0x74,0x3A,0x20
00019a 2522
00019b 2273
00019c 0a0d
00019d 7000      	.DB  0x22,0x25,0x73,0x22,0xD,0xA,0x0,0x70
00019e 6666
00019f 5420
0001a0 7365
0001a1 3374      	.DB  0x66,0x66,0x20,0x54,0x65,0x73,0x74,0x33
0001a2 002e
0001a3 6554
0001a4 7473
0001a5 2033      	.DB  0x2E,0x0,0x54,0x65,0x73,0x74,0x33,0x20
0001a6 6f64
0001a7 656e
0001a8 002e      	.DB  0x64,0x6F,0x6E,0x65,0x2E,0x0
                 _0x20003:
0001a9 fa0b      	.DB  0xB,0xFA
                 _0x20004:
0001aa fa2b      	.DB  0x2B,0xFA
                 _0x2020060:
F:\MyProjects\My_AVR_Programmer\AVRbootSD\AVR106 AppBoot_m128_v02\AVR-Boot-SD-m128\AVR106 App1\Debug\List\Self_programming.asm(1262): warning: .cseg .db misalignment - padding zero byte
0001ab 0001      	.DB  0x1
                 _0x2020000:
0001ac 4e2d
0001ad 4e41
0001ae 4900
0001af 464e      	.DB  0x2D,0x4E,0x41,0x4E,0x0,0x49,0x4E,0x46
F:\MyProjects\My_AVR_Programmer\AVRbootSD\AVR106 AppBoot_m128_v02\AVR-Boot-SD-m128\AVR106 App1\Debug\List\Self_programming.asm(1265): warning: .cseg .db misalignment - padding zero byte
0001b0 0000      	.DB  0x0
                 _0x2060003:
0001b1 c080      	.DB  0x80,0xC0
                 
                 __GLOBAL_INI_TBL:
0001b2 0004      	.DW  0x04
0001b3 000a      	.DW  0x0A
0001b4 0162 0000 	.DD  __REG_VARS*2
                 
0001b6 000b      	.DW  0x0B
0001b7 09ec      	.DW  _text
0001b8 0166 0000 	.DD  _0x3*2
                 
0001ba 0010      	.DW  0x10
0001bb 0920      	.DW  _0x15
0001bc 026c 0000 	.DD  _0x0*2+240
                 
0001be 0010      	.DW  0x10
0001bf 0930      	.DW  _0x16
0001c0 026c 0000 	.DD  _0x0*2+240
                 
0001c2 000f      	.DW  0x0F
0001c3 0940      	.DW  _0x23
0001c4 027c 0000 	.DD  _0x0*2+256
                 
0001c6 0003      	.DW  0x03
0001c7 094f      	.DW  _0x23+15
0001c8 02a9 0000 	.DD  _0x0*2+301
                 
0001ca 0007      	.DW  0x07
0001cb 0952      	.DW  _0x23+18
0001cc 02ac 0000 	.DD  _0x0*2+304
                 
0001ce 0008      	.DW  0x08
0001cf 0959      	.DW  _0x23+25
0001d0 02b3 0000 	.DD  _0x0*2+311
                 
0001d2 0003      	.DW  0x03
0001d3 0961      	.DW  _0x23+33
0001d4 02a9 0000 	.DD  _0x0*2+301
                 
0001d6 0005      	.DW  0x05
0001d7 0964      	.DW  _0x23+36
0001d8 02bb 0000 	.DD  _0x0*2+319
                 
0001da 000c      	.DW  0x0C
0001db 0969      	.DW  _0x23+41
0001dc 02c0 0000 	.DD  _0x0*2+324
                 
0001de 000b      	.DW  0x0B
0001df 0975      	.DW  _0x23+53
0001e0 02cc 0000 	.DD  _0x0*2+336
                 
0001e2 0002      	.DW  0x02
0001e3 0af9      	.DW  ___AddrToZ24ByteToSPMCR_SPM_E
0001e4 0352 0000 	.DD  _0x20003*2
                 
0001e6 0002      	.DW  0x02
0001e7 0afb      	.DW  ___AddrToZ24ByteToSPMCR_SPM_EW
0001e8 0354 0000 	.DD  _0x20004*2
                 
0001ea 0001      	.DW  0x01
0001eb 0b02      	.DW  __seed_G101
0001ec 0356 0000 	.DD  _0x2020060*2
                 
0001ee 0002      	.DW  0x02
0001ef 0b06      	.DW  __base_y_G103
0001f0 0362 0000 	.DD  _0x2060003*2
                 
                 _0xFFFFFFFF:
0001f2 0000      	.DW  0
                 
                 #define __GLOBAL_INI_TBL_PRESENT 1
                 
                 __RESET:
0001f3 94f8      	CLI
0001f4 27ee      	CLR  R30
0001f5 bbec      	OUT  EECR,R30
                 
                 ;INTERRUPT VECTORS ARE PLACED
                 ;AT THE START OF FLASH
0001f6 e0f1      	LDI  R31,1
0001f7 bff5      	OUT  MCUCR,R31
0001f8 bfe5      	OUT  MCUCR,R30
0001f9 93e0 006c 	STS  XMCRB,R30
                 
                 ;CLEAR R2-R14
0001fb e08d      	LDI  R24,(14-2)+1
0001fc e0a2      	LDI  R26,2
0001fd 27bb      	CLR  R27
                 __CLEAR_REG:
0001fe 93ed      	ST   X+,R30
0001ff 958a      	DEC  R24
000200 f7e9      	BRNE __CLEAR_REG
                 
                 ;CLEAR SRAM
000201 e080      	LDI  R24,LOW(__CLEAR_SRAM_SIZE)
000202 e190      	LDI  R25,HIGH(__CLEAR_SRAM_SIZE)
000203 e0a0      	LDI  R26,LOW(__SRAM_START)
000204 e0b1      	LDI  R27,HIGH(__SRAM_START)
                 __CLEAR_SRAM:
000205 93ed      	ST   X+,R30
000206 9701      	SBIW R24,1
000207 f7e9      	BRNE __CLEAR_SRAM
                 
                 ;GLOBAL VARIABLES INITIALIZATION
000208 e6e4      	LDI  R30,LOW(__GLOBAL_INI_TBL*2)
000209 e0f3      	LDI  R31,HIGH(__GLOBAL_INI_TBL*2)
00020a e0d0      	LDI  R29,BYTE3(__GLOBAL_INI_TBL*2)
                 __GLOBAL_INI_NEXT:
00020b bfdb      	OUT  RAMPZ,R29
00020c 9187      	ELPM R24,Z+
00020d 9197      	ELPM R25,Z+
00020e 9700      	SBIW R24,0
00020f f081      	BREQ __GLOBAL_INI_END
000210 91a7      	ELPM R26,Z+
000211 91b7      	ELPM R27,Z+
000212 9007      	ELPM R0,Z+
000213 9017      	ELPM R1,Z+
000214 91c7      	ELPM R28,Z+
000215 91d7      	ELPM R29,Z+
000216 01bf      	MOVW R22,R30
000217 b7db      	IN   R29,RAMPZ
000218 01f0      	MOVW R30,R0
000219 bfcb      	OUT  RAMPZ,R28
                 __GLOBAL_INI_LOOP:
00021a 9007      	ELPM R0,Z+
00021b 920d      	ST   X+,R0
00021c 9701      	SBIW R24,1
00021d f7e1      	BRNE __GLOBAL_INI_LOOP
00021e 01fb      	MOVW R30,R22
00021f cfeb      	RJMP __GLOBAL_INI_NEXT
                 __GLOBAL_INI_END:
                 
                 ;HARDWARE STACK POINTER INITIALIZATION
000220 efef      	LDI  R30,LOW(__SRAM_END-__HEAP_SIZE)
000221 bfed      	OUT  SPL,R30
000222 e1e0      	LDI  R30,HIGH(__SRAM_END-__HEAP_SIZE)
000223 bfee      	OUT  SPH,R30
                 
                 ;DATA STACK POINTER INITIALIZATION
000224 e2c0      	LDI  R28,LOW(__SRAM_START+__DSTACK_SIZE)
000225 e0d9      	LDI  R29,HIGH(__SRAM_START+__DSTACK_SIZE)
                 
000226 940c 037e 	JMP  _main
                 
                 	.ESEG
                 	.ORG 0
                 
                 	.DSEG
                 	.ORG 0x920
                 
                 	.CSEG
                 ;// This file has been prepared for Doxygen automatic documentation generation.
                 ;/*! \file ********************************************************************
                 ;*
                 ;* Atmel Corporation
                 ;*
                 ;* - File              : Self_programming_main.c
                 ;* - Compiler          : IAR EWAVR 2.28a / 3.10c and newer
                 ;*
                 ;* - Support mail      : avr@atmel.com
                 ;*
                 ;* - Supported devices : This example is written for ATmega128.
                 ;*
                 ;* - AppNote           : AVR106 - C functions for reading and writing
                 ;*                       to flash memory.
                 ;*
                 ;* - Description       : The file contains an example program using the Flash R/W
                 ;*                       functions provided with the files Self_programming.h /
                 ;*                       Self_programming.c . The program should be compiled using
                 ;*                       a linker file (*.xcl) that is configured to place the
                 ;*                       entire program code into the Boot section of the Flash memory.
                 ;*                       Please refer to the application note document for more
                 ;*                       information.
                 ;*
                 ;* $Revision: 2.0 $
                 ;* $Date: Wednesday, January 18, 2006 15:18:52 UTC $
                 ;*
                 ;*****************************************************************************/
                 ;#include <io.h>
                 	#ifndef __SLEEP_DEFINED__
                 	#define __SLEEP_DEFINED__
                 	.EQU __se_bit=0x20
                 	.EQU __sm_mask=0x1C
                 	.EQU __sm_powerdown=0x10
                 	.EQU __sm_powersave=0x18
                 	.EQU __sm_standby=0x14
                 	.EQU __sm_ext_standby=0x1C
                 	.EQU __sm_adc_noise_red=0x08
                 	.SET power_ctrl_reg=mcucr
                 	#endif
                 ;#include <delay.h>
                 ;#include "Self_programming.h"
                 ;/* FAT on MMC/SD/SD HC card support */
                 ;//Petit fat api
                 ;#include <pff_rn.h>
                 ;#include "diskio.h"		/* Declarations of low level disk I/O functions */
                 ;/* printf */
                 ;#include <stdio.h>
                 ;#include <stdlib.h>
                 ;/* string functions */
                 ;#include <string.h>
                 ;#include <alcd.h>
                 ;
                 ;/*Globals*/
                 ;int retry;
                 ;/* FAT function result */
                 ;FRESULT res;
                 ;/* number of bytes written/read to the file */
                 ;unsigned int nbytes;
                 ;/* will hold the information for logical drive 0: */
                 ;FATFS fat;
                 ;/* will hold the file information */
                 ;//FIL file;
                 ;/* will hold file attributes, time stamp information */
                 ;FILINFO finfo;
                 ;/* root directory path */
                 ;char path[64];//="/0/unittest.txt";
                 ;/* text to be written to the file */
                 ;char text[]="Unit Test 1";
                 
                 	.DSEG
                 ;/* file read buffer */
                 ;char buffer[256];
                 ;
                 ;/* error message list */
                 ;flash char * flash error_msg[]=
                 ;{
                 ;"", /* not used */
                 ;"FR_DISK_ERR",
                 ;"FR_INT_ERR",
                 ;"FR_INT_ERR",
                 ;"FR_NOT_READY",
                 ;"FR_NO_FILE",
                 ;"FR_NO_PATH",
                 ;"FR_INVALID_NAME",
                 ;"FR_DENIED",
                 ;"FR_EXIST",
                 ;"FR_INVALID_OBJECT",
                 ;"FR_WRITE_PROTECTED",
                 ;"FR_INVALID_DRIVE",
                 ;"FR_NOT_ENABLED",
                 ;"FR_NO_FILESYSTEM",
                 ;"FR_MKFS_ABORTED",
                 ;"FR_TIMEOUT"
                 ;};
                 ;/* display error message and stop */
                 ;void error(FRESULT res, unsigned char num)
                 ; 0000 0054 {
                 
                 	.CSEG
                 _error:
                 ; .FSTART _error
                 ; 0000 0055     char strnum[5];
                 ; 0000 0056     if(num>100){
000228 93aa      	ST   -Y,R26
000229 9725      	SBIW R28,5
                 ;	res -> Y+6
                 ;	num -> Y+5
                 ;	strnum -> Y+0
00022a 81ad      	LDD  R26,Y+5
00022b 36a5      	CPI  R26,LOW(0x65)
00022c f010      	BRLO _0x4
                 ; 0000 0057        num=100;
00022d e6e4      	LDI  R30,LOW(100)
00022e 83ed      	STD  Y+5,R30
                 ; 0000 0058     }
                 ; 0000 0059     itoa(num,strnum);
                 _0x4:
00022f 81ed      	LDD  R30,Y+5
000230 940e 1429 	CALL SUBOPT_0x0
                 ; 0000 005A     do{
                 _0x6:
                 ; 0000 005B     if ((res>=0) && (res<=FR_NO_FILESYSTEM)){//FR_NO_FILESYSTEM  FR_TIMEOUT
000232 81ae      	LDD  R26,Y+6
000233 30a0      	CPI  R26,0
000234 f010      	BRLO _0x9
000235 30a8      	CPI  R26,LOW(0x8)
000236 f008      	BRLO _0xA
                 _0x9:
000237 c03f      	RJMP _0x8
                 _0xA:
                 ; 0000 005C        lcd_gotoxy(0,0);
000238 e0e0      	LDI  R30,LOW(0)
000239 93ea      	ST   -Y,R30
00023a e0a0      	LDI  R26,LOW(0)
00023b 940e 13a1 	CALL _lcd_gotoxy
                 ; 0000 005D        printf("ERROR: %p\r\n",error_msg[res]);
                +
00023d e4eb     +LDI R30 , LOW ( 2 * _0x0 + ( 207 ) )
00023e e0f2     +LDI R31 , HIGH ( 2 * _0x0 + ( 207 ) )
00023f e060     +LDI R22 , BYTE3 ( 2 * _0x0 + ( 207 ) )
000240 e070     +LDI R23 , BYTE4 ( 2 * _0x0 + ( 207 ) )
                 	__POINTD1FN _0x0,207
000241 940e 1872 	CALL __PUTPARD1
000243 85ea      	LDD  R30,Y+10
000244 940e 1430 	CALL SUBOPT_0x1
000246 940e 185b 	CALL __GETD1PF
000248 940e 143d 	CALL SUBOPT_0x2
                 ; 0000 005E        if(res==0){
00024a 81ee      	LDD  R30,Y+6
00024b 30e0      	CPI  R30,0
00024c f429      	BRNE _0xB
                 ; 0000 005F         lcd_putsf("SD OK: ");
                +
00024d e5a7     +LDI R26 , LOW ( 2 * _0x0 + ( 219 ) )
00024e e0b2     +LDI R27 , HIGH ( 2 * _0x0 + ( 219 ) )
00024f e080     +LDI R24 , BYTE3 ( 2 * _0x0 + ( 219 ) )
000250 e090     +LDI R25 , BYTE4 ( 2 * _0x0 + ( 219 ) )
                 	__POINTD2FN _0x0,219
000251 c004      	RJMP _0x60
                 ; 0000 0060        }
                 ; 0000 0061        else{
                 _0xB:
                 ; 0000 0062         lcd_putsf("SD ERROR: ");
                +
000252 e5af     +LDI R26 , LOW ( 2 * _0x0 + ( 227 ) )
000253 e0b2     +LDI R27 , HIGH ( 2 * _0x0 + ( 227 ) )
000254 e080     +LDI R24 , BYTE3 ( 2 * _0x0 + ( 227 ) )
000255 e090     +LDI R25 , BYTE4 ( 2 * _0x0 + ( 227 ) )
                 	__POINTD2FN _0x0,227
                 _0x60:
000256 940e 13e8 	CALL _lcd_putsf
                 ; 0000 0063        }
                 ; 0000 0064        delay_ms(100);
000258 e6a4      	LDI  R26,LOW(100)
000259 e0b0      	LDI  R27,0
00025a 940e 177a 	CALL _delay_ms
                 ; 0000 0065        lcd_puts(strnum);
00025c 01de      	MOVW R26,R28
00025d 940e 13d7 	CALL _lcd_puts
                 ; 0000 0066        lcd_putsf(",");
                +
00025f e6aa     +LDI R26 , LOW ( 2 * _0x0 + ( 238 ) )
000260 e0b2     +LDI R27 , HIGH ( 2 * _0x0 + ( 238 ) )
000261 e080     +LDI R24 , BYTE3 ( 2 * _0x0 + ( 238 ) )
000262 e090     +LDI R25 , BYTE4 ( 2 * _0x0 + ( 238 ) )
                 	__POINTD2FN _0x0,238
000263 940e 13e8 	CALL _lcd_putsf
                 ; 0000 0067        itoa(res,strnum);
000265 81ee      	LDD  R30,Y+6
000266 940e 1429 	CALL SUBOPT_0x0
                 ; 0000 0068        lcd_puts(strnum);
000268 01de      	MOVW R26,R28
000269 940e 13d7 	CALL _lcd_puts
                 ; 0000 0069        lcd_gotoxy(0,1);
00026b e0e0      	LDI  R30,LOW(0)
00026c 93ea      	ST   -Y,R30
00026d e0a1      	LDI  R26,LOW(1)
00026e 940e 13a1 	CALL _lcd_gotoxy
                 ; 0000 006A        lcd_putsf(error_msg[res]);
000270 81ee      	LDD  R30,Y+6
000271 940e 1430 	CALL SUBOPT_0x1
000273 940e 1862 	CALL __GETD2PF
000275 940e 13e8 	CALL _lcd_putsf
                 ; 0000 006B     }
                 ; 0000 006C     /* stop here */
                 ; 0000 006D     //do
                 ; 0000 006E         //{
                 ; 0000 006F           PORTC.0=0;
                 _0x8:
000277 98a8      	CBI  0x15,0
                 ; 0000 0070           PORTC.1=0;
000278 98a9      	CBI  0x15,1
                 ; 0000 0071           delay_ms(150);
000279 e9a6      	LDI  R26,LOW(150)
00027a e0b0      	LDI  R27,0
00027b 940e 177a 	CALL _delay_ms
                 ; 0000 0072           PORTC.1=1;
00027d 9aa9      	SBI  0x15,1
                 ; 0000 0073           PORTC.0=1;
00027e 9aa8      	SBI  0x15,0
                 ; 0000 0074           delay_ms(150);
00027f e9a6      	LDI  R26,LOW(150)
000280 e0b0      	LDI  R27,0
000281 940e 177a 	CALL _delay_ms
                 ; 0000 0075           PORTC=0xFC;
000283 efec      	LDI  R30,LOW(252)
000284 bbe5      	OUT  0x15,R30
                 ; 0000 0076         }
                 ; 0000 0077       while(1);
000285 cfac      	RJMP _0x6
                 ; 0000 0078 }
                 ; .FEND
                 ;unsigned char rn(char *newname, char *oldname){
                 ; 0000 0079 unsigned char rn(char *newname, char *oldname){
                 ; 0000 007A     strcpy(path,"/0/unittest.txt");
                 ;	*newname -> Y+2
                 ;	*oldname -> Y+0
                 ; 0000 007B 
                 ; 0000 007C }
                 
                 	.DSEG
                 _0x15:
000920           	.BYTE 0x10
                 ;unsigned char RenameTest(){
                 ; 0000 007D unsigned char RenameTest(){
                 
                 	.CSEG
                 ; 0000 007E    int retry;
                 ; 0000 007F    strcpy(path,"/0/unittest.txt");
                 ;	retry -> R16,R17
                 ; 0000 0080 
                 ; 0000 0081 }
                 
                 	.DSEG
                 _0x16:
000930           	.BYTE 0x10
                 ;
                 ;FRESULT rename (const char* dirname, const char* oldname, char* newname)
                 ; 0000 0084 {
                 
                 	.CSEG
                 ; 0000 0085     FRESULT res;
                 ; 0000 0086     FILINFO fno;
                 ; 0000 0087     DIR dir;
                 ; 0000 0088     int i;
                 ; 0000 0089     BYTE rwbuf[512];
                 ; 0000 008A 
                 ; 0000 008B     res = pf_opendir(&dir, path);
                 ;	*dirname -> Y+558
                 ;	*oldname -> Y+556
                 ;	*newname -> Y+554
                 ;	res -> R17
                 ;	fno -> Y+532
                 ;	dir -> Y+516
                 ;	i -> R18,R19
                 ;	rwbuf -> Y+4
                 ; 0000 008C     if (res == FR_OK) {
                 ; 0000 008D         i = strlen(path);
                 ; 0000 008E         for (;;) {
                 ; 0000 008F             res = pf_readdir(&dir, &fno);
                 ; 0000 0090             if (res != FR_OK || fno.fname[0] == 0) break;
                 ; 0000 0091             if(fno.fname[0] == 'U'){
                 ; 0000 0092                res = disk_readp(rwbuf,dir.sect,0,512);
                 ; 0000 0093                if (res != FR_OK) break;
                 ; 0000 0094                rwbuf[((dir.index-1)*32)+6]='5';
                 ; 0000 0095                res = disk_writep(0,dir.sect);
                 ; 0000 0096                if (res != FR_OK) break;
                 ; 0000 0097                res = disk_writep(rwbuf,512);
                 ; 0000 0098                if (res != FR_OK) break;
                 ; 0000 0099                res = disk_writep(0,0);
                 ; 0000 009A                break;
                 ; 0000 009B             }
                 ; 0000 009C             /*
                 ; 0000 009D             if (fno.fattrib & AM_DIR) {
                 ; 0000 009E                 sprintf(&path[i], "/%s", fno.fname);
                 ; 0000 009F                 res = scan_files(path);
                 ; 0000 00A0                 if (res != FR_OK) break;
                 ; 0000 00A1                 path[i] = 0;
                 ; 0000 00A2             } else {
                 ; 0000 00A3                 printf("%s/%s\n", path, fno.fname);
                 ; 0000 00A4             }
                 ; 0000 00A5             */
                 ; 0000 00A6         }
                 ; 0000 00A7     }
                 ; 0000 00A8 
                 ; 0000 00A9     return res;
                 ; 0000 00AA }
                 ;
                 ;unsigned char UnitTest1(){
                 ; 0000 00AC unsigned char UnitTest1(){
                 _UnitTest1:
                 ; .FSTART _UnitTest1
                 ; 0000 00AD 
                 ; 0000 00AE     BYTE testbuf[10]={'5','5','A','A','6','6','B','B','C','C'};
                 ; 0000 00AF     strcpy(path,"/0/UPDATE3.DAT");
000286 972a      	SBIW R28,10
000287 e08a      	LDI  R24,10
000288 e0a0      	LDI  R26,LOW(0)
000289 e0b0      	LDI  R27,HIGH(0)
00028a e7e2      	LDI  R30,LOW(_0x22*2)
00028b e0f1      	LDI  R31,HIGH(_0x22*2)
00028c e060      	LDI  R22,BYTE3(_0x22*2)
00028d 940e 18dc 	CALL __INITLOCB
                 ;	testbuf -> Y+0
00028f eaec      	LDI  R30,LOW(_path)
000290 e0f9      	LDI  R31,HIGH(_path)
000291 93fa      	ST   -Y,R31
000292 93ea      	ST   -Y,R30
                +
000293 e4a0     +LDI R26 , LOW ( _0x23 + ( 0 ) )
000294 e0b9     +LDI R27 , HIGH ( _0x23 + ( 0 ) )
                 	__POINTW2MN _0x23,0
000295 940e 1358 	CALL _strcpy
                 ; 0000 00B0     /* mount logical drive 0: */
                 ; 0000 00B1     //if ((res=f_mount(0,&fat))==FR_OK)
                 ; 0000 00B2     /*
                 ; 0000 00B3     for(retry=0;retry<5;retry++){
                 ; 0000 00B4         res=pf_mount(&fat);
                 ; 0000 00B5         if (res==FR_OK){
                 ; 0000 00B6             break;
                 ; 0000 00B7         }
                 ; 0000 00B8         else{
                 ; 0000 00B9           delay_ms(500);
                 ; 0000 00BA         }
                 ; 0000 00BB     }
                 ; 0000 00BC     */
                 ; 0000 00BD     res=pf_mount(&fat);
000297 e8a0      	LDI  R26,LOW(_fat)
000298 e0b9      	LDI  R27,HIGH(_fat)
000299 940e 0bc5 	CALL _pf_mount
00029b 2e7e      	MOV  R7,R30
                 ; 0000 00BE     if (res==FR_OK)
00029c 2077      	TST  R7
00029d f459      	BRNE _0x24
                 ; 0000 00BF        printf("Logical drive 0: mounted OK\r\n");
                +
00029e e8eb     +LDI R30 , LOW ( 2 * _0x0 + ( 271 ) )
00029f e0f2     +LDI R31 , HIGH ( 2 * _0x0 + ( 271 ) )
0002a0 e060     +LDI R22 , BYTE3 ( 2 * _0x0 + ( 271 ) )
0002a1 e070     +LDI R23 , BYTE4 ( 2 * _0x0 + ( 271 ) )
                 	__POINTD1FN _0x0,271
0002a2 940e 1872 	CALL __PUTPARD1
0002a4 e080      	LDI  R24,0
0002a5 940e 1305 	CALL _printf
0002a7 9624      	ADIW R28,4
                 ; 0000 00C0     else
0002a8 c003      	RJMP _0x25
                 _0x24:
                 ; 0000 00C1        /* an error occured, display it and stop */
                 ; 0000 00C2        error(res,1);
0002a9 927a      	ST   -Y,R7
0002aa e0a1      	LDI  R26,LOW(1)
0002ab df7c      	RCALL _error
                 ; 0000 00C3     //scan_files("/0");
                 ; 0000 00C4 
                 ; 0000 00C5     res=pf_rename("/0","UPDATE","DONE000");
                 _0x25:
                +
0002ac e4ef     +LDI R30 , LOW ( _0x23 + ( 15 ) )
0002ad e0f9     +LDI R31 , HIGH ( _0x23 + ( 15 ) )
                 	__POINTW1MN _0x23,15
0002ae 93fa      	ST   -Y,R31
0002af 93ea      	ST   -Y,R30
                +
0002b0 e5e2     +LDI R30 , LOW ( _0x23 + ( 18 ) )
0002b1 e0f9     +LDI R31 , HIGH ( _0x23 + ( 18 ) )
                 	__POINTW1MN _0x23,18
0002b2 93fa      	ST   -Y,R31
0002b3 93ea      	ST   -Y,R30
                +
0002b4 e5a9     +LDI R26 , LOW ( _0x23 + ( 25 ) )
0002b5 e0b9     +LDI R27 , HIGH ( _0x23 + ( 25 ) )
                 	__POINTW2MN _0x23,25
0002b6 940e 10f5 	CALL _pf_rename
0002b8 2e7e      	MOV  R7,R30
                 ; 0000 00C6     res=pf_rename("/0","DONE","UPDATE1 DAT");
                +
0002b9 e6e1     +LDI R30 , LOW ( _0x23 + ( 33 ) )
0002ba e0f9     +LDI R31 , HIGH ( _0x23 + ( 33 ) )
                 	__POINTW1MN _0x23,33
0002bb 93fa      	ST   -Y,R31
0002bc 93ea      	ST   -Y,R30
                +
0002bd e6e4     +LDI R30 , LOW ( _0x23 + ( 36 ) )
0002be e0f9     +LDI R31 , HIGH ( _0x23 + ( 36 ) )
                 	__POINTW1MN _0x23,36
0002bf 93fa      	ST   -Y,R31
0002c0 93ea      	ST   -Y,R30
                +
0002c1 e6a9     +LDI R26 , LOW ( _0x23 + ( 41 ) )
0002c2 e0b9     +LDI R27 , HIGH ( _0x23 + ( 41 ) )
                 	__POINTW2MN _0x23,41
0002c3 940e 10f5 	CALL _pf_rename
0002c5 2e7e      	MOV  R7,R30
                 ; 0000 00C7     if(res)
0002c6 2077      	TST  R7
0002c7 f019      	BREQ _0x26
                 ; 0000 00C8         error(res,22);
0002c8 927a      	ST   -Y,R7
0002c9 e1a6      	LDI  R26,LOW(22)
0002ca df5d      	RCALL _error
                 ; 0000 00C9 
                 ; 0000 00CA 
                 ; 0000 00CB 
                 ; 0000 00CC 
                 ; 0000 00CD 
                 ; 0000 00CE     /*this line will remove READ_ONLY attribute*/
                 ; 0000 00CF     //f_chmod(path, AM_ARC, AM_ARC|AM_RDO);
                 ; 0000 00D0     /* create a new file in the root of drive 0:
                 ; 0000 00D1        and set write access mode */
                 ; 0000 00D2     //if ((res=f_open(&file,path,FA_CREATE_ALWAYS | FA_WRITE))==FR_OK)
                 ; 0000 00D3     if ((res=pf_open("data4K.bin"))==FR_OK)
                 _0x26:
                +
0002cb e7a5     +LDI R26 , LOW ( _0x23 + ( 53 ) )
0002cc e0b9     +LDI R27 , HIGH ( _0x23 + ( 53 ) )
                 	__POINTW2MN _0x23,53
0002cd 940e 0ce8 	CALL _pf_open
0002cf 2e7e      	MOV  R7,R30
0002d0 30e0      	CPI  R30,0
0002d1 f439      	BRNE _0x27
                 ; 0000 00D4        printf("File %s created OK\r\n",path);
                +
0002d2 ede7     +LDI R30 , LOW ( 2 * _0x0 + ( 347 ) )
0002d3 e0f2     +LDI R31 , HIGH ( 2 * _0x0 + ( 347 ) )
0002d4 e060     +LDI R22 , BYTE3 ( 2 * _0x0 + ( 347 ) )
0002d5 e070     +LDI R23 , BYTE4 ( 2 * _0x0 + ( 347 ) )
                 	__POINTD1FN _0x0,347
0002d6 940e 1444 	CALL SUBOPT_0x3
                 ; 0000 00D5     else{
0002d8 c006      	RJMP _0x28
                 _0x27:
                 ; 0000 00D6        /* an error occured, display it and stop */
                 ; 0000 00D7        if(res!=3)
0002d9 e0e3      	LDI  R30,LOW(3)
0002da 15e7      	CP   R30,R7
0002db f019      	BREQ _0x29
                 ; 0000 00D8             error(res,2);
0002dc 927a      	ST   -Y,R7
0002dd e0a2      	LDI  R26,LOW(2)
0002de df49      	RCALL _error
                 ; 0000 00D9     }
                 _0x29:
                 _0x28:
                 ; 0000 00DA 
                 ; 0000 00DB     /* write some text to the file,
                 ; 0000 00DC        without the NULL string terminator sizeof(data)-1 */
                 ; 0000 00DD     //if ((res=f_write(&file,text,sizeof(text)-1,&nbytes))==FR_OK)
                 ; 0000 00DE     if ((res=pf_write512(testbuf,0,sizeof(testbuf),&nbytes))==FR_OK)
0002df 940e 144b 	CALL SUBOPT_0x4
0002e1 940e 144f 	CALL SUBOPT_0x5
0002e3 940e 1454 	CALL SUBOPT_0x6
0002e5 f419      	BRNE _0x2A
                 ; 0000 00DF        printf("%u bytes written of %u\r\n",nbytes,sizeof(text)-1);
0002e6 940e 145f 	CALL SUBOPT_0x7
                 ; 0000 00E0     else
0002e8 c002      	RJMP _0x2B
                 _0x2A:
                 ; 0000 00E1        ///* an error occured, display it and stop */
                 ; 0000 00E2        error(res,93);
0002e9 940e 1475 	CALL SUBOPT_0x8
                 ; 0000 00E3     if ((res=pf_write512(testbuf,20,sizeof(testbuf),&nbytes))==FR_OK)
                 _0x2B:
0002eb 940e 144b 	CALL SUBOPT_0x4
0002ed e1e4      	LDI  R30,LOW(20)
0002ee e0f0      	LDI  R31,HIGH(20)
0002ef 940e 1479 	CALL SUBOPT_0x9
0002f1 f419      	BRNE _0x2C
                 ; 0000 00E4        printf("%u bytes written of %u\r\n",nbytes,sizeof(text)-1);
0002f2 940e 145f 	CALL SUBOPT_0x7
                 ; 0000 00E5     else
0002f4 c002      	RJMP _0x2D
                 _0x2C:
                 ; 0000 00E6        ///* an error occured, display it and stop */
                 ; 0000 00E7        error(res,93);
0002f5 940e 1475 	CALL SUBOPT_0x8
                 ; 0000 00E8     if ((res=pf_write512(testbuf,510,sizeof(testbuf),&nbytes))==FR_OK)
                 _0x2D:
0002f7 940e 144b 	CALL SUBOPT_0x4
0002f9 efee      	LDI  R30,LOW(510)
0002fa e0f1      	LDI  R31,HIGH(510)
0002fb 940e 1479 	CALL SUBOPT_0x9
0002fd f419      	BRNE _0x2E
                 ; 0000 00E9        printf("%u bytes written of %u\r\n",nbytes,sizeof(text)-1);
0002fe 940e 145f 	CALL SUBOPT_0x7
                 ; 0000 00EA     else
000300 c002      	RJMP _0x2F
                 _0x2E:
                 ; 0000 00EB        ///* an error occured, display it and stop */
                 ; 0000 00EC        error(res,93);
000301 940e 1475 	CALL SUBOPT_0x8
                 ; 0000 00ED     if ((res=pf_write512(testbuf,521,sizeof(testbuf),&nbytes))==FR_OK)
                 _0x2F:
000303 940e 144b 	CALL SUBOPT_0x4
000305 e0e9      	LDI  R30,LOW(521)
000306 e0f2      	LDI  R31,HIGH(521)
000307 940e 1479 	CALL SUBOPT_0x9
000309 f419      	BRNE _0x30
                 ; 0000 00EE        printf("%u bytes written of %u\r\n",nbytes,sizeof(text)-1);
00030a 940e 145f 	CALL SUBOPT_0x7
                 ; 0000 00EF     else
00030c c002      	RJMP _0x31
                 _0x30:
                 ; 0000 00F0        ///* an error occured, display it and stop */
                 ; 0000 00F1        error(res,93);
00030d 940e 1475 	CALL SUBOPT_0x8
                 ; 0000 00F2     if ((res=pf_write512(testbuf,1020,sizeof(testbuf),&nbytes))==FR_OK)
                 _0x31:
00030f 940e 144b 	CALL SUBOPT_0x4
000311 efec      	LDI  R30,LOW(1020)
000312 e0f3      	LDI  R31,HIGH(1020)
000313 940e 1479 	CALL SUBOPT_0x9
000315 f419      	BRNE _0x32
                 ; 0000 00F3        printf("%u bytes written of %u\r\n",nbytes,sizeof(text)-1);
000316 940e 145f 	CALL SUBOPT_0x7
                 ; 0000 00F4     else
000318 c002      	RJMP _0x33
                 _0x32:
                 ; 0000 00F5        ///* an error occured, display it and stop */
                 ; 0000 00F6        error(res,93);
000319 940e 1475 	CALL SUBOPT_0x8
                 ; 0000 00F7     if ((res=pf_write512(testbuf,1031,sizeof(testbuf),&nbytes))==FR_OK)
                 _0x33:
00031b 940e 144b 	CALL SUBOPT_0x4
00031d e0e7      	LDI  R30,LOW(1031)
00031e e0f4      	LDI  R31,HIGH(1031)
00031f 940e 1479 	CALL SUBOPT_0x9
000321 f419      	BRNE _0x34
                 ; 0000 00F8        printf("%u bytes written of %u\r\n",nbytes,sizeof(text)-1);
000322 940e 145f 	CALL SUBOPT_0x7
                 ; 0000 00F9     else
000324 c002      	RJMP _0x35
                 _0x34:
                 ; 0000 00FA        ///* an error occured, display it and stop */
                 ; 0000 00FB        error(res,93);
000325 940e 1475 	CALL SUBOPT_0x8
                 ; 0000 00FC     if ((res=pf_write(text,sizeof(text)-1,&nbytes))==FR_OK)
                 _0x35:
000327 eeec      	LDI  R30,LOW(_text)
000328 e0f9      	LDI  R31,HIGH(_text)
000329 93fa      	ST   -Y,R31
00032a 93ea      	ST   -Y,R30
00032b e0eb      	LDI  R30,LOW(11)
00032c e0f0      	LDI  R31,HIGH(11)
00032d 93fa      	ST   -Y,R31
00032e 93ea      	ST   -Y,R30
00032f e0a8      	LDI  R26,LOW(8)
000330 e0b0      	LDI  R27,HIGH(8)
000331 940e 0e1c 	CALL _pf_write
000333 2e7e      	MOV  R7,R30
000334 30e0      	CPI  R30,0
000335 f419      	BRNE _0x36
                 ; 0000 00FD        printf("%u bytes written of %u\r\n",nbytes,sizeof(text)-1);
000336 940e 145f 	CALL SUBOPT_0x7
                 ; 0000 00FE     else
000338 c003      	RJMP _0x37
                 _0x36:
                 ; 0000 00FF        ///* an error occured, display it and stop */
                 ; 0000 0100        error(res,3);
000339 927a      	ST   -Y,R7
00033a e0a3      	LDI  R26,LOW(3)
00033b deec      	RCALL _error
                 ; 0000 0101 
                 ; 0000 0102         /* close the file */
                 ; 0000 0103     /*
                 ; 0000 0104     if ((res=f_close(&file))==FR_OK)
                 ; 0000 0105        printf("File %s closed OK\r\n",path);
                 ; 0000 0106     else
                 ; 0000 0107        // an error occured, display it and stop
                 ; 0000 0108        error(res,4);
                 ; 0000 0109     */
                 ; 0000 010A 
                 ; 0000 010B     /* open the file in read mode */
                 ; 0000 010C 
                 ; 0000 010D     //if ((res=f_open(&file,path,FA_READ|FA_WRITE))==FR_OK)
                 ; 0000 010E     if ((res=pf_open(path))==FR_OK)
                 _0x37:
00033c eaac      	LDI  R26,LOW(_path)
00033d e0b9      	LDI  R27,HIGH(_path)
00033e 940e 0ce8 	CALL _pf_open
000340 2e7e      	MOV  R7,R30
000341 30e0      	CPI  R30,0
000342 f439      	BRNE _0x38
                 ; 0000 010F        printf("File %s opened OK\r\n",path);
                +
000343 e0e5     +LDI R30 , LOW ( 2 * _0x0 + ( 393 ) )
000344 e0f3     +LDI R31 , HIGH ( 2 * _0x0 + ( 393 ) )
000345 e060     +LDI R22 , BYTE3 ( 2 * _0x0 + ( 393 ) )
000346 e070     +LDI R23 , BYTE4 ( 2 * _0x0 + ( 393 ) )
                 	__POINTD1FN _0x0,393
000347 940e 1444 	CALL SUBOPT_0x3
                 ; 0000 0110     else
000349 c003      	RJMP _0x39
                 _0x38:
                 ; 0000 0111        ///* an error occured, display it and stop */
                 ; 0000 0112        error(res,7);
00034a 927a      	ST   -Y,R7
00034b e0a7      	LDI  R26,LOW(7)
00034c dedb      	RCALL _error
                 ; 0000 0113 
                 ; 0000 0114 
                 ; 0000 0115 
                 ; 0000 0116     /* read and display the file's content.
                 ; 0000 0117        make sure to leave space for a NULL terminator
                 ; 0000 0118        in the buffer, so maximum sizeof(buffer)-1 bytes can be read */
                 ; 0000 0119     //if ((res=f_read(&file,buffer,sizeof(buffer)-1,&nbytes))==FR_OK)
                 ; 0000 011A     if ((res=pf_read(buffer,sizeof(buffer)-1,&nbytes))==FR_OK)
                 _0x39:
00034d efe8      	LDI  R30,LOW(_buffer)
00034e e0f9      	LDI  R31,HIGH(_buffer)
00034f 93fa      	ST   -Y,R31
000350 93ea      	ST   -Y,R30
000351 efef      	LDI  R30,LOW(255)
000352 e0f0      	LDI  R31,HIGH(255)
000353 93fa      	ST   -Y,R31
000354 93ea      	ST   -Y,R30
000355 e0a8      	LDI  R26,LOW(8)
000356 e0b0      	LDI  R27,HIGH(8)
000357 940e 0d2d 	CALL _pf_read
000359 2e7e      	MOV  R7,R30
00035a 30e0      	CPI  R30,0
00035b f4e9      	BRNE _0x3A
                 ; 0000 011B        {
                 ; 0000 011C        printf("%u bytes read\r\n",nbytes);
                +
00035c e1e9     +LDI R30 , LOW ( 2 * _0x0 + ( 413 ) )
00035d e0f3     +LDI R31 , HIGH ( 2 * _0x0 + ( 413 ) )
00035e e060     +LDI R22 , BYTE3 ( 2 * _0x0 + ( 413 ) )
00035f e070     +LDI R23 , BYTE4 ( 2 * _0x0 + ( 413 ) )
                 	__POINTD1FN _0x0,413
000360 940e 1872 	CALL __PUTPARD1
000362 01f4      	MOVW R30,R8
000363 2766      	CLR  R22
000364 2777      	CLR  R23
000365 940e 143d 	CALL SUBOPT_0x2
                 ; 0000 011D        /* NULL terminate the char string in the buffer */
                 ; 0000 011E        buffer[nbytes+1]=NULL;
000367 01f4      	MOVW R30,R8
                +
000368 50e7     +SUBI R30 , LOW ( - _buffer - ( 1 ) )
000369 4ff6     +SBCI R31 , HIGH ( - _buffer - ( 1 ) )
                 	__ADDW1MN _buffer,1
00036a e0a0      	LDI  R26,LOW(0)
00036b 83a0      	STD  Z+0,R26
                 ; 0000 011F        /* display the buffer contents */
                 ; 0000 0120        printf("Read text: \"%s\"\r\n",buffer);
                +
00036c e2e9     +LDI R30 , LOW ( 2 * _0x0 + ( 429 ) )
00036d e0f3     +LDI R31 , HIGH ( 2 * _0x0 + ( 429 ) )
00036e e060     +LDI R22 , BYTE3 ( 2 * _0x0 + ( 429 ) )
00036f e070     +LDI R23 , BYTE4 ( 2 * _0x0 + ( 429 ) )
                 	__POINTD1FN _0x0,429
000370 940e 1872 	CALL __PUTPARD1
000372 efe8      	LDI  R30,LOW(_buffer)
000373 e0f9      	LDI  R31,HIGH(_buffer)
000374 2766      	CLR  R22
000375 2777      	CLR  R23
000376 940e 143d 	CALL SUBOPT_0x2
                 ; 0000 0121        }
                 ; 0000 0122     else
000378 c003      	RJMP _0x3B
                 _0x3A:
                 ; 0000 0123        /* an error occured, display it and stop */
                 ; 0000 0124        error(res,6);
000379 927a      	ST   -Y,R7
00037a e0a6      	LDI  R26,LOW(6)
00037b deac      	RCALL _error
                 ; 0000 0125 
                 ; 0000 0126 
                 ; 0000 0127     /* close the file */
                 ; 0000 0128     /*
                 ; 0000 0129     if ((res=f_close(&file))==FR_OK)
                 ; 0000 012A        printf("File %s closed OK\r\n",path);
                 ; 0000 012B     else
                 ; 0000 012C        // an error occured, display it and stop
                 ; 0000 012D        error(res,6);
                 ; 0000 012E     */
                 ; 0000 012F 
                 ; 0000 0130     /* display file's attribute, size and time stamp */
                 ; 0000 0131     //display_status(path);
                 ; 0000 0132 
                 ; 0000 0133 
                 ; 0000 0134     /* change file's attributes, set the file to be Read-Only */
                 ; 0000 0135     /*
                 ; 0000 0136     if ((res=f_chmod(path,AM_RDO,AM_RDO))==FR_OK)
                 ; 0000 0137        printf("Read-Only attribute set OK\r\n",path);
                 ; 0000 0138     else
                 ; 0000 0139        // an error occured, display it and stop
                 ; 0000 013A        error(res,7);
                 ; 0000 013B     */
                 ; 0000 013C   return 1;
                 _0x3B:
00037c e0e1      	LDI  R30,LOW(1)
00037d c0cd      	RJMP _0x20C0019
                 ; 0000 013D }
                 ; .FEND
                 
                 	.DSEG
                 _0x23:
000940           	.BYTE 0x40
                 ;void main( void ){
                 ; 0000 013E void main( void ){
                 
                 	.CSEG
                 _main:
                 ; .FSTART _main
                 ; 0000 013F   unsigned char testBuffer1[PAGESIZE];      // Declares variables for testing
                 ; 0000 0140   //unsigned char testBuffer2[PAGESIZE];      // Note. Each array uses PAGESIZE bytes of
                 ; 0000 0141                                             // code stack
                 ; 0000 0142   static unsigned char testChar; // A warning will come saying that this var is set but never used. Ignore it.
                 ; 0000 0143   int index;
                 ; 0000 0144 
                 ; 0000 0145   /* globally enable interrupts */
                 ; 0000 0146     #asm("sei")
00037e 50d1      	SUBI R29,1
                 ;	testBuffer1 -> Y+0
                 ;	index -> R16,R17
00037f 9478      	sei
                 ; 0000 0147 
                 ; 0000 0148   DDRC=0xFF;
000380 efef      	LDI  R30,LOW(255)
000381 bbe4      	OUT  0x14,R30
                 ; 0000 0149   PORTC=0xFF;
000382 bbe5      	OUT  0x15,R30
                 ; 0000 014A   /* initialize the LCD for 2 lines & 16 columns */
                 ; 0000 014B     lcd_init(16);
000383 e1a0      	LDI  R26,LOW(16)
000384 940e 13fa 	CALL _lcd_init
                 ; 0000 014C   /* switch to writing in Display RAM */
                 ; 0000 014D     //lcd_gotoxy(0,0);
                 ; 0000 014E     lcd_clear();
000386 940e 13b0 	CALL _lcd_clear
                 ; 0000 014F     //lcd_putsf("User char 0:");
                 ; 0000 0150 
                 ; 0000 0151   //disk_timerproc();
                 ; 0000 0152   lcd_clear();
000388 940e 13b0 	CALL _lcd_clear
                 ; 0000 0153   lcd_putsf("pff Test3.");
                +
00038a e3ab     +LDI R26 , LOW ( 2 * _0x0 + ( 447 ) )
00038b e0b3     +LDI R27 , HIGH ( 2 * _0x0 + ( 447 ) )
00038c e080     +LDI R24 , BYTE3 ( 2 * _0x0 + ( 447 ) )
00038d e090     +LDI R25 , BYTE4 ( 2 * _0x0 + ( 447 ) )
                 	__POINTD2FN _0x0,447
00038e 940e 13e8 	CALL _lcd_putsf
                 ; 0000 0154   delay_ms(200);
000390 eca8      	LDI  R26,LOW(200)
000391 e0b0      	LDI  R27,0
000392 940e 177a 	CALL _delay_ms
                 ; 0000 0155   UnitTest1();
000394 def1      	RCALL _UnitTest1
                 ; 0000 0156 
                 ; 0000 0157   //RenameTest();
                 ; 0000 0158   //UpdateTest();
                 ; 0000 0159   //WriteDataTest();
                 ; 0000 015A   //ReadDataTest();
                 ; 0000 015B 
                 ; 0000 015C   /* switch to writing in Display RAM */
                 ; 0000 015D     lcd_gotoxy(0,0);
000395 e0e0      	LDI  R30,LOW(0)
000396 93ea      	ST   -Y,R30
000397 e0a0      	LDI  R26,LOW(0)
000398 940e 13a1 	CALL _lcd_gotoxy
                 ; 0000 015E     lcd_putsf("Test3 done.");
                +
00039a e4a6     +LDI R26 , LOW ( 2 * _0x0 + ( 458 ) )
00039b e0b3     +LDI R27 , HIGH ( 2 * _0x0 + ( 458 ) )
00039c e080     +LDI R24 , BYTE3 ( 2 * _0x0 + ( 458 ) )
00039d e090     +LDI R25 , BYTE4 ( 2 * _0x0 + ( 458 ) )
                 	__POINTD2FN _0x0,458
00039e 940e 13e8 	CALL _lcd_putsf
                 ; 0000 015F   do
                 _0x3D:
                 ; 0000 0160     {
                 ; 0000 0161       PORTC.0=0;
0003a0 98a8      	CBI  0x15,0
                 ; 0000 0162       PORTC.1=0;
0003a1 940e 147c 	CALL SUBOPT_0xA
                 ; 0000 0163       delay_ms(500);
                 ; 0000 0164       PORTC.1=1;
                 ; 0000 0165       PORTC.0=1;
0003a3 9aa8      	SBI  0x15,0
                 ; 0000 0166       delay_ms(500);
0003a4 940e 1483 	CALL SUBOPT_0xB
                 ; 0000 0167       PORTC=0xFC;
0003a6 efec      	LDI  R30,LOW(252)
0003a7 bbe5      	OUT  0x15,R30
                 ; 0000 0168     }
                 ; 0000 0169   while(1);
0003a8 cff7      	RJMP _0x3D
                 ; 0000 016A   for(index=0; index<PAGESIZE; index++){
                 _0x48:
                +
0003a9 3000     +CPI R16 , LOW ( 256 )
0003aa e0e1     +LDI R30 , HIGH ( 256 )
0003ab 071e     +CPC R17 , R30
                 	__CPWRN 16,17,256
0003ac f444      	BRGE _0x49
                 ; 0000 016B     testBuffer1[index]=index;//(unsigned char)0xFF; // Fills testBuffer1 with values FF
0003ad 01f8      	MOVW R30,R16
0003ae 01de      	MOVW R26,R28
0003af 0fea      	ADD  R30,R26
0003b0 1ffb      	ADC  R31,R27
0003b1 8300      	ST   Z,R16
                 ; 0000 016C   }
                +
0003b2 5f0f     +SUBI R16 , LOW ( - 1 )
0003b3 4f1f     +SBCI R17 , HIGH ( - 1 )
                 	__ADDWRN 16,17,1
0003b4 cff4      	RJMP _0x48
                 _0x49:
                 ; 0000 016D   if(WriteFlashBytes(0x2, testBuffer1,PAGESIZE)){     // Writes testbuffer1 to Flash page 2
0003b5 940e 1487 	CALL SUBOPT_0xC
0003b7 01fe      	MOVW R30,R28
0003b8 9634      	ADIW R30,4
0003b9 93fa      	ST   -Y,R31
0003ba 93ea      	ST   -Y,R30
0003bb e0a0      	LDI  R26,LOW(256)
0003bc e0b1      	LDI  R27,HIGH(256)
0003bd d0b8      	RCALL _WriteFlashBytes
0003be 30e0      	CPI  R30,0
0003bf f009      	BREQ _0x4A
                 ; 0000 016E     PORTC.2=0;
0003c0 98aa      	CBI  0x15,2
                 ; 0000 016F   }                                            // Same as byte 4 on page 2
                 ; 0000 0170   //MCUCR &= ~(1<<IVSEL);
                 ; 0000 0171   ReadFlashBytes(0x2,&testChar,1);        // Reads back value from address 0x204
                 _0x4A:
0003c1 940e 1487 	CALL SUBOPT_0xC
0003c3 940e 148e 	CALL SUBOPT_0xD
                 ; 0000 0172   if(testChar==0x00)
0003c5 91e0 0af8 	LDS  R30,_testChar_S0000005000
0003c7 30e0      	CPI  R30,0
0003c8 f529      	BRNE _0x4D
                 ; 0000 0173   {
                 ; 0000 0174       ReadFlashBytes(0x3,&testChar,1);        // Reads back value from address 0x204
                +
0003c9 e0e3     +LDI R30 , LOW ( 0x3 )
0003ca e0f0     +LDI R31 , HIGH ( 0x3 )
0003cb e060     +LDI R22 , BYTE3 ( 0x3 )
0003cc e070     +LDI R23 , BYTE4 ( 0x3 )
                 	__GETD1N 0x3
0003cd 940e 1496 	CALL SUBOPT_0xE
                 ; 0000 0175       if(testChar==0x01)
0003cf 91a0 0af8 	LDS  R26,_testChar_S0000005000
0003d1 30a1      	CPI  R26,LOW(0x1)
0003d2 f431      	BRNE _0x4E
                 ; 0000 0176         ReadFlashBytes(0x100,&testChar,1);        // Reads back value from address 0x204
                +
0003d3 e0e0     +LDI R30 , LOW ( 0x100 )
0003d4 e0f1     +LDI R31 , HIGH ( 0x100 )
0003d5 e060     +LDI R22 , BYTE3 ( 0x100 )
0003d6 e070     +LDI R23 , BYTE4 ( 0x100 )
                 	__GETD1N 0x100
0003d7 940e 1496 	CALL SUBOPT_0xE
                 ; 0000 0177         if(testChar==0xFE)
                 _0x4E:
0003d9 91a0 0af8 	LDS  R26,_testChar_S0000005000
0003db 3fae      	CPI  R26,LOW(0xFE)
0003dc f431      	BRNE _0x4F
                 ; 0000 0178             ReadFlashBytes(0x101,&testChar,1);        // Reads back value from address 0x204
                +
0003dd e0e1     +LDI R30 , LOW ( 0x101 )
0003de e0f1     +LDI R31 , HIGH ( 0x101 )
0003df e060     +LDI R22 , BYTE3 ( 0x101 )
0003e0 e070     +LDI R23 , BYTE4 ( 0x101 )
                 	__GETD1N 0x101
0003e1 940e 1496 	CALL SUBOPT_0xE
                 ; 0000 0179             if(testChar==0xFF)
                 _0x4F:
0003e3 91a0 0af8 	LDS  R26,_testChar_S0000005000
0003e5 3faf      	CPI  R26,LOW(0xFF)
0003e6 f439      	BRNE _0x50
                 ; 0000 017A               while(1)
                 _0x51:
                 ; 0000 017B               {
                 ; 0000 017C                   PORTC.0=0;
0003e7 98a8      	CBI  0x15,0
                 ; 0000 017D                   delay_ms(500);
0003e8 940e 1483 	CALL SUBOPT_0xB
                 ; 0000 017E                   PORTC.0=1;
0003ea 9aa8      	SBI  0x15,0
                 ; 0000 017F                   delay_ms(500);
0003eb 940e 1483 	CALL SUBOPT_0xB
                 ; 0000 0180               }
0003ed cff9      	RJMP _0x51
                 ; 0000 0181   }
                 _0x50:
                 ; 0000 0182 
                 ; 0000 0183   while(1)
                 _0x4D:
                 _0x58:
                 ; 0000 0184   {
                 ; 0000 0185       PORTC.1=0;
0003ee 940e 147c 	CALL SUBOPT_0xA
                 ; 0000 0186       delay_ms(500);
                 ; 0000 0187       PORTC.1=1;
                 ; 0000 0188       delay_ms(500);
0003f0 940e 1483 	CALL SUBOPT_0xB
                 ; 0000 0189   }
0003f2 cffb      	RJMP _0x58
                 ; 0000 018A   //}
                 ; 0000 018B }
                 _0x5F:
0003f3 cfff      	RJMP _0x5F
                 ; .FEND
                 ;// This file has been prepared for Doxygen automatic documentation generation.
                 ;/*! \file ********************************************************************
                 ;*
                 ;* Atmel Corporation
                 ;*
                 ;* - File              : Self_programming.c
                 ;* - Compiler          : IAR EWAVR 2.28a / 3.10c and newer
                 ;*
                 ;* - Support mail      : avr@atmel.com
                 ;*
                 ;* - Supported devices : All devices with bootloaders support.
                 ;*
                 ;* - AppNote           : AVR106 - C functions for reading and writing
                 ;*                       to flash memory.
                 ;*
                 ;* - Description       : The file contains functions for easy reading and writing
                 ;*                       of Flash memory on parts having the "Self-programming"
                 ;*                       feature. The user functions are as follows:
                 ;*
                 ;*                       ReadFlashByte()
                 ;*                       ReadFlashPage()
                 ;*                       WriteFlashByte()
                 ;*                       WriteFlashPage()
                 ;*                       RecoverFlash()
                 ;*
                 ;*                       The remaining functions contained in this file are used
                 ;*                       by the functions listet above.
                 ;*
                 ;* $Revision: 2.0 $
                 ;* $Date: Wednesday, January 18, 2006 15:18:52 UTC $
                 ;*
                 ;****************************************************************************/
                 ;#include <io.h>
                 	#ifndef __SLEEP_DEFINED__
                 	#endif
                 ;//#include <inavr.h>
                 ;#include "Self_programming.h"
                 ;//#include "flash.h"
                 ;
                 ;void (*__AddrToZ24WordToR1R0ByteToSPMCR_SPM_F)(void flash * addr, unsigned int data)= (void(*)(void flash *, unsigned in ...
                 ;void (*__AddrToZ24ByteToSPMCR_SPM_W)(void flash * addr)= (void(*)(void flash *)) 0x0F9EB;
                 ;void (*__AddrToZ24ByteToSPMCR_SPM_E)(void flash * addr)= (void(*)(void flash *)) 0x0FA0B;
                 
                 	.DSEG
                 ;void (*__AddrToZ24ByteToSPMCR_SPM_EW)(void flash * addr)= (void(*)(void flash *)) 0x0FA2B;
                 ;
                 ;/*!
                 ;* Declare global struct variable in EEPROM if Flash recovery enabled.
                 ;* FlashBackup pageNumber holds Flash pageaddress (/PAGESIZE) the data in Flash
                 ;* recovery buffer should be written to if data need to be recovered.
                 ;* FlashBackup.status tells if data need to be recovered.
                 ;**/
                 ;#ifdef __FLASH_RECOVER
                 ;__eeprom struct {
                 ;  unsigned int  pageNumber;
                 ;  unsigned char status;
                 ;}FlashBackup = {0};
                 ;#endif
                 ;
                 ;__eeprom struct {
                 ;  unsigned long  flashStartAdr;
                 ;  unsigned int length;
                 ;  unsigned char status;//0=already moved to flash, 1=not moved to flash yet
                 ;  unsigned char data[PAGESIZE];
                 ;}_EepromBackup @10;
                 ;
                 ;/*!
                 ;* The function Returns one byte located on Flash address given by ucFlashStartAdr.
                 ;**/
                 ;unsigned char ReadFlashByte(MyAddressType flashStartAdr){
                 ; 0001 0042 unsigned char ReadFlashByte(MyAddressType flashStartAdr){
                 
                 	.CSEG
                 _ReadFlashByte:
                 ; .FSTART _ReadFlashByte
                 ; 0001 0043 //#pragma diag_suppress=Pe1053 // Suppress warning for conversion from long-type address to flash ptr.
                 ; 0001 0044   flashStartAdr;//+=ADR_LIMIT_LOW;
0003f4 940e 1877 	CALL __PUTPARD2
                 ;	flashStartAdr -> Y+0
0003f6 940e 1499 	CALL SUBOPT_0xF
                 ; 0001 0045   return (unsigned char)*((MyFlashCharPointer)flashStartAdr);
0003f8 940e 1499 	CALL SUBOPT_0xF
                +
0003fa bf6b     +OUT RAMPZ , R22
0003fb 91e6     +ELPM R30 , Z
                 	__GETBRPF 30
0003fc c1e9      	RJMP _0x20C0016
                 ; 0001 0046 //#pragma diag_default=Pe1053 // Back to default.
                 ; 0001 0047 } // Returns data from Flash
                 ; .FEND
                 ;
                 ;/*!
                 ;* The function reads one Flash page from address flashStartAdr and stores data
                 ;* in array dataPage[]. The number of bytes stored is depending upon the
                 ;* Flash page size. The function returns FALSE if input address is not a Flash
                 ;* page address, else TRUE.
                 ;**/
                 ;unsigned char ReadFlashPage(MyAddressType flashStartAdr, unsigned char *dataPage){
                 ; 0001 004F unsigned char ReadFlashPage(MyAddressType flashStartAdr, unsigned char *dataPage){
                 _ReadFlashPage:
                 ; .FSTART _ReadFlashPage
                 ; 0001 0050   unsigned int index;
                 ; 0001 0051   flashStartAdr;//+=ADR_LIMIT_LOW;
0003fd 940e 149c 	CALL SUBOPT_0x10
                 ;	flashStartAdr -> Y+4
                 ;	*dataPage -> Y+2
                 ;	index -> R16,R17
0003ff 940e 14a1 	CALL SUBOPT_0x11
                 ; 0001 0052   if(!(flashStartAdr & (PAGESIZE-1))){      // If input address is a page address
000401 940e 14a1 	CALL SUBOPT_0x11
000403 30e0      	CPI  R30,0
000404 f4c9      	BRNE _0x20005
                 ; 0001 0053     for(index = 0; index < PAGESIZE; index++){
                +
000405 e000     +LDI R16 , LOW ( 0 )
000406 e010     +LDI R17 , HIGH ( 0 )
                 	__GETWRN 16,17,0
                 _0x20007:
                +
000407 3000     +CPI R16 , LOW ( 256 )
000408 e0e1     +LDI R30 , HIGH ( 256 )
000409 071e     +CPC R17 , R30
                 	__CPWRN 16,17,256
00040a f478      	BRSH _0x20008
                 ; 0001 0054       dataPage[index] = ReadFlashByte(flashStartAdr + index);
00040b 01f8      	MOVW R30,R16
00040c 81aa      	LDD  R26,Y+2
00040d 81bb      	LDD  R27,Y+2+1
00040e 0fea      	ADD  R30,R26
00040f 1ffb      	ADC  R31,R27
000410 93ff      	PUSH R31
000411 93ef      	PUSH R30
000412 940e 14a6 	CALL SUBOPT_0x12
000414 91af      	POP  R26
000415 91bf      	POP  R27
000416 93ec      	ST   X,R30
                 ; 0001 0055     }
                +
000417 5f0f     +SUBI R16 , LOW ( - 1 )
000418 4f1f     +SBCI R17 , HIGH ( - 1 )
                 	__ADDWRN 16,17,1
000419 cfed      	RJMP _0x20007
                 _0x20008:
                 ; 0001 0056     return TRUE;                            // Return TRUE if valid page address
00041a e0e1      	LDI  R30,LOW(1)
00041b 8119      	LDD  R17,Y+1
00041c 8108      	LDD  R16,Y+0
00041d c1aa      	RJMP _0x20C0017
                 ; 0001 0057   }
                 ; 0001 0058   else{
                 _0x20005:
                 ; 0001 0059     return FALSE;                           // Return FALSE if not valid page address
00041e e0e0      	LDI  R30,LOW(0)
00041f 8119      	LDD  R17,Y+1
000420 8108      	LDD  R16,Y+0
000421 c1a6      	RJMP _0x20C0017
                 ; 0001 005A   }
                 ; 0001 005B }
                 ; .FEND
                 ;unsigned char ReadFlashBytes(MyAddressType flashStartAdr, unsigned char *dataPage, unsigned int length){
                 ; 0001 005C unsigned char ReadFlashBytes(MyAddressType flashStartAdr, unsigned char *dataPage, unsigned int length){
                 _ReadFlashBytes:
                 ; .FSTART _ReadFlashBytes
                 ; 0001 005D   	unsigned int index;
                 ; 0001 005E   	flashStartAdr+=ADR_LIMIT_LOW;
000422 940e 149c 	CALL SUBOPT_0x10
                 ;	flashStartAdr -> Y+6
                 ;	*dataPage -> Y+4
                 ;	length -> Y+2
                 ;	index -> R16,R17
000424 940e 14b1 	CALL SUBOPT_0x13
                +
000426 50e0     +SUBI R30 , LOW ( - 57344 )
000427 42f0     +SBCI R31 , HIGH ( - 57344 )
000428 4f6f     +SBCI R22 , BYTE3 ( - 57344 )
000429 4f7f     +SBCI R23 , BYTE4 ( - 57344 )
                 	__ADDD1N 57344
00042a 940e 14b6 	CALL SUBOPT_0x14
                 ; 0001 005F     for(index = 0; index < length; index++){
                +
00042c e000     +LDI R16 , LOW ( 0 )
00042d e010     +LDI R17 , HIGH ( 0 )
                 	__GETWRN 16,17,0
                 _0x2000B:
00042e 81ea      	LDD  R30,Y+2
00042f 81fb      	LDD  R31,Y+2+1
000430 170e      	CP   R16,R30
000431 071f      	CPC  R17,R31
000432 f4a8      	BRSH _0x2000C
                 ; 0001 0060       dataPage[index] = ReadFlashByte(flashStartAdr + index);
000433 01f8      	MOVW R30,R16
000434 81ac      	LDD  R26,Y+4
000435 81bd      	LDD  R27,Y+4+1
000436 0fea      	ADD  R30,R26
000437 1ffb      	ADC  R31,R27
000438 93ff      	PUSH R31
000439 93ef      	PUSH R30
00043a 01f8      	MOVW R30,R16
00043b 940e 14bb 	CALL SUBOPT_0x15
00043d 2766      	CLR  R22
00043e 2777      	CLR  R23
00043f 940e 178d 	CALL __ADDD21
000441 dfb2      	RCALL _ReadFlashByte
000442 91af      	POP  R26
000443 91bf      	POP  R27
000444 93ec      	ST   X,R30
                 ; 0001 0061     }
                +
000445 5f0f     +SUBI R16 , LOW ( - 1 )
000446 4f1f     +SBCI R17 , HIGH ( - 1 )
                 	__ADDWRN 16,17,1
000447 cfe6      	RJMP _0x2000B
                 _0x2000C:
                 ; 0001 0062     return TRUE;                            // Return TRUE if valid page address
000448 e0e1      	LDI  R30,LOW(1)
000449 8119      	LDD  R17,Y+1
00044a 8108      	LDD  R16,Y+0
                 _0x20C0019:
00044b 962a      	ADIW R28,10
00044c 9508      	RET
                 ; 0001 0063 }
                 ; .FEND
                 ;unsigned char VerifyFlashPage(MyAddressType flashStartAdr, unsigned char *dataPage){
                 ; 0001 0064 unsigned char VerifyFlashPage(MyAddressType flashStartAdr, unsigned char *dataPage){
                 _VerifyFlashPage:
                 ; .FSTART _VerifyFlashPage
                 ; 0001 0065   unsigned int index;
                 ; 0001 0066   if(!(flashStartAdr & (PAGESIZE-1))){      // If input address is a page address
00044d 940e 149c 	CALL SUBOPT_0x10
                 ;	flashStartAdr -> Y+4
                 ;	*dataPage -> Y+2
                 ;	index -> R16,R17
00044f 940e 14a1 	CALL SUBOPT_0x11
000451 30e0      	CPI  R30,0
000452 f4f1      	BRNE _0x2000D
                 ; 0001 0067     for(index = 0; index < PAGESIZE; index++){
                +
000453 e000     +LDI R16 , LOW ( 0 )
000454 e010     +LDI R17 , HIGH ( 0 )
                 	__GETWRN 16,17,0
                 _0x2000F:
                +
000455 3000     +CPI R16 , LOW ( 256 )
000456 e0e1     +LDI R30 , HIGH ( 256 )
000457 071e     +CPC R17 , R30
                 	__CPWRN 16,17,256
000458 f4a0      	BRSH _0x20010
                 ; 0001 0068       if(dataPage[index] != ReadFlashByte(flashStartAdr + index))
000459 01f8      	MOVW R30,R16
00045a 81aa      	LDD  R26,Y+2
00045b 81bb      	LDD  R27,Y+2+1
00045c 0fae      	ADD  R26,R30
00045d 1fbf      	ADC  R27,R31
00045e 91ec      	LD   R30,X
00045f 93ef      	PUSH R30
000460 940e 14a6 	CALL SUBOPT_0x12
000462 91af      	POP  R26
000463 17ea      	CP   R30,R26
000464 f029      	BREQ _0x20011
                 ; 0001 0069       {
                 ; 0001 006A         PORTC.6=0;
000465 98ae      	CBI  0x15,6
                 ; 0001 006B         return FALSE;
000466 e0e0      	LDI  R30,LOW(0)
000467 8119      	LDD  R17,Y+1
000468 8108      	LDD  R16,Y+0
000469 c15e      	RJMP _0x20C0017
                 ; 0001 006C       }
                 ; 0001 006D     }
                 _0x20011:
                +
00046a 5f0f     +SUBI R16 , LOW ( - 1 )
00046b 4f1f     +SBCI R17 , HIGH ( - 1 )
                 	__ADDWRN 16,17,1
00046c cfe8      	RJMP _0x2000F
                 _0x20010:
                 ; 0001 006E     return TRUE;                            // Return TRUE if valid page address
00046d e0e1      	LDI  R30,LOW(1)
00046e 8119      	LDD  R17,Y+1
00046f 8108      	LDD  R16,Y+0
000470 c157      	RJMP _0x20C0017
                 ; 0001 006F   }
                 ; 0001 0070   else{
                 _0x2000D:
                 ; 0001 0071     PORTC.7=0;
000471 98af      	CBI  0x15,7
                 ; 0001 0072     return FALSE;                           // Return FALSE if not valid page address
000472 e0e0      	LDI  R30,LOW(0)
000473 8119      	LDD  R17,Y+1
000474 8108      	LDD  R16,Y+0
000475 c152      	RJMP _0x20C0017
                 ; 0001 0073   }
                 ; 0001 0074 }
                 ; .FEND
                 ;unsigned char WriteFlashBytes(MyAddressType flashAdr, unsigned char *data, unsigned int length)
                 ; 0001 0076 {
                 _WriteFlashBytes:
                 ; .FSTART _WriteFlashBytes
                 ; 0001 0077     unsigned char tempBuffer[PAGESIZE];
                 ; 0001 0078     MyAddressType flashAdrStart,flashAdrNext;
                 ; 0001 0079     unsigned int lengthStart,lengthIndex;                //length=0x20
                 ; 0001 007A     while(length)
000476 93ba      	ST   -Y,R27
000477 93aa      	ST   -Y,R26
000478 9728      	SBIW R28,8
000479 50d1      	SUBI R29,1
00047a 940e 18d0 	CALL __SAVELOCR4
                 ;	flashAdr -> Y+272
                 ;	*data -> Y+270
                 ;	length -> Y+268
                 ;	tempBuffer -> Y+12
                 ;	flashAdrStart -> Y+8
                 ;	flashAdrNext -> Y+4
                 ;	lengthStart -> R16,R17
                 ;	lengthIndex -> R18,R19
                 _0x20017:
00047c 940e 14c0 	CALL SUBOPT_0x16
00047e 9730      	SBIW R30,0
00047f f409      	BRNE PC+2
000480 c091      	RJMP _0x20019
                 ; 0001 007B     {
                 ; 0001 007C         flashAdrStart= flashAdr-(flashAdr%PAGESIZE);//0x1F0-(0x1F0%0x100)=0x0100                        //
000481 940e 14c7 	CALL SUBOPT_0x17
000483 940e 14d4 	CALL SUBOPT_0x18
000485 940e 1797 	CALL __SUBD21
                +
000487 87a8     +STD Y + 8 , R26
000488 87b9     +STD Y + 8 + 1 , R27
000489 878a     +STD Y + 8 + 2 , R24
00048a 879b     +STD Y + 8 + 3 , R25
                 	__PUTD2S 8
                 ; 0001 007D         flashAdrNext = flashAdrStart+PAGESIZE;          //0x0100+0x100=0x200
00048b 940e 14dd 	CALL SUBOPT_0x19
                +
00048d 50e0     +SUBI R30 , LOW ( - 256 )
00048e 4fff     +SBCI R31 , HIGH ( - 256 )
00048f 4f6f     +SBCI R22 , BYTE3 ( - 256 )
000490 4f7f     +SBCI R23 , BYTE4 ( - 256 )
                 	__ADDD1N 256
000491 940e 14e2 	CALL SUBOPT_0x1A
                 ; 0001 007E         if((flashAdrNext - flashAdr) >= length)    //enough space case
000493 940e 14d4 	CALL SUBOPT_0x18
000495 940e 14a1 	CALL SUBOPT_0x11
000497 940e 1792 	CALL __SUBD12
000499 01df      	MOVW R26,R30
00049a 01cb      	MOVW R24,R22
00049b 940e 14c0 	CALL SUBOPT_0x16
00049d 2766      	CLR  R22
00049e 2777      	CLR  R23
00049f 940e 18c9 	CALL __CPD21
0004a1 f060      	BRLO _0x2001A
                 ; 0001 007F         {
                 ; 0001 0080            lengthStart=length;
                +
0004a2 01fe     +MOVW R30 , R28
0004a3 5fe4     +SUBI R30 , LOW ( - 268 )
0004a4 4ffe     +SBCI R31 , HIGH ( - 268 )
0004a5 9101     +LD R16 , Z +
0004a6 8110     +LD R17 , Z
                 	__GETWRSX 16,17,268
                 ; 0001 0081            length=0;
0004a7 e0e0      	LDI  R30,LOW(0)
                +
0004a8 01de     +MOVW R26 , R28
0004a9 5fa4     +SUBI R26 , LOW ( - 268 )
0004aa 4fbe     +SBCI R27 , HIGH ( - 268 )
0004ab 93ed     +ST X + , R30
0004ac 93ec     +ST X , R30
                 	__CLRW1SX 268
                 ; 0001 0082         }
                 ; 0001 0083         else                                   //(0x200-0x1F0)<0x20
0004ad c014      	RJMP _0x2001B
                 _0x2001A:
                 ; 0001 0084         {
                 ; 0001 0085            lengthStart=(flashAdrNext - flashAdr);        //len1=0x200-0x1F0=0x10
                +
0004ae 01de     +MOVW R26 , R28
0004af 5fa0     +SUBI R26 , LOW ( - 272 )
0004b0 4fbe     +SBCI R27 , HIGH ( - 272 )
0004b1 900d     +LD R0 , X +
0004b2 91bc     +LD R27 , X
0004b3 2da0     +MOV R26 , R0
                 	__GETW2SX 272
0004b4 81ec      	LDD  R30,Y+4
0004b5 81fd      	LDD  R31,Y+4+1
0004b6 1bea      	SUB  R30,R26
0004b7 0bfb      	SBC  R31,R27
0004b8 018f      	MOVW R16,R30
                 ; 0001 0086            length-=lengthStart;                         //len2=0x20-0x10=0x10
0004b9 940e 14c0 	CALL SUBOPT_0x16
0004bb 1be0      	SUB  R30,R16
0004bc 0bf1      	SBC  R31,R17
                +
0004bd 01de     +MOVW R26 , R28
0004be 5fa4     +SUBI R26 , LOW ( - 268 )
0004bf 4fbe     +SBCI R27 , HIGH ( - 268 )
0004c0 93ed     +ST X + , R30
0004c1 93fc     +ST X , R31
                 	__PUTW1SX 268
                 ; 0001 0087         }
                 _0x2001B:
                 ; 0001 0088         if(ReadFlashPage(flashAdrStart,tempBuffer)==FALSE) //read flash page to tempBuffer
0004c2 940e 14dd 	CALL SUBOPT_0x19
0004c4 940e 1872 	CALL __PUTPARD1
0004c6 01de      	MOVW R26,R28
0004c7 9650      	ADIW R26,16
0004c8 df34      	RCALL _ReadFlashPage
0004c9 30e0      	CPI  R30,0
0004ca f419      	BRNE _0x2001C
                 ; 0001 0089         {
                 ; 0001 008A             PORTC.3=0;
0004cb 98ab      	CBI  0x15,3
                 ; 0001 008B             return FALSE;
0004cc e0e0      	LDI  R30,LOW(0)
0004cd c045      	RJMP _0x20C0018
                 ; 0001 008C         }
                 ; 0001 008D         for(lengthIndex=(flashAdr%PAGESIZE);lengthIndex<((flashAdr%PAGESIZE)+lengthStart);lengthIndex++)
                 _0x2001C:
                +
0004ce 01fe     +MOVW R30 , R28
0004cf 5fe0     +SUBI R30 , LOW ( - 272 )
0004d0 4ffe     +SBCI R31 , HIGH ( - 272 )
0004d1 9001     +LD R0 , Z +
0004d2 81f0     +LD R31 , Z
0004d3 2de0     +MOV R30 , R0
                 	__GETW1SX 272
0004d4 70f0      	ANDI R31,HIGH(0xFF)
0004d5 019f      	MOVW R18,R30
                 _0x20020:
0004d6 940e 14c7 	CALL SUBOPT_0x17
0004d8 01df      	MOVW R26,R30
0004d9 01cb      	MOVW R24,R22
0004da 01f8      	MOVW R30,R16
0004db 940e 14e7 	CALL SUBOPT_0x1B
0004dd 01d9      	MOVW R26,R18
0004de 2788      	CLR  R24
0004df 2799      	CLR  R25
0004e0 940e 18c9 	CALL __CPD21
0004e2 f4a8      	BRSH _0x20021
                 ; 0001 008E         {
                 ; 0001 008F             tempBuffer[lengthIndex]=*data++;
0004e3 01f9      	MOVW R30,R18
0004e4 01de      	MOVW R26,R28
0004e5 961c      	ADIW R26,12
0004e6 0fea      	ADD  R30,R26
0004e7 1ffb      	ADC  R31,R27
0004e8 010f      	MOVW R0,R30
0004e9 01de      	MOVW R26,R28
0004ea 5fa2      	SUBI R26,LOW(-(270))
0004eb 4fbe      	SBCI R27,HIGH(-(270))
0004ec 91ed      	LD   R30,X+
0004ed 91fd      	LD   R31,X+
0004ee 9631      	ADIW R30,1
0004ef 93fe      	ST   -X,R31
0004f0 93ee      	ST   -X,R30
0004f1 9731      	SBIW R30,1
0004f2 81e0      	LD   R30,Z
0004f3 01d0      	MOVW R26,R0
0004f4 93ec      	ST   X,R30
                 ; 0001 0090         }
                +
0004f5 5f2f     +SUBI R18 , LOW ( - 1 )
0004f6 4f3f     +SBCI R19 , HIGH ( - 1 )
                 	__ADDWRN 18,19,1
0004f7 cfde      	RJMP _0x20020
                 _0x20021:
                 ; 0001 0091         flashAdr=flashAdrNext;
0004f8 940e 14a1 	CALL SUBOPT_0x11
                +
0004fa 01de     +MOVW R26 , R28
0004fb 5fa0     +SUBI R26 , LOW ( - 272 )
0004fc 4fbe     +SBCI R27 , HIGH ( - 272 )
0004fd 93ed     +ST X + , R30
0004fe 93fd     +ST X + , R31
0004ff 936d     +ST X + , R22
000500 937c     +ST X , R23
                 	__PUTD1SX 272
                 ; 0001 0092         if(WriteFlashPage(flashAdrStart+ADR_LIMIT_LOW,tempBuffer)==FALSE) //write tempBuffer to flash page
000501 940e 14dd 	CALL SUBOPT_0x19
                +
000503 50e0     +SUBI R30 , LOW ( - 57344 )
000504 42f0     +SBCI R31 , HIGH ( - 57344 )
000505 4f6f     +SBCI R22 , BYTE3 ( - 57344 )
000506 4f7f     +SBCI R23 , BYTE4 ( - 57344 )
                 	__ADDD1N 57344
000507 940e 1872 	CALL __PUTPARD1
000509 01de      	MOVW R26,R28
00050a 9650      	ADIW R26,16
00050b d00c      	RCALL _WriteFlashPage
00050c 30e0      	CPI  R30,0
00050d f419      	BRNE _0x20022
                 ; 0001 0093         {
                 ; 0001 0094             PORTC.4=0;
00050e 98ac      	CBI  0x15,4
                 ; 0001 0095             return FALSE;
00050f e0e0      	LDI  R30,LOW(0)
000510 c002      	RJMP _0x20C0018
                 ; 0001 0096         }
                 ; 0001 0097     }
                 _0x20022:
000511 cf6a      	RJMP _0x20017
                 _0x20019:
                 ; 0001 0098     return TRUE;
000512 e0e1      	LDI  R30,LOW(1)
                 _0x20C0018:
000513 940e 18d7 	CALL __LOADLOCR4
000515 9664      	ADIW R28,20
000516 5fdf      	SUBI R29,-1
000517 9508      	RET
                 ; 0001 0099 }
                 ; .FEND
                 ;
                 ;/*!
                 ;* The function writes byte data to Flash address flashAddr. Returns FALSE if
                 ;* input address is not valid Flash byte address for writing, else TRUE.
                 ;**/
                 ;unsigned char WriteFlashByte(MyAddressType flashAddr, unsigned char data){
                 ; 0001 009F unsigned char WriteFlashByte(MyAddressType flashAddr, unsigned char data){
                 ; 0001 00A0   MyAddressType  pageAdr;
                 ; 0001 00A1   unsigned char eepromInterruptSettings,saveSREG;
                 ; 0001 00A2   flashAddr+=ADR_LIMIT_LOW;
                 ;	flashAddr -> Y+7
                 ;	data -> Y+6
                 ;	pageAdr -> Y+2
                 ;	eepromInterruptSettings -> R17
                 ;	saveSREG -> R16
                 ; 0001 00A3   if( AddressCheck( flashAddr & ~(PAGESIZE-1) )){
                 ; 0001 00A4 
                 ; 0001 00A5     if(ReadFlashByte(flashAddr)==data)
                 ; 0001 00A6     {
                 ; 0001 00A7         PORTC.4=0;
                 ; 0001 00A8         return TRUE;
                 ; 0001 00A9     }
                 ; 0001 00AA     eepromInterruptSettings= EECR & (1<<EERIE); // Stores EEPROM interrupt mask
                 ; 0001 00AB     EECR &= ~(1<<EERIE);                    // Disable EEPROM interrupt
                 ; 0001 00AC     while(EECR & (1<<EEWE));                // Wait if ongoing EEPROM write
                 ; 0001 00AD     saveSREG=SREG;
                 ; 0001 00AE     #asm("cli")
                 ; 0001 00AF     pageAdr=flashAddr & ~(PAGESIZE-1);      // Gets Flash page address from byte address
                 ; 0001 00B0 
                 ; 0001 00B1     #ifdef __FLASH_RECOVER
                 ; 0001 00B2     FlashBackup.status=0;                   // Inicate that Flash buffer does
                 ; 0001 00B3                                             // not contain data for writing
                 ; 0001 00B4     while(EECR & (1<<EEWE));
                 ; 0001 00B5     LpmReplaceSpm(flashAddr, data);         // Fills Flash write buffer
                 ; 0001 00B6     WriteBufToFlash(ADR_FLASH_BUFFER);      // Writes to Flash recovery buffer
                 ; 0001 00B7     FlashBackup.pageNumber = (unsigned int) (pageAdr/PAGESIZE); // Stores page address
                 ; 0001 00B8                                                        // data should be written to
                 ; 0001 00B9     FlashBackup.status = FLASH_BUFFER_FULL_ID; // Indicates that Flash recovery buffer
                 ; 0001 00BA                                                // contains unwritten data
                 ; 0001 00BB     while(EECR & (1<<EEWE));
                 ; 0001 00BC     #endif
                 ; 0001 00BD 
                 ; 0001 00BE     if(LpmReplaceSpm(flashAddr, data)!=0)         // Fills Flash write buffer
                 ; 0001 00BF     {
                 ; 0001 00C0         _PAGE_WRITE(pageAdr);
                 ; 0001 00C1         PORTC.1=0;
                 ; 0001 00C2     }
                 ; 0001 00C3     else
                 ; 0001 00C4     {
                 ; 0001 00C5         _PAGE_EW(pageAdr);
                 ; 0001 00C6         PORTC.2=0;
                 ; 0001 00C7     }
                 ; 0001 00C8 
                 ; 0001 00C9     #ifdef __FLASH_RECOVER
                 ; 0001 00CA     FlashBackup.status = 0;                 // Indicates that Flash recovery buffer
                 ; 0001 00CB                                             // does not contain unwritten data
                 ; 0001 00CC     while(EECR & (1<<EEWE));
                 ; 0001 00CD     #endif
                 ; 0001 00CE 
                 ; 0001 00CF     EECR |= eepromInterruptSettings;        // Restore EEPROM interrupt mask
                 ; 0001 00D0     SREG=saveSREG;
                 ; 0001 00D1     return TRUE;                            // Return TRUE if address
                 ; 0001 00D2                                             // valid for writing
                 ; 0001 00D3   }
                 ; 0001 00D4   else
                 ; 0001 00D5     return FALSE;                           // Return FALSE if address not
                 ; 0001 00D6                                             // valid for writing
                 ; 0001 00D7 }
                 ;
                 ;/*!
                 ;* The function writes data from array dataPage[] to Flash page address
                 ;* flashStartAdr. The Number of bytes written is depending upon the Flash page
                 ;* size. Returns FALSE if input argument ucFlashStartAdr is not a valid Flash
                 ;* page address for writing, else TRUE.
                 ;**/
                 ;unsigned char WriteFlashPage(MyAddressType flashStartAdr, unsigned char *dataPage)
                 ; 0001 00E0 {
                 _WriteFlashPage:
                 ; .FSTART _WriteFlashPage
                 ; 0001 00E1   unsigned int index;
                 ; 0001 00E2   unsigned char eepromInterruptSettings,saveSREG;
                 ; 0001 00E3   MyAddressType  pageAdr;
                 ; 0001 00E4   flashStartAdr;//+=ADR_LIMIT_LOW;
000518 93ba      	ST   -Y,R27
000519 93aa      	ST   -Y,R26
00051a 9724      	SBIW R28,4
00051b 940e 18d0 	CALL __SAVELOCR4
                 ;	flashStartAdr -> Y+10
                 ;	*dataPage -> Y+8
                 ;	index -> R16,R17
                 ;	eepromInterruptSettings -> R19
                 ;	saveSREG -> R18
                 ;	pageAdr -> Y+4
00051d 940e 14ec 	CALL SUBOPT_0x1C
                 ; 0001 00E5   if( AddressCheck(flashStartAdr) ){
00051f 940e 14f1 	CALL SUBOPT_0x1D
000521 d0a8      	RCALL _AddressCheck
000522 30e0      	CPI  R30,0
000523 f409      	BRNE PC+2
000524 c063      	RJMP _0x20033
                 ; 0001 00E6     if(eepromBackup(flashStartAdr,PAGESIZE,dataPage)==0)
000525 940e 14ec 	CALL SUBOPT_0x1C
000527 940e 1872 	CALL __PUTPARD1
000529 e0e0      	LDI  R30,LOW(256)
00052a e0f1      	LDI  R31,HIGH(256)
00052b 93fa      	ST   -Y,R31
00052c 93ea      	ST   -Y,R30
00052d 85ae      	LDD  R26,Y+14
00052e 85bf      	LDD  R27,Y+14+1
00052f d05d      	RCALL _eepromBackup
000530 30e0      	CPI  R30,0
000531 f429      	BRNE _0x20034
                 ; 0001 00E7     {
                 ; 0001 00E8         return FALSE;
000532 e0e0      	LDI  R30,LOW(0)
000533 940e 18d7 	CALL __LOADLOCR4
000535 962e      	ADIW R28,14
000536 9508      	RET
                 ; 0001 00E9     }
                 ; 0001 00EA     eepromInterruptSettings = EECR & (1<<EERIE); // Stoes EEPROM interrupt mask
                 _0x20034:
000537 b3ec      	IN   R30,0x1C
000538 70e8      	ANDI R30,LOW(0x8)
000539 2f3e      	MOV  R19,R30
                 ; 0001 00EB     EECR &= ~(1<<EERIE);                    // Disable EEPROM interrupt
00053a 98e3      	CBI  0x1C,3
                 ; 0001 00EC     while(EECR & (1<<EEWE));                // Wait if ongoing EEPROM write
                 _0x20035:
00053b 99e1      	SBIC 0x1C,1
00053c cffe      	RJMP _0x20035
                 ; 0001 00ED     saveSREG=SREG;                          // Save SREG
00053d b72f      	IN   R18,63
                 ; 0001 00EE     #asm("cli")
00053e 94f8      	cli
                 ; 0001 00EF 
                 ; 0001 00F0     #ifdef __FLASH_RECOVER
                 ; 0001 00F1     FlashBackup.status=0;                   // Inicate that Flash buffer does
                 ; 0001 00F2                                             // not contain data for writing
                 ; 0001 00F3     while(EECR & (1<<EEWE));
                 ; 0001 00F4 
                 ; 0001 00F5     for(index = 0; index < PAGESIZE; index+=2){ // Fills Flash write buffer
                 ; 0001 00F6       _WAIT_FOR_SPM();
                 ; 0001 00F7       _FILL_TEMP_WORD(index, (unsigned int)dataPage[index]+((unsigned int)dataPage[index+1] << 8));
                 ; 0001 00F8     }
                 ; 0001 00F9 
                 ; 0001 00FA     WriteBufToFlash(ADR_FLASH_BUFFER);      // Writes to Flash recovery buffer
                 ; 0001 00FB     FlashBackup.pageNumber=(unsigned int)(flashStartAdr/PAGESIZE);
                 ; 0001 00FC     FlashBackup.status = FLASH_BUFFER_FULL_ID; // Indicates that Flash recovery buffer
                 ; 0001 00FD                                            // contains unwritten data
                 ; 0001 00FE     while(EECR & (1<<EEWE));
                 ; 0001 00FF     #endif
                 ; 0001 0100 
                 ; 0001 0101     //debug
                 ; 0001 0102     _PAGE_ERASE(flashStartAdr);
00053f 940e 14f1 	CALL SUBOPT_0x1D
                +
000541 91e0 0af9+LDS R30 , ___AddrToZ24ByteToSPMCR_SPM_E + ( 0 )
000543 91f0 0afa+LDS R31 , ___AddrToZ24ByteToSPMCR_SPM_E + ( 0 ) + 1
000545 9509     +ICALL
                 	__CALL1MN ___AddrToZ24ByteToSPMCR_SPM_E,0
                 ; 0001 0103 
                 ; 0001 0104     for(index = 0; index < PAGESIZE; index+=2){ // Fills Flash write buffer
                +
000546 e000     +LDI R16 , LOW ( 0 )
000547 e010     +LDI R17 , HIGH ( 0 )
                 	__GETWRN 16,17,0
                 _0x20039:
                +
000548 3000     +CPI R16 , LOW ( 256 )
000549 e0e1     +LDI R30 , HIGH ( 256 )
00054a 071e     +CPC R17 , R30
                 	__CPWRN 16,17,256
00054b f4e0      	BRSH _0x2003A
                 ; 0001 0105       _FILL_TEMP_WORD(index, (unsigned int)dataPage[index]+((unsigned int)dataPage[index+1] << 8));
00054c 01f8      	MOVW R30,R16
00054d 2766      	CLR  R22
00054e 2777      	CLR  R23
00054f 940e 1872 	CALL __PUTPARD1
000551 01f8      	MOVW R30,R16
000552 85ac      	LDD  R26,Y+12
000553 85bd      	LDD  R27,Y+12+1
000554 0fae      	ADD  R26,R30
000555 1fbf      	ADC  R27,R31
000556 900c      	LD   R0,X
000557 2411      	CLR  R1
000558 9631      	ADIW R30,1
000559 85ac      	LDD  R26,Y+12
00055a 85bd      	LDD  R27,Y+12+1
00055b 0fae      	ADD  R26,R30
00055c 1fbf      	ADC  R27,R31
00055d 91ec      	LD   R30,X
00055e 2ffe      	MOV  R31,R30
00055f e0e0      	LDI  R30,0
000560 01d0      	MOVW R26,R0
000561 0fae      	ADD  R26,R30
000562 1fbf      	ADC  R27,R31
000563 01f5      	MOVW R30,R10
000564 9509      	ICALL
                 ; 0001 0106     }
                +
000565 5f0e     +SUBI R16 , LOW ( - 2 )
000566 4f1f     +SBCI R17 , HIGH ( - 2 )
                 	__ADDWRN 16,17,2
000567 cfe0      	RJMP _0x20039
                 _0x2003A:
                 ; 0001 0107     _PAGE_WRITE(flashStartAdr);
000568 940e 14f1 	CALL SUBOPT_0x1D
00056a 01f6      	MOVW R30,R12
00056b 9509      	ICALL
                 ; 0001 0108     if(VerifyFlashPage(flashStartAdr,dataPage)==FALSE)
00056c 940e 14ec 	CALL SUBOPT_0x1C
00056e 940e 1872 	CALL __PUTPARD1
000570 85ac      	LDD  R26,Y+12
000571 85bd      	LDD  R27,Y+12+1
000572 deda      	RCALL _VerifyFlashPage
000573 30e0      	CPI  R30,0
000574 f429      	BRNE _0x2003B
                 ; 0001 0109     {
                 ; 0001 010A       //PORTC.6=0;
                 ; 0001 010B       return FALSE;
000575 e0e0      	LDI  R30,LOW(0)
000576 940e 18d7 	CALL __LOADLOCR4
000578 940c 0abc 	JMP  _0x20C0011
                 ; 0001 010C     }
                 ; 0001 010D     #ifdef __FLASH_RECOVER
                 ; 0001 010E       FlashBackup.status=0;                 // Inicate that Flash buffer does
                 ; 0001 010F                                             // not contain data for writing
                 ; 0001 0110       while(EECR & (1<<EEWE));
                 ; 0001 0111     #endif
                 ; 0001 0112 
                 ; 0001 0113     EECR |= eepromInterruptSettings;        // Restore EEPROM interrupt mask
                 _0x2003B:
00057a b3ec      	IN   R30,0x1C
00057b 2be3      	OR   R30,R19
00057c bbec      	OUT  0x1C,R30
                 ; 0001 0114     SREG=saveSREG;                          // Restore interrupts to SREG
00057d bf2f      	OUT  0x3F,R18
                 ; 0001 0115     _EepromBackup.status=0;
                +
00057e e1a0     +LDI R26 , LOW ( __EepromBackup + ( 6 ) )
00057f e0b0     +LDI R27 , HIGH ( __EepromBackup + ( 6 ) )
                 	__POINTW2MN __EepromBackup,6
000580 e0e0      	LDI  R30,LOW(0)
000581 940e 18a5 	CALL __EEPROMWRB
                 ; 0001 0116     return TRUE;                            // Return TRUE if address                                            // vali ...
000583 e0e1      	LDI  R30,LOW(1)
000584 940e 18d7 	CALL __LOADLOCR4
000586 940c 0abc 	JMP  _0x20C0011
                 ; 0001 0117   }
                 ; 0001 0118   else
                 _0x20033:
                 ; 0001 0119     return FALSE;                           // Return FALSE if not address not
000588 e0e0      	LDI  R30,LOW(0)
000589 940e 18d7 	CALL __LOADLOCR4
00058b 940c 0abc 	JMP  _0x20C0011
                 ; 0001 011A                                             // valid for writing
                 ; 0001 011B }
                 ; .FEND
                 ;
                 ;unsigned char eepromBackup(unsigned long flashStartAdr, unsigned int length, unsigned char *data)
                 ; 0001 011E {
                 _eepromBackup:
                 ; .FSTART _eepromBackup
                 ; 0001 011F     _EepromBackup.flashStartAdr=flashStartAdr;
00058d 93ba      	ST   -Y,R27
00058e 93aa      	ST   -Y,R26
                 ;	flashStartAdr -> Y+4
                 ;	length -> Y+2
                 ;	*data -> Y+0
00058f 940e 14a1 	CALL SUBOPT_0x11
000591 e0aa      	LDI  R26,LOW(__EepromBackup)
000592 e0b0      	LDI  R27,HIGH(__EepromBackup)
000593 940e 1895 	CALL __EEPROMWRD
                 ; 0001 0120     _EepromBackup.length=length;
                +
000595 e0ae     +LDI R26 , LOW ( __EepromBackup + ( 4 ) )
000596 e0b0     +LDI R27 , HIGH ( __EepromBackup + ( 4 ) )
                 	__POINTW2MN __EepromBackup,4
000597 81ea      	LDD  R30,Y+2
000598 81fb      	LDD  R31,Y+2+1
000599 940e 189d 	CALL __EEPROMWRW
                 ; 0001 0121     for(;length>0;length--)
                 _0x2003E:
00059b 81aa      	LDD  R26,Y+2
00059c 81bb      	LDD  R27,Y+2+1
00059d 940e 18ba 	CALL __CPW02
00059f f518      	BRSH _0x2003F
                 ; 0001 0122     {
                 ; 0001 0123          _EepromBackup.data[length-1]=data[length-1];
                +
0005a0 e1a1     +LDI R26 , LOW ( __EepromBackup + ( 7 ) )
0005a1 e0b0     +LDI R27 , HIGH ( __EepromBackup + ( 7 ) )
                 	__POINTW2MN __EepromBackup,7
0005a2 81ea      	LDD  R30,Y+2
0005a3 81fb      	LDD  R31,Y+2+1
0005a4 9731      	SBIW R30,1
0005a5 0fea      	ADD  R30,R26
0005a6 1ffb      	ADC  R31,R27
0005a7 010f      	MOVW R0,R30
0005a8 940e 14f6 	CALL SUBOPT_0x1E
0005aa 01d0      	MOVW R26,R0
0005ab 940e 18a5 	CALL __EEPROMWRB
                 ; 0001 0124          if(_EepromBackup.data[length-1]!=data[length-1])
                +
0005ad e1a1     +LDI R26 , LOW ( __EepromBackup + ( 7 ) )
0005ae e0b0     +LDI R27 , HIGH ( __EepromBackup + ( 7 ) )
                 	__POINTW2MN __EepromBackup,7
0005af 81ea      	LDD  R30,Y+2
0005b0 81fb      	LDD  R31,Y+2+1
0005b1 9731      	SBIW R30,1
0005b2 0fae      	ADD  R26,R30
0005b3 1fbf      	ADC  R27,R31
0005b4 940e 1889 	CALL __EEPROMRDB
0005b6 2e0e      	MOV  R0,R30
0005b7 940e 14f6 	CALL SUBOPT_0x1E
0005b9 15e0      	CP   R30,R0
0005ba f011      	BREQ _0x20040
                 ; 0001 0125          {
                 ; 0001 0126             return FALSE;//error during backup on eeprom
0005bb e0e0      	LDI  R30,LOW(0)
0005bc c00b      	RJMP _0x20C0017
                 ; 0001 0127          }
                 ; 0001 0128     }
                 _0x20040:
0005bd 81ea      	LDD  R30,Y+2
0005be 81fb      	LDD  R31,Y+2+1
0005bf 9731      	SBIW R30,1
0005c0 83ea      	STD  Y+2,R30
0005c1 83fb      	STD  Y+2+1,R31
0005c2 cfd8      	RJMP _0x2003E
                 _0x2003F:
                 ; 0001 0129     _EepromBackup.status=1;//1=ready to move to flash
                +
0005c3 e1a0     +LDI R26 , LOW ( __EepromBackup + ( 6 ) )
0005c4 e0b0     +LDI R27 , HIGH ( __EepromBackup + ( 6 ) )
                 	__POINTW2MN __EepromBackup,6
0005c5 e0e1      	LDI  R30,LOW(1)
0005c6 940e 18a5 	CALL __EEPROMWRB
                 ; 0001 012A     return TRUE;
                 _0x20C0017:
0005c8 9628      	ADIW R28,8
0005c9 9508      	RET
                 ; 0001 012B }
                 ; .FEND
                 ;
                 ;/*!
                 ;* The function checks if global variable FlashBackup.status indicates that Flash recovery
                 ;* buffer contains data that needs to be written to Flash. Writes data from
                 ;* Flash recovery buffer to Flash page address given by FLASH_recovery.pageAdr.
                 ;* This function should be called at program startup if FLASH recovery option
                 ;* is enabeled.
                 ;**/
                 ;unsigned char RecoverFlash(){
                 ; 0001 0134 unsigned char RecoverFlash(){
                 ; 0001 0135 #ifdef __FLASH_RECOVER
                 ; 0001 0136   unsigned int index;
                 ; 0001 0137   unsigned long flashStartAdr = (MyAddressType)FlashBackup.pageNumber * PAGESIZE;
                 ; 0001 0138   if(FlashBackup.status == FLASH_BUFFER_FULL_ID){ // Checks if Flash recovery
                 ; 0001 0139                                                   //  buffer contains data
                 ; 0001 013A 
                 ; 0001 013B     for(index=0; index < PAGESIZE; index+=2){     // Writes to Flash write buffer
                 ; 0001 013C         _WAIT_FOR_SPM();
                 ; 0001 013D         _FILL_TEMP_WORD( index, *((MyFlashIntPointer)(ADR_FLASH_BUFFER+index)) );
                 ; 0001 013E     }
                 ; 0001 013F 
                 ; 0001 0140 
                 ; 0001 0141     //WriteBufToFlash((MyAddressType)FlashBackup.pageNumber * PAGESIZE);
                 ; 0001 0142     _WAIT_FOR_SPM();
                 ; 0001 0143     _PAGE_ERASE( flashStartAdr );
                 ; 0001 0144     _WAIT_FOR_SPM();
                 ; 0001 0145     _PAGE_WRITE( flashStartAdr );
                 ; 0001 0146     _WAIT_FOR_SPM();
                 ; 0001 0147     _ENABLE_RWW_SECTION();
                 ; 0001 0148     FlashBackup.status=0;                   // Inicate that Flash buffer does
                 ; 0001 0149                                             // not contain data for writing
                 ; 0001 014A     while(EECR & (1<<EEWE));
                 ; 0001 014B     return TRUE;                            // Returns TRUE if recovery has
                 ; 0001 014C                                             // taken place
                 ; 0001 014D   }
                 ; 0001 014E #endif
                 ; 0001 014F   return FALSE;
                 ; 0001 0150 }
                 ;
                 ;
                 ;/*!
                 ;* The function checks if input argument is a valid Flash page address for
                 ;* writing. Returns TRUE only if:
                 ;* - Address points to the beginning of a Flash page
                 ;* - Address is within the limits defined in Self_programming.h
                 ;* - Address is not equal to page address used for buffring by the Flash recovery
                 ;*   functions (if enabled).
                 ;* Returns FALSE else.
                 ;**/
                 ;unsigned char AddressCheck(MyAddressType flashAdr){
                 ; 0001 015C unsigned char AddressCheck(MyAddressType flashAdr){
                 _AddressCheck:
                 ; .FSTART _AddressCheck
                 ; 0001 015D   #ifdef __FLASH_RECOVER
                 ; 0001 015E   // The next line gives a warning 'pointless comparison with zero' if ADR_LIMIT_LOW is 0. Ignore it.
                 ; 0001 015F   if( (flashAdr >= ADR_LIMIT_LOW) && (flashAdr <= ADR_LIMIT_HIGH) &&
                 ; 0001 0160       (flashAdr != ADR_FLASH_BUFFER) && !(flashAdr & (PAGESIZE-1)) )
                 ; 0001 0161     return TRUE;                            // Address is a valid page address
                 ; 0001 0162   else
                 ; 0001 0163     return FALSE;                           // Address is not a valid page address
                 ; 0001 0164   #else
                 ; 0001 0165   if((flashAdr >= ADR_LIMIT_LOW) && (flashAdr <= ADR_LIMIT_HIGH) && !(flashAdr & (PAGESIZE-1) ) )
0005ca 940e 1877 	CALL __PUTPARD2
                 ;	flashAdr -> Y+0
0005cc 940e 186d 	CALL __GETD2S0
                +
0005ce 30a0     +CPI R26 , LOW ( 0xE000 )
0005cf eee0     +LDI R30 , HIGH ( 0xE000 )
0005d0 07be     +CPC R27 , R30
0005d1 e0e0     +LDI R30 , BYTE3 ( 0xE000 )
0005d2 078e     +CPC R24 , R30
0005d3 e0e0     +LDI R30 , BYTE4 ( 0xE000 )
0005d4 079e     +CPC R25 , R30
                 	__CPD2N 0xE000
0005d5 f060      	BRLO _0x20042
                +
0005d6 30a0     +CPI R26 , LOW ( 0x1E000 )
0005d7 eee0     +LDI R30 , HIGH ( 0x1E000 )
0005d8 07be     +CPC R27 , R30
0005d9 e0e1     +LDI R30 , BYTE3 ( 0x1E000 )
0005da 078e     +CPC R24 , R30
0005db e0e0     +LDI R30 , BYTE4 ( 0x1E000 )
0005dc 079e     +CPC R25 , R30
                 	__CPD2N 0x1E000
0005dd f420      	BRSH _0x20042
0005de 940e 1499 	CALL SUBOPT_0xF
0005e0 30e0      	CPI  R30,0
0005e1 f009      	BREQ _0x20043
                 _0x20042:
0005e2 c002      	RJMP _0x20041
                 _0x20043:
                 ; 0001 0166     return TRUE;                            // Address is a valid page address
0005e3 e0e1      	LDI  R30,LOW(1)
0005e4 c001      	RJMP _0x20C0016
                 ; 0001 0167   else
                 _0x20041:
                 ; 0001 0168     return FALSE;                           // Address is not a valid page address
0005e5 e0e0      	LDI  R30,LOW(0)
                 ; 0001 0169   #endif
                 ; 0001 016A }
                 _0x20C0016:
0005e6 9624      	ADIW R28,4
0005e7 9508      	RET
                 ; .FEND
                 ;
                 ;
                 ;/*!
                 ;* The function reads Flash page given by flashAddr, replaces one byte given by
                 ;* flashAddr with data, and stores entire page in Flash temporary buffer.
                 ;**/
                 ;unsigned char LpmReplaceSpm(MyAddressType flashAddr, unsigned char data){
                 ; 0001 0171 unsigned char LpmReplaceSpm(MyAddressType flashAddr, unsigned char data){
                 ; 0001 0172 //#pragma diag_suppress=Pe1053 // Suppress warning for conversion from long-type address to flash ptr.
                 ; 0001 0173     unsigned int index, oddByte, pcWord;
                 ; 0001 0174     unsigned char onlyWrite=1;
                 ; 0001 0175     MyAddressType  pageAdr;
                 ; 0001 0176     oddByte=(unsigned char)flashAddr & 1;
                 ;	flashAddr -> Y+12
                 ;	data -> Y+11
                 ;	index -> R16,R17
                 ;	oddByte -> R18,R19
                 ;	pcWord -> R20,R21
                 ;	onlyWrite -> Y+10
                 ;	pageAdr -> Y+6
                 ; 0001 0177     pcWord=(unsigned int)flashAddr & (PAGESIZE-2); // Used when writing FLASH temp buffer
                 ; 0001 0178     pageAdr=flashAddr & ~(PAGESIZE-1);        // Get FLASH page address from byte address
                 ; 0001 0179     //_FILL_TEMP_WORD(index, (unsigned int)dataPage[index]+((unsigned int)dataPage[index+1] << 8));
                 ; 0001 017A     for(index=0; index < PAGESIZE; index+=2){
                 ; 0001 017B         if(index==pcWord){
                 ; 0001 017C           if(oddByte){
                 ; 0001 017D             _FILL_TEMP_WORD( index, (*(MyFlashCharPointer)(flashAddr & ~1) | ((unsigned int)data<<8)) );
                 ; 0001 017E           }                                     // Write odd byte in temporary buffer
                 ; 0001 017F           else{
                 ; 0001 0180             _FILL_TEMP_WORD( index, ( (*( (MyFlashCharPointer)flashAddr+1)<<8)  | data ) );
                 ; 0001 0181           }                                     // Write even byte in temporary buffer
                 ; 0001 0182           if(((*((MyFlashCharPointer)flashAddr))&0xFF)!=0xFF)
                 ; 0001 0183                 onlyWrite=0;
                 ; 0001 0184         }
                 ; 0001 0185         else{
                 ; 0001 0186           _FILL_TEMP_WORD(index, *( (MyFlashIntPointer)(pageAdr+index) ) );
                 ; 0001 0187           //if(*((MyFlashIntPointer)(pageAdr+index)) != 0xFFFF)
                 ; 0001 0188                 //onlyWrite=0;
                 ; 0001 0189         }                                       // Write Flash word directly to temporary buffer
                 ; 0001 018A     }
                 ; 0001 018B     return onlyWrite;
                 ; 0001 018C //#pragma diag_default=Pe1053 // Back to default.
                 ; 0001 018D }
                 ;//-----------------------------------------------------------------------
                 ;// PFF - Low level disk control module for ATmega32
                 ;//-----------------------------------------------------------------------
                 ;#define _WRITE_FUNC	1			//allow write operations
                 ;
                 ;//#include "common.h"
                 ;#include "diskio.h"
                 ;#include "mmc.h"
                 ;#include <mega128.h>
                 	#ifndef __SLEEP_DEFINED__
                 	#endif
                 ;#include <delay.h>
                 ;
                 ;// Definitions for MMC/SDC connection
                 ;
                 ;//#define SD_INS  6
                 ;//#define SD_WP   7
                 ;
                 ;// Definitions for MMC/SDC command
                 ;#define CMD0	(0x40+0)	// GO_IDLE_STATE
                 ;#define CMD1	(0x40+1)	// SEND_OP_COND (MMC)
                 ;#define	ACMD41	(0xC0+41)	// SEND_OP_COND (SDC)
                 ;#define CMD8	(0x40+8)	// SEND_IF_COND
                 ;#define CMD16	(0x40+16)	// SET_BLOCKLEN
                 ;#define CMD17	(0x40+17)	// READ_SINGLE_BLOCK
                 ;#define CMD24	(0x40+24)	// WRITE_BLOCK
                 ;#define CMD55	(0x40+55)	// APP_CMD
                 ;#define CMD58	(0x40+58)	// READ_OCR
                 ;
                 ;//-----------------------------------------------------------------------
                 ;// SPI functions
                 ;//-----------------------------------------------------------------------
                 ;#define hardware_spi //  ,  spi 
                 ;
                 ;#define SPI_PORTX PORTB
                 ;#define SPI_DDRX DDRB
                 ;
                 ;#define SPI_MISO SD_DO
                 ;#define SPI_MOSI SD_DI
                 ;#define SPI_SCK SD_CLK
                 ;#define SPI_SS SD_CS
                 ;
                 ;void INIT_SPI(void) {
                 ; 0002 0029 void INIT_SPI(void) {
                 
                 	.CSEG
                 _INIT_SPI:
                 ; .FSTART _INIT_SPI
                 ; 0002 002A #ifdef hardware_spi
                 ; 0002 002B 	/*  -
                 ; 0002 002C 	  ,  MISO */
                 ; 0002 002D 	SPI_DDRX |= (1 << SPI_MOSI) | (1 << SPI_SCK) | (1 << SPI_SS) | (0 << SPI_MISO);
0005e8 b3e7      	IN   R30,0x17
0005e9 60e7      	ORI  R30,LOW(0x7)
0005ea bbe7      	OUT  0x17,R30
                 ; 0002 002E 	SPI_PORTX |= (1 << SPI_MOSI) | (1 << SPI_SCK) | (1 << SPI_SS) | (1 << SPI_MISO);
0005eb b3e8      	IN   R30,0x18
0005ec 60ef      	ORI  R30,LOW(0xF)
0005ed bbe8      	OUT  0x18,R30
                 ; 0002 002F 
                 ; 0002 0030 	/* spi,  ,,  0*/
                 ; 0002 0031 	SPCR = (1 << SPE) | (0 << DORD) | (1 << MSTR) | (0 << CPOL) | (0 << CPHA) | (0 << SPR1) | (0 << SPR0);
0005ee e5e0      	LDI  R30,LOW(80)
0005ef b9ed      	OUT  0xD,R30
                 ; 0002 0032     SPSR = (1 << SPI2X);
0005f0 e0e1      	LDI  R30,LOW(1)
0005f1 b9ee      	OUT  0xE,R30
                 ; 0002 0033     //SPCR |= (1 << SPR1) | (1 << SPR0);
                 ; 0002 0034     //SPSR &= ~(1 << SPI2X);
                 ; 0002 0035 #else
                 ; 0002 0036 	PORTB |= (1<<SD_CS) | (1<<SD_DO) | (1<<SD_DI)/* | (1<<SD_WP) | (1<<SD_INS)*/;
                 ; 0002 0037 	DDRB |=(1<<SD_CS) | (1<<SD_DI) | (1<<SD_CLK);
                 ; 0002 0038 #endif
                 ; 0002 0039 }
0005f2 9508      	RET
                 ; .FEND
                 ;
                 ;void xmit_spi(BYTE data) {		// Send a byte
                 ; 0002 003B void xmit_spi(BYTE data) {
                 _xmit_spi:
                 ; .FSTART _xmit_spi
                 ; 0002 003C #ifdef hardware_spi
                 ; 0002 003D 	SPDR = data;
0005f3 93aa      	ST   -Y,R26
                 ;	data -> Y+0
0005f4 81e8      	LD   R30,Y
0005f5 b9ef      	OUT  0xF,R30
                 ; 0002 003E 	while (!(SPSR & (1 << SPIF)));
                 _0x40003:
0005f6 9b77      	SBIS 0xE,7
0005f7 cffe      	RJMP _0x40003
                 ; 0002 003F #else
                 ; 0002 0040 	BYTE i;
                 ; 0002 0041 
                 ; 0002 0042 	for (i = 0; i < 8; i++) {
                 ; 0002 0043 		if ((data & 0x80) == 0x00)
                 ; 0002 0044 			PORTB &= ~(1<<SD_DI);
                 ; 0002 0045 		else
                 ; 0002 0046 			PORTB |= (1<<SD_DI);
                 ; 0002 0047 		data = data << 1;
                 ; 0002 0048 		PORTB |= (1<<SD_CLK);
                 ; 0002 0049 		#asm("nop")
                 ; 0002 004A 		PORTB &= ~(1<<SD_CLK);
                 ; 0002 004B 	}
                 ; 0002 004C #endif
                 ; 0002 004D }
0005f8 9621      	ADIW R28,1
0005f9 9508      	RET
                 ; .FEND
                 ;
                 ;BYTE rcv_spi(void) {				// Send 0xFF and receive a byte
                 ; 0002 004F BYTE rcv_spi(void) {
                 _rcv_spi:
                 ; .FSTART _rcv_spi
                 ; 0002 0050 #ifdef hardware_spi
                 ; 0002 0051 	unsigned char data;
                 ; 0002 0052 	SPDR = 0xFF;
0005fa 931a      	ST   -Y,R17
                 ;	data -> R17
0005fb efef      	LDI  R30,LOW(255)
0005fc b9ef      	OUT  0xF,R30
                 ; 0002 0053 	while (!(SPSR & (1 << SPIF)));
                 _0x40006:
0005fd 9b77      	SBIS 0xE,7
0005fe cffe      	RJMP _0x40006
                 ; 0002 0054 	data = SPDR;
0005ff b11f      	IN   R17,15
                 ; 0002 0055 	return data;
000600 2fe1      	MOV  R30,R17
000601 9119      	LD   R17,Y+
000602 9508      	RET
                 ; 0002 0056 #else
                 ; 0002 0057 	BYTE i, res = 0;
                 ; 0002 0058 
                 ; 0002 0059 	PORTB |= (1<<SD_DI);
                 ; 0002 005A 
                 ; 0002 005B 	for (i = 0; i < 8; i++) {
                 ; 0002 005C 		PORTB |= (1<<SD_CLK);
                 ; 0002 005D 		res = res << 1;
                 ; 0002 005E 		if ((PINB & (1<<SD_DO))!=0x00)
                 ; 0002 005F 		res = res | 0x01;
                 ; 0002 0060 		PORTB &= ~(1<<SD_CLK);
                 ; 0002 0061 		#asm("nop")
                 ; 0002 0062 	}
                 ; 0002 0063 	return res;
                 ; 0002 0064 #endif
                 ; 0002 0065 } /* Send 0xFF and receive a byte */
                 ; .FEND
                 ;//-----------------------------------------------------------------------
                 ;
                 ;
                 ;
                 ;//-----------------------------------------------------------------------
                 ;//   Module Private Function
                 ;//-----------------------------------------------------------------------
                 ;static BYTE CardType;
                 ;
                 ;//-----------------------------------------------------------------------
                 ;// Deselect the card and release SPI bus
                 ;//-----------------------------------------------------------------------
                 ;static
                 ;void release_spi (void)
                 ; 0002 0074 {
                 _release_spi_G002:
                 ; .FSTART _release_spi_G002
                 ; 0002 0075 	rcv_spi();
000603 dff6      	RCALL _rcv_spi
                 ; 0002 0076 }
000604 9508      	RET
                 ; .FEND
                 ;
                 ;//-----------------------------------------------------------------------
                 ;// Send a command packet to MMC
                 ;//-----------------------------------------------------------------------
                 ;static
                 ;BYTE send_cmd (
                 ; 0002 007D 	BYTE cmd,		// Command byte
                 ; 0002 007E 	DWORD arg		// Argument
                 ; 0002 007F )
                 ; 0002 0080 {
                 _send_cmd_G002:
                 ; .FSTART _send_cmd_G002
                 ; 0002 0081 	BYTE n, res;
                 ; 0002 0082 
                 ; 0002 0083 
                 ; 0002 0084 	if (cmd & 0x80) {	// ACMD<n> is the command sequense of CMD55-CMD<n>
000605 940e 1877 	CALL __PUTPARD2
000607 931a      	ST   -Y,R17
000608 930a      	ST   -Y,R16
                 ;	cmd -> Y+6
                 ;	arg -> Y+2
                 ;	n -> R17
                 ;	res -> R16
000609 81ee      	LDD  R30,Y+6
00060a 78e0      	ANDI R30,LOW(0x80)
00060b f049      	BREQ _0x40009
                 ; 0002 0085 		cmd &= 0x7F;
00060c 81ee      	LDD  R30,Y+6
00060d 77ef      	ANDI R30,0x7F
00060e 83ee      	STD  Y+6,R30
                 ; 0002 0086 		res = send_cmd(CMD55, 0);
00060f e7e7      	LDI  R30,LOW(119)
000610 940e 14ff 	CALL SUBOPT_0x1F
000612 2f0e      	MOV  R16,R30
                 ; 0002 0087 		if (res > 1) return res;
000613 3002      	CPI  R16,2
000614 f570      	BRSH _0x20C0014
                 ; 0002 0088 	}
                 ; 0002 0089 
                 ; 0002 008A 	// Select the card
                 ; 0002 008B 	DESELECT();
                 _0x40009:
000615 9ac0      	SBI  0x18,0
                 ; 0002 008C 	rcv_spi();
000616 dfe3      	RCALL _rcv_spi
                 ; 0002 008D 	SELECT();
000617 98c0      	CBI  0x18,0
                 ; 0002 008E 	rcv_spi();
000618 dfe1      	RCALL _rcv_spi
                 ; 0002 008F 
                 ; 0002 0090 	// Send a command packet
                 ; 0002 0091 	xmit_spi(cmd);						// Start + Command index
000619 81ae      	LDD  R26,Y+6
00061a 940e 1506 	CALL SUBOPT_0x20
                 ; 0002 0092 	xmit_spi((BYTE)(arg >> 24));		// Argument[31..24]
00061c e1e8      	LDI  R30,LOW(24)
00061d 940e 17aa 	CALL __LSRD12
00061f 2fae      	MOV  R26,R30
000620 dfd2      	RCALL _xmit_spi
                 ; 0002 0093 	xmit_spi((BYTE)(arg >> 16));		// Argument[23..16]
000621 940e 150d 	CALL SUBOPT_0x21
000623 940e 17cd 	CALL __LSRD16
000625 2fae      	MOV  R26,R30
000626 940e 1506 	CALL SUBOPT_0x20
                 ; 0002 0094 	xmit_spi((BYTE)(arg >> 8));			// Argument[15..8]
000628 e0e8      	LDI  R30,LOW(8)
000629 940e 17aa 	CALL __LSRD12
00062b 2fae      	MOV  R26,R30
00062c dfc6      	RCALL _xmit_spi
                 ; 0002 0095 	xmit_spi((BYTE)arg);				// Argument[7..0]
00062d 81aa      	LDD  R26,Y+2
00062e dfc4      	RCALL _xmit_spi
                 ; 0002 0096 	n = 0x01;							// Dummy CRC + Stop
00062f e011      	LDI  R17,LOW(1)
                 ; 0002 0097 	if (cmd == CMD0) n = 0x95;			// Valid CRC for CMD0(0)
000630 81ae      	LDD  R26,Y+6
000631 34a0      	CPI  R26,LOW(0x40)
000632 f409      	BRNE _0x4000B
000633 e915      	LDI  R17,LOW(149)
                 ; 0002 0098 	if (cmd == CMD8) n = 0x87;			// Valid CRC for CMD8(0x1AA)
                 _0x4000B:
000634 81ae      	LDD  R26,Y+6
000635 34a8      	CPI  R26,LOW(0x48)
000636 f409      	BRNE _0x4000C
000637 e817      	LDI  R17,LOW(135)
                 ; 0002 0099 	xmit_spi(n);
                 _0x4000C:
000638 2fa1      	MOV  R26,R17
000639 dfb9      	RCALL _xmit_spi
                 ; 0002 009A 
                 ; 0002 009B 	// Receive a command response
                 ; 0002 009C 	n = 10;								// Wait for a valid response in timeout of 10 attempts
00063a e01a      	LDI  R17,LOW(10)
                 ; 0002 009D 	do {
                 _0x4000E:
                 ; 0002 009E 		res = rcv_spi();
00063b dfbe      	RCALL _rcv_spi
00063c 2f0e      	MOV  R16,R30
                 ; 0002 009F 	} while ((res & 0x80) && --n);
00063d ff07      	SBRS R16,7
00063e c002      	RJMP _0x40010
00063f 5011      	SUBI R17,LOW(1)
000640 f409      	BRNE _0x40011
                 _0x40010:
000641 c001      	RJMP _0x4000F
                 _0x40011:
000642 cff8      	RJMP _0x4000E
                 _0x4000F:
                 ; 0002 00A0 
                 ; 0002 00A1 	return res;			// Return with the response value
                 _0x20C0014:
000643 2fe0      	MOV  R30,R16
000644 8119      	LDD  R17,Y+1
000645 8108      	LDD  R16,Y+0
                 _0x20C0015:
000646 9627      	ADIW R28,7
000647 9508      	RET
                 ; 0002 00A2 }
                 ; .FEND
                 ;
                 ;//--------------------------------------------------------------------------
                 ;//
                 ;//   Public Functions
                 ;//
                 ;//--------------------------------------------------------------------------
                 ;
                 ;//--------------------------------------------------------------------------
                 ;// Initialize Disk Drive
                 ;//--------------------------------------------------------------------------
                 ;DSTATUS disk_initialize (void)
                 ; 0002 00AE {
                 _disk_initialize:
                 ; .FSTART _disk_initialize
                 ; 0002 00AF 	BYTE n, cmd, ty, ocr[4];
                 ; 0002 00B0 	WORD tmr;
                 ; 0002 00B1     BYTE retry=0;
                 ; 0002 00B2     while(retry<5){
000648 9724      	SBIW R28,4
000649 940e 18ce 	CALL __SAVELOCR6
                 ;	n -> R17
                 ;	cmd -> R16
                 ;	ty -> R19
                 ;	ocr -> Y+6
                 ;	tmr -> R20,R21
                 ;	retry -> R18
00064b e020      	LDI  R18,0
                 _0x40012:
00064c 3025      	CPI  R18,5
00064d f008      	BRLO PC+2
00064e c08b      	RJMP _0x40014
                 ; 0002 00B3         INIT_SPI();
00064f df98      	RCALL _INIT_SPI
                 ; 0002 00B4 
                 ; 0002 00B5     //	if ((PINB&_BV(SD_INS))!=0x00) return STA_NOINIT;
                 ; 0002 00B6 
                 ; 0002 00B7     #if _WRITE_FUNC
                 ; 0002 00B8         //if (MMC_SEL) disk_writep(0, 0);		// Finalize write process if it is in progress
                 ; 0002 00B9     #endif
                 ; 0002 00BA         for (n = 100; n; n--) rcv_spi();	// Dummy clocks
000650 e614      	LDI  R17,LOW(100)
                 _0x40016:
000651 3010      	CPI  R17,0
000652 f019      	BREQ _0x40017
000653 dfa6      	RCALL _rcv_spi
000654 5011      	SUBI R17,1
000655 cffb      	RJMP _0x40016
                 _0x40017:
                 ; 0002 00BC ty = 0;
000656 e030      	LDI  R19,LOW(0)
                 ; 0002 00BD         if (send_cmd(CMD0, 0) == 1) {			// Enter Idle state
000657 e4e0      	LDI  R30,LOW(64)
000658 940e 14ff 	CALL SUBOPT_0x1F
00065a 30e1      	CPI  R30,LOW(0x1)
00065b f009      	BREQ PC+2
00065c c072      	RJMP _0x40018
                 ; 0002 00BE             if (send_cmd(CMD8, 0x1AA) == 1) {	// SDv2
00065d e4e8      	LDI  R30,LOW(72)
00065e 93ea      	ST   -Y,R30
                +
00065f eaaa     +LDI R26 , LOW ( 0x1AA )
000660 e0b1     +LDI R27 , HIGH ( 0x1AA )
000661 e080     +LDI R24 , BYTE3 ( 0x1AA )
000662 e090     +LDI R25 , BYTE4 ( 0x1AA )
                 	__GETD2N 0x1AA
000663 dfa1      	RCALL _send_cmd_G002
000664 30e1      	CPI  R30,LOW(0x1)
000665 f009      	BREQ PC+2
000666 c044      	RJMP _0x40019
                 ; 0002 00BF                 for (n = 0; n < 4; n++) ocr[n] = rcv_spi();		// Get trailing return value of R7 resp
000667 e010      	LDI  R17,LOW(0)
                 _0x4001B:
000668 3014      	CPI  R17,4
000669 f450      	BRSH _0x4001C
00066a 940e 1512 	CALL SUBOPT_0x22
00066c 93ff      	PUSH R31
00066d 93ef      	PUSH R30
00066e df8b      	RCALL _rcv_spi
00066f 91af      	POP  R26
000670 91bf      	POP  R27
000671 93ec      	ST   X,R30
000672 5f1f      	SUBI R17,-1
000673 cff4      	RJMP _0x4001B
                 _0x4001C:
                 ; 0002 00C0 if (ocr[2] == 0x01 && ocr[3] == 0xAA) {
000674 85a8      	LDD  R26,Y+8
000675 30a1      	CPI  R26,LOW(0x1)
000676 f419      	BRNE _0x4001E
000677 85a9      	LDD  R26,Y+9
000678 3aaa      	CPI  R26,LOW(0xAA)
000679 f009      	BREQ _0x4001F
                 _0x4001E:
00067a c02f      	RJMP _0x4001D
                 _0x4001F:
                 ; 0002 00C1                     for (tmr = 12000; tmr && send_cmd(ACMD41, 1UL << 30); tmr--) ;	// Wait for leaving idle state (ACMD4 ...
                +
00067b ee40     +LDI R20 , LOW ( 12000 )
00067c e25e     +LDI R21 , HIGH ( 12000 )
                 	__GETWRN 20,21,12000
                 _0x40021:
00067d 2e04      	MOV  R0,R20
00067e 2a05      	OR   R0,R21
00067f f049      	BREQ _0x40023
000680 eee9      	LDI  R30,LOW(233)
000681 93ea      	ST   -Y,R30
                +
000682 e0a0     +LDI R26 , LOW ( 0x40000000 )
000683 e0b0     +LDI R27 , HIGH ( 0x40000000 )
000684 e080     +LDI R24 , BYTE3 ( 0x40000000 )
000685 e490     +LDI R25 , BYTE4 ( 0x40000000 )
                 	__GETD2N 0x40000000
000686 df7e      	RCALL _send_cmd_G002
000687 30e0      	CPI  R30,0
000688 f409      	BRNE _0x40024
                 _0x40023:
000689 c003      	RJMP _0x40022
                 _0x40024:
                +
00068a 5041     +SUBI R20 , LOW ( 1 )
00068b 4050     +SBCI R21 , HIGH ( 1 )
                 	__SUBWRN 20,21,1
00068c cff0      	RJMP _0x40021
                 _0x40022:
                 ; 0002 00C2                     if (tmr && send_cmd(CMD58, 0) == 0) {		// Check CCS bit in the OCR
00068d 2e04      	MOV  R0,R20
00068e 2a05      	OR   R0,R21
00068f f029      	BREQ _0x40026
000690 e7ea      	LDI  R30,LOW(122)
000691 940e 14ff 	CALL SUBOPT_0x1F
000693 30e0      	CPI  R30,0
000694 f009      	BREQ _0x40027
                 _0x40026:
000695 c014      	RJMP _0x40025
                 _0x40027:
                 ; 0002 00C3                         for (n = 0; n < 4; n++) ocr[n] = rcv_spi();
000696 e010      	LDI  R17,LOW(0)
                 _0x40029:
000697 3014      	CPI  R17,4
000698 f450      	BRSH _0x4002A
000699 940e 1512 	CALL SUBOPT_0x22
00069b 93ff      	PUSH R31
00069c 93ef      	PUSH R30
00069d df5c      	RCALL _rcv_spi
00069e 91af      	POP  R26
00069f 91bf      	POP  R27
0006a0 93ec      	ST   X,R30
0006a1 5f1f      	SUBI R17,-1
0006a2 cff4      	RJMP _0x40029
                 _0x4002A:
                 ; 0002 00C4 ty = (ocr[0] & 0x40) ? 0x04	 | 0x08	 : 0x04	;
0006a3 81ee      	LDD  R30,Y+6
0006a4 74e0      	ANDI R30,LOW(0x40)
0006a5 f011      	BREQ _0x4002B
0006a6 e0ec      	LDI  R30,LOW(12)
0006a7 c001      	RJMP _0x4002C
                 _0x4002B:
0006a8 e0e4      	LDI  R30,LOW(4)
                 _0x4002C:
0006a9 2f3e      	MOV  R19,R30
                 ; 0002 00C5                     }
                 ; 0002 00C6                 }
                 _0x40025:
                 ; 0002 00C7             } else {							// SDv1 or MMCv3
                 _0x4001D:
0006aa c024      	RJMP _0x4002E
                 _0x40019:
                 ; 0002 00C8                 if (send_cmd(ACMD41, 0) <= 1) 	{
0006ab eee9      	LDI  R30,LOW(233)
0006ac 940e 14ff 	CALL SUBOPT_0x1F
0006ae 30e2      	CPI  R30,LOW(0x2)
0006af f418      	BRSH _0x4002F
                 ; 0002 00C9                     ty = CT_SD1; cmd = ACMD41;	// SDv1
0006b0 e032      	LDI  R19,LOW(2)
0006b1 ee09      	LDI  R16,LOW(233)
                 ; 0002 00CA                 } else {
0006b2 c002      	RJMP _0x40030
                 _0x4002F:
                 ; 0002 00CB                     ty = CT_MMC; cmd = CMD1;	// MMCv3
0006b3 e031      	LDI  R19,LOW(1)
0006b4 e401      	LDI  R16,LOW(65)
                 ; 0002 00CC                 }
                 _0x40030:
                 ; 0002 00CD                 for (tmr = 25000; tmr && send_cmd(cmd, 0); tmr--) ;	// Wait for leaving idle state
                +
0006b5 ea48     +LDI R20 , LOW ( 25000 )
0006b6 e651     +LDI R21 , HIGH ( 25000 )
                 	__GETWRN 20,21,25000
                 _0x40032:
0006b7 2e04      	MOV  R0,R20
0006b8 2a05      	OR   R0,R21
0006b9 f031      	BREQ _0x40034
0006ba 930a      	ST   -Y,R16
0006bb 940e 1519 	CALL SUBOPT_0x23
0006bd df47      	RCALL _send_cmd_G002
0006be 30e0      	CPI  R30,0
0006bf f409      	BRNE _0x40035
                 _0x40034:
0006c0 c003      	RJMP _0x40033
                 _0x40035:
                +
0006c1 5041     +SUBI R20 , LOW ( 1 )
0006c2 4050     +SBCI R21 , HIGH ( 1 )
                 	__SUBWRN 20,21,1
0006c3 cff3      	RJMP _0x40032
                 _0x40033:
                 ; 0002 00CE                 if (!tmr || send_cmd(CMD16, 512) != 0)			// Set R/W block length to 512
0006c4 2e04      	MOV  R0,R20
0006c5 2a05      	OR   R0,R21
0006c6 f039      	BREQ _0x40037
0006c7 e5e0      	LDI  R30,LOW(80)
0006c8 93ea      	ST   -Y,R30
0006c9 940e 151e 	CALL SUBOPT_0x24
0006cb df39      	RCALL _send_cmd_G002
0006cc 30e0      	CPI  R30,0
0006cd f009      	BREQ _0x40036
                 _0x40037:
                 ; 0002 00CF                     ty = 0;
0006ce e030      	LDI  R19,LOW(0)
                 ; 0002 00D0             }
                 _0x40036:
                 _0x4002E:
                 ; 0002 00D1         }
                 ; 0002 00D2         CardType = ty;
                 _0x40018:
0006cf 9330 0afd 	STS  _CardType_G002,R19
                 ; 0002 00D3         release_spi();
0006d1 df31      	RCALL _release_spi_G002
                 ; 0002 00D4         if(ty){
0006d2 3030      	CPI  R19,0
0006d3 f431      	BRNE _0x40014
                 ; 0002 00D5            break;
                 ; 0002 00D6         }
                 ; 0002 00D7         retry++;
0006d4 5f2f      	SUBI R18,-1
                 ; 0002 00D8         delay_ms(200);
0006d5 eca8      	LDI  R26,LOW(200)
0006d6 e0b0      	LDI  R27,0
0006d7 940e 177a 	CALL _delay_ms
                 ; 0002 00D9     }
0006d9 cf72      	RJMP _0x40012
                 _0x40014:
                 ; 0002 00DA #ifdef hardware_spi
                 ; 0002 00DB 	//  SPI!!!--------------------------------------------
                 ; 0002 00DC     //INIT_SPI();
                 ; 0002 00DD     //SPCR &= ~((1 << SPR1) | (1 << SPR0)); //  
                 ; 0002 00DE 	//SPSR |= (1 << SPI2X); //  
                 ; 0002 00DF 
                 ; 0002 00E0 #else
                 ; 0002 00E1     //------------------------------------------------------------------
                 ; 0002 00E2 #endif
                 ; 0002 00E3 
                 ; 0002 00E4 	return ty ? 0 : STA_NOINIT;
0006da 3030      	CPI  R19,0
0006db f011      	BREQ _0x4003A
0006dc e0e0      	LDI  R30,LOW(0)
0006dd c001      	RJMP _0x4003B
                 _0x4003A:
0006de e0e1      	LDI  R30,LOW(1)
                 _0x4003B:
0006df c43b      	RJMP _0x20C0010
                 ; 0002 00E5 }
                 ; .FEND
                 ;//-----------------------------------------------------------------------
                 ;// Read partial sector
                 ;//-----------------------------------------------------------------------
                 ;
                 ;DRESULT disk_readp (
                 ; 0002 00EB 	BYTE *buff,		// Pointer to the read buffer (NULL:Read bytes are forwarded to the stream)
                 ; 0002 00EC 	DWORD lba,		// Sector number (LBA)
                 ; 0002 00ED 	WORD ofs,		// Byte offset to read from (0..511)
                 ; 0002 00EE 	WORD cnt		// Number of bytes to read (ofs + cnt mus be <= 512)
                 ; 0002 00EF )
                 ; 0002 00F0 {
                 _disk_readp:
                 ; .FSTART _disk_readp
                 ; 0002 00F1 	DRESULT res;
                 ; 0002 00F2 	BYTE rc;
                 ; 0002 00F3 	WORD bc;
                 ; 0002 00F4 
                 ; 0002 00F5 //	if ((PINB&_BV(SD_INS))!=0x00) return RES_ERROR;
                 ; 0002 00F6 
                 ; 0002 00F7 	if (!(CardType & CT_BLOCK)) lba *= 512;		// Convert to byte address if needed
0006e0 940e 1523 	CALL SUBOPT_0x25
                 ;	*buff -> Y+12
                 ;	lba -> Y+8
                 ;	ofs -> Y+6
                 ;	cnt -> Y+4
                 ;	res -> R17
                 ;	rc -> R16
                 ;	bc -> R18,R19
0006e2 91e0 0afd 	LDS  R30,_CardType_G002
0006e4 70e8      	ANDI R30,LOW(0x8)
0006e5 f441      	BRNE _0x4003D
0006e6 940e 14dd 	CALL SUBOPT_0x19
0006e8 940e 1528 	CALL SUBOPT_0x26
                +
0006ea 87e8     +STD Y + 8 , R30
0006eb 87f9     +STD Y + 8 + 1 , R31
0006ec 876a     +STD Y + 8 + 2 , R22
0006ed 877b     +STD Y + 8 + 3 , R23
                 	__PUTD1S 8
                 ; 0002 00F8 
                 ; 0002 00F9 	res = RES_ERROR;
                 _0x4003D:
0006ee e011      	LDI  R17,LOW(1)
                 ; 0002 00FA 	if (send_cmd(CMD17, lba) == 0) {		// READ_SINGLE_BLOCK
0006ef e5e1      	LDI  R30,LOW(81)
0006f0 93ea      	ST   -Y,R30
0006f1 940e 152c 	CALL SUBOPT_0x27
0006f3 df11      	RCALL _send_cmd_G002
0006f4 30e0      	CPI  R30,0
0006f5 f009      	BREQ PC+2
0006f6 c047      	RJMP _0x4003E
                 ; 0002 00FB 
                 ; 0002 00FC 		bc = 30000;
                +
0006f7 e320     +LDI R18 , LOW ( 30000 )
0006f8 e735     +LDI R19 , HIGH ( 30000 )
                 	__GETWRN 18,19,30000
                 ; 0002 00FD 		do {							// Wait for data packet in timeout of 100ms
                 _0x40040:
                 ; 0002 00FE 			rc = rcv_spi();
0006f9 df00      	RCALL _rcv_spi
0006fa 2f0e      	MOV  R16,R30
                 ; 0002 00FF 		} while (rc == 0xFF && --bc);
0006fb 3f0f      	CPI  R16,255
0006fc f419      	BRNE _0x40042
                +
0006fd 5021     +SUBI R18 , LOW ( 1 )
0006fe 4030     +SBCI R19 , HIGH ( 1 )
                 	__SUBWRN 18,19,1
0006ff f409      	BRNE _0x40043
                 _0x40042:
000700 c001      	RJMP _0x40041
                 _0x40043:
000701 cff7      	RJMP _0x40040
                 _0x40041:
                 ; 0002 0100 
                 ; 0002 0101 		if (rc == 0xFE) {				// A data packet arrived
000702 3f0e      	CPI  R16,254
000703 f5d1      	BRNE _0x40044
                 ; 0002 0102 			bc = 514 - ofs - cnt;
000704 81ae      	LDD  R26,Y+6
000705 81bf      	LDD  R27,Y+6+1
000706 e0e2      	LDI  R30,LOW(514)
000707 e0f2      	LDI  R31,HIGH(514)
000708 1bea      	SUB  R30,R26
000709 0bfb      	SBC  R31,R27
00070a 01df      	MOVW R26,R30
00070b 81ec      	LDD  R30,Y+4
00070c 81fd      	LDD  R31,Y+4+1
00070d 1bae      	SUB  R26,R30
00070e 0bbf      	SBC  R27,R31
00070f 019d      	MOVW R18,R26
                 ; 0002 0103 
                 ; 0002 0104 			// Skip leading bytes
                 ; 0002 0105 			if (ofs) {
000710 81ee      	LDD  R30,Y+6
000711 81ff      	LDD  R31,Y+6+1
000712 9730      	SBIW R30,0
000713 f039      	BREQ _0x40045
                 ; 0002 0106 				do rcv_spi(); while (--ofs);
                 _0x40047:
000714 dee5      	RCALL _rcv_spi
000715 81ee      	LDD  R30,Y+6
000716 81ff      	LDD  R31,Y+6+1
000717 9731      	SBIW R30,1
000718 83ee      	STD  Y+6,R30
000719 83ff      	STD  Y+6+1,R31
00071a f7c9      	BRNE _0x40047
                 ; 0002 0107 			}
                 ; 0002 0108 
                 ; 0002 0109 			// Receive a part of the sector
                 ; 0002 010A 			if (buff) {	// Store data to the memory
                 _0x40045:
00071b 85ec      	LDD  R30,Y+12
00071c 85fd      	LDD  R31,Y+12+1
00071d 9730      	SBIW R30,0
00071e f099      	BREQ _0x40049
                 ; 0002 010B 				do
                 _0x4004B:
                 ; 0002 010C 					*buff++ = rcv_spi();
00071f 85ec      	LDD  R30,Y+12
000720 85fd      	LDD  R31,Y+12+1
000721 9631      	ADIW R30,1
000722 87ec      	STD  Y+12,R30
000723 87fd      	STD  Y+12+1,R31
000724 9731      	SBIW R30,1
000725 93ff      	PUSH R31
000726 93ef      	PUSH R30
000727 ded2      	RCALL _rcv_spi
000728 91af      	POP  R26
000729 91bf      	POP  R27
00072a 93ec      	ST   X,R30
                 ; 0002 010D 				while (--cnt);
00072b 81ec      	LDD  R30,Y+4
00072c 81fd      	LDD  R31,Y+4+1
00072d 9731      	SBIW R30,1
00072e 83ec      	STD  Y+4,R30
00072f 83fd      	STD  Y+4+1,R31
000730 f771      	BRNE _0x4004B
                 ; 0002 010E 			} else {	// Forward data to the outgoing stream (depends on the project)
000731 c006      	RJMP _0x4004D
                 _0x40049:
                 ; 0002 010F 				do
                 _0x4004F:
                 ; 0002 0110                 ;//uart_transmit(rcv_spi());		// (Console output)
                 ; 0002 0111 				while (--cnt);
000732 81ec      	LDD  R30,Y+4
000733 81fd      	LDD  R31,Y+4+1
000734 9731      	SBIW R30,1
000735 83ec      	STD  Y+4,R30
000736 83fd      	STD  Y+4+1,R31
000737 f7d1      	BRNE _0x4004F
                 ; 0002 0112 			}
                 _0x4004D:
                 ; 0002 0113 
                 ; 0002 0114 			// Skip trailing bytes and CRC
                 ; 0002 0115 			do rcv_spi(); while (--bc);
                 _0x40052:
000738 dec1      	RCALL _rcv_spi
000739 01f9      	MOVW R30,R18
00073a 9731      	SBIW R30,1
00073b 019f      	MOVW R18,R30
00073c f7d9      	BRNE _0x40052
                 ; 0002 0116 
                 ; 0002 0117 			res = RES_OK;
00073d e010      	LDI  R17,LOW(0)
                 ; 0002 0118 		}
                 ; 0002 0119 	}
                 _0x40044:
                 ; 0002 011A 
                 ; 0002 011B 	release_spi();
                 _0x4003E:
00073e dec4      	RCALL _release_spi_G002
                 ; 0002 011C 
                 ; 0002 011D 	return res;
00073f 2fe1      	MOV  R30,R17
000740 940e 18d7 	CALL __LOADLOCR4
000742 c379      	RJMP _0x20C0011
                 ; 0002 011E }
                 ; .FEND
                 ;
                 ;//-----------------------------------------------------------------------
                 ;// Write partial sector
                 ;//-----------------------------------------------------------------------
                 ;#if _WRITE_FUNC
                 ;
                 ;DRESULT disk_writep (
                 ; 0002 0126 	const BYTE *buff,	// Pointer to the bytes to be written (NULL:Initiate/Finalize sector write)
                 ; 0002 0127 	DWORD sa			// Number of bytes to send, Sector number (LBA) or zero
                 ; 0002 0128 )
                 ; 0002 0129 {
                 _disk_writep:
                 ; .FSTART _disk_writep
                 ; 0002 012A 	DRESULT res;
                 ; 0002 012B 	WORD bc;
                 ; 0002 012C 	static WORD wc;
                 ; 0002 012D 
                 ; 0002 012E //	if ((PINB&_BV(SD_INS))!=0x00) return RES_ERROR;
                 ; 0002 012F //	if ((PINB&_BV(SD_WP))!=0x00) return RES_ERROR;
                 ; 0002 0130 
                 ; 0002 0131 	res = RES_ERROR;
000743 940e 1877 	CALL __PUTPARD2
000745 940e 18d0 	CALL __SAVELOCR4
                 ;	*buff -> Y+8
                 ;	sa -> Y+4
                 ;	res -> R17
                 ;	bc -> R18,R19
000747 e011      	LDI  R17,LOW(1)
                 ; 0002 0132 
                 ; 0002 0133 	if (buff) {		// Send data bytes
000748 85e8      	LDD  R30,Y+8
000749 85f9      	LDD  R31,Y+8+1
00074a 9730      	SBIW R30,0
00074b f0f9      	BREQ _0x40054
                 ; 0002 0134 		bc = (WORD)sa;
                +
00074c 812c     +LDD R18 , Y + 4
00074d 813d     +LDD R19 , Y + 4 + 1
                 	__GETWRS 18,19,4
                 ; 0002 0135 		while (bc && wc) {		// Send data bytes to the card
                 _0x40055:
00074e 2e02      	MOV  R0,R18
00074f 2a03      	OR   R0,R19
000750 f031      	BREQ _0x40058
000751 91e0 0afe 	LDS  R30,_wc_S0020007000
000753 91f0 0aff 	LDS  R31,_wc_S0020007000+1
000755 9730      	SBIW R30,0
000756 f409      	BRNE _0x40059
                 _0x40058:
000757 c011      	RJMP _0x40057
                 _0x40059:
                 ; 0002 0136 			xmit_spi(*buff++);
000758 85a8      	LDD  R26,Y+8
000759 85b9      	LDD  R27,Y+8+1
00075a 91ed      	LD   R30,X+
00075b 87a8      	STD  Y+8,R26
00075c 87b9      	STD  Y+8+1,R27
00075d 2fae      	MOV  R26,R30
00075e de94      	RCALL _xmit_spi
                 ; 0002 0137 			wc--; bc--;
00075f efae      	LDI  R26,LOW(_wc_S0020007000)
000760 e0ba      	LDI  R27,HIGH(_wc_S0020007000)
000761 91ed      	LD   R30,X+
000762 91fd      	LD   R31,X+
000763 9731      	SBIW R30,1
000764 93fe      	ST   -X,R31
000765 93ee      	ST   -X,R30
                +
000766 5021     +SUBI R18 , LOW ( 1 )
000767 4030     +SBCI R19 , HIGH ( 1 )
                 	__SUBWRN 18,19,1
                 ; 0002 0138 		}
000768 cfe5      	RJMP _0x40055
                 _0x40057:
                 ; 0002 0139 		res = RES_OK;
000769 e010      	LDI  R17,LOW(0)
                 ; 0002 013A 	} else {
00076a c047      	RJMP _0x4005A
                 _0x40054:
                 ; 0002 013B 		if (sa) {	// Initiate sector write process
00076b 940e 14a1 	CALL SUBOPT_0x11
00076d 940e 18b6 	CALL __CPD10
00076f f0f9      	BREQ _0x4005B
                 ; 0002 013C 			if (!(CardType & CT_BLOCK)) sa *= 512;	// Convert to byte address if needed
000770 91e0 0afd 	LDS  R30,_CardType_G002
000772 70e8      	ANDI R30,LOW(0x8)
000773 f431      	BRNE _0x4005C
000774 940e 14a1 	CALL SUBOPT_0x11
000776 940e 1528 	CALL SUBOPT_0x26
000778 940e 14e2 	CALL SUBOPT_0x1A
                 ; 0002 013D 			if (send_cmd(CMD24, sa) == 0) {			// WRITE_SINGLE_BLOCK
                 _0x4005C:
00077a e5e8      	LDI  R30,LOW(88)
00077b 93ea      	ST   -Y,R30
                +
00077c 81ad     +LDD R26 , Y + 5
00077d 81be     +LDD R27 , Y + 5 + 1
00077e 818f     +LDD R24 , Y + 5 + 2
00077f 8598     +LDD R25 , Y + 5 + 3
                 	__GETD2S 5
000780 de84      	RCALL _send_cmd_G002
000781 30e0      	CPI  R30,0
000782 f459      	BRNE _0x4005D
                 ; 0002 013E 				xmit_spi(0xFF); xmit_spi(0xFE);		// Data block header
000783 efaf      	LDI  R26,LOW(255)
000784 de6e      	RCALL _xmit_spi
000785 efae      	LDI  R26,LOW(254)
000786 de6c      	RCALL _xmit_spi
                 ; 0002 013F 				wc = 512;							// Set byte counter
000787 e0e0      	LDI  R30,LOW(512)
000788 e0f2      	LDI  R31,HIGH(512)
000789 93e0 0afe 	STS  _wc_S0020007000,R30
00078b 93f0 0aff 	STS  _wc_S0020007000+1,R31
                 ; 0002 0140 				res = RES_OK;
00078d e010      	LDI  R17,LOW(0)
                 ; 0002 0141 			}
                 ; 0002 0142 		} else {	// Finalize sector write process
                 _0x4005D:
00078e c023      	RJMP _0x4005E
                 _0x4005B:
                 ; 0002 0143 			bc = wc + 2;
00078f 91e0 0afe 	LDS  R30,_wc_S0020007000
000791 91f0 0aff 	LDS  R31,_wc_S0020007000+1
000793 9632      	ADIW R30,2
000794 019f      	MOVW R18,R30
                 ; 0002 0144 			while (bc--) xmit_spi(0);	// Fill left bytes and CRC with zeros
                 _0x4005F:
000795 01f9      	MOVW R30,R18
                +
000796 5021     +SUBI R18 , LOW ( 1 )
000797 4030     +SBCI R19 , HIGH ( 1 )
                 	__SUBWRN 18,19,1
000798 9730      	SBIW R30,0
000799 f019      	BREQ _0x40061
00079a e0a0      	LDI  R26,LOW(0)
00079b de57      	RCALL _xmit_spi
00079c cff8      	RJMP _0x4005F
                 _0x40061:
                 ; 0002 0145 if ((rcv_spi() & 0x1F) == 0x05) {
00079d de5c      	RCALL _rcv_spi
00079e 71ef      	ANDI R30,LOW(0x1F)
00079f 30e5      	CPI  R30,LOW(0x5)
0007a0 f481      	BRNE _0x40062
                 ; 0002 0146 				for (bc = 65000; rcv_spi() != 0xFF && bc; bc--) ;	// Wait ready
                +
0007a1 ee28     +LDI R18 , LOW ( - 536 )
0007a2 ef3d     +LDI R19 , HIGH ( - 536 )
                 	__GETWRN 18,19,-536
                 _0x40064:
0007a3 de56      	RCALL _rcv_spi
0007a4 3fef      	CPI  R30,LOW(0xFF)
0007a5 f019      	BREQ _0x40066
0007a6 2e02      	MOV  R0,R18
0007a7 2a03      	OR   R0,R19
0007a8 f409      	BRNE _0x40067
                 _0x40066:
0007a9 c003      	RJMP _0x40065
                 _0x40067:
                +
0007aa 5021     +SUBI R18 , LOW ( 1 )
0007ab 4030     +SBCI R19 , HIGH ( 1 )
                 	__SUBWRN 18,19,1
0007ac cff6      	RJMP _0x40064
                 _0x40065:
                 ; 0002 0147 				if (bc) res = RES_OK;
0007ad 2e02      	MOV  R0,R18
0007ae 2a03      	OR   R0,R19
0007af f009      	BREQ _0x40068
0007b0 e010      	LDI  R17,LOW(0)
                 ; 0002 0148 			}
                 _0x40068:
                 ; 0002 0149 			release_spi();
                 _0x40062:
0007b1 de51      	RCALL _release_spi_G002
                 ; 0002 014A 		}
                 _0x4005E:
                 ; 0002 014B 	}
                 _0x4005A:
                 ; 0002 014C 
                 ; 0002 014D 	return res;
0007b2 2fe1      	MOV  R30,R17
0007b3 940e 18d7 	CALL __LOADLOCR4
0007b5 c367      	RJMP _0x20C000F
                 ; 0002 014E }
                 ; .FEND
                 ;#endif
                 ;/*----------------------------------------------------------------------------/
                 ;/  Petit FatFs - FAT file system module  R0.02                 (C)ChaN, 2009
                 ;/-----------------------------------------------------------------------------/
                 ;/ Petit FatFs module is an open source software to implement FAT file system to
                 ;/ small embedded systems. This is a free software and is opened for education,
                 ;/ research and commercial developments under license policy of following trems.
                 ;/
                 ;/  Copyright (C) 2009, ChaN, all right reserved.
                 ;/
                 ;/ * The Petit FatFs module is a free software and there is NO WARRANTY.
                 ;/ * No restriction on use. You can use, modify and redistribute it for
                 ;/   personal, non-profit or commercial use UNDER YOUR RESPONSIBILITY.
                 ;/ * Redistributions of source code must retain the above copyright notice.
                 ;/
                 ;/-----------------------------------------------------------------------------/
                 ;/ Jun 15,'09  R0.01a  First release. (Branched from FatFs R0.07b.)
                 ;/
                 ;/ Dec 14,'09  R0.02   Added multiple code page support.
                 ;/                     Added write funciton.
                 ;/                     Changed stream read mode interface.
                 ;/----------------------------------------------------------------------------*/
                 ;
                 ;#include "pff_rn.h"		/* Petit FatFs configurations and declarations */
                 ;#include "diskio.h"		/* Declarations of low level disk I/O functions */
                 ;#include <string.h>
                 ;
                 ;/*--------------------------------------------------------------------------
                 ;
                 ;   Private Functions
                 ;
                 ;---------------------------------------------------------------------------*/
                 ;
                 ;static
                 ;FATFS *FatFs;	/* Pointer to the file system object (logical drive) */
                 ;
                 ;
                 ;
                 ;/*-----------------------------------------------------------------------*/
                 ;/* String functions                                                      */
                 ;/*-----------------------------------------------------------------------*/
                 ;
                 ;/* Fill memory */
                 ;static
                 ;void mem_set (void* dst, int val, int cnt) {
                 ; 0003 002C void mem_set (void* dst, int val, int cnt) {
                 
                 	.CSEG
                 _mem_set_G003:
                 ; .FSTART _mem_set_G003
                 ; 0003 002D 	char *d = (char*)dst;
                 ; 0003 002E 	while (cnt--) *d++ = (char)val;
0007b6 940e 149c 	CALL SUBOPT_0x10
                 ;	*dst -> Y+6
                 ;	val -> Y+4
                 ;	cnt -> Y+2
                 ;	*d -> R16,R17
                +
0007b8 810e     +LDD R16 , Y + 6
0007b9 811f     +LDD R17 , Y + 6 + 1
                 	__GETWRS 16,17,6
                 _0x60003:
0007ba 81ea      	LDD  R30,Y+2
0007bb 81fb      	LDD  R31,Y+2+1
0007bc 9731      	SBIW R30,1
0007bd 83ea      	STD  Y+2,R30
0007be 83fb      	STD  Y+2+1,R31
0007bf 9631      	ADIW R30,1
0007c0 f049      	BREQ _0x60005
0007c1 931f      	PUSH R17
0007c2 930f      	PUSH R16
                +
0007c3 5f0f     +SUBI R16 , LOW ( - 1 )
0007c4 4f1f     +SBCI R17 , HIGH ( - 1 )
                 	__ADDWRN 16,17,1
0007c5 81ec      	LDD  R30,Y+4
0007c6 91af      	POP  R26
0007c7 91bf      	POP  R27
0007c8 93ec      	ST   X,R30
0007c9 cff0      	RJMP _0x60003
                 _0x60005:
                 ; 0003 002F }
0007ca 8119      	LDD  R17,Y+1
0007cb 8108      	LDD  R16,Y+0
0007cc c3c0      	RJMP _0x20C000E
                 ; .FEND
                 ;
                 ;/* Compare memory to memory */
                 ;static
                 ;int mem_cmp (const void* dst, const void* src, int cnt) {
                 ; 0003 0033 int mem_cmp (const void* dst, const void* src, int cnt) {
                 _mem_cmp_G003:
                 ; .FSTART _mem_cmp_G003
                 ; 0003 0034 	const char *d = (const char *)dst, *s = (const char *)src;
                 ; 0003 0035 	int r = 0;
                 ; 0003 0036 	while (cnt-- && (r = *d++ - *s++) == 0) ;
0007cd 940e 1531 	CALL SUBOPT_0x28
                 ;	*dst -> Y+10
                 ;	*src -> Y+8
                 ;	cnt -> Y+6
                 ;	*d -> R16,R17
                 ;	*s -> R18,R19
                 ;	r -> R20,R21
                +
0007cf 850a     +LDD R16 , Y + 10
0007d0 851b     +LDD R17 , Y + 10 + 1
                 	__GETWRS 16,17,10
                +
0007d1 8528     +LDD R18 , Y + 8
0007d2 8539     +LDD R19 , Y + 8 + 1
                 	__GETWRS 18,19,8
                +
0007d3 e040     +LDI R20 , LOW ( 0 )
0007d4 e050     +LDI R21 , HIGH ( 0 )
                 	__GETWRN 20,21,0
                 _0x60006:
0007d5 81ee      	LDD  R30,Y+6
0007d6 81ff      	LDD  R31,Y+6+1
0007d7 9731      	SBIW R30,1
0007d8 83ee      	STD  Y+6,R30
0007d9 83ff      	STD  Y+6+1,R31
0007da 9631      	ADIW R30,1
0007db f081      	BREQ _0x60009
0007dc 01d8      	MOVW R26,R16
                +
0007dd 5f0f     +SUBI R16 , LOW ( - 1 )
0007de 4f1f     +SBCI R17 , HIGH ( - 1 )
                 	__ADDWRN 16,17,1
0007df 900c      	LD   R0,X
0007e0 2411      	CLR  R1
0007e1 01d9      	MOVW R26,R18
                +
0007e2 5f2f     +SUBI R18 , LOW ( - 1 )
0007e3 4f3f     +SBCI R19 , HIGH ( - 1 )
                 	__ADDWRN 18,19,1
0007e4 91ac      	LD   R26,X
0007e5 27bb      	CLR  R27
0007e6 01f0      	MOVW R30,R0
0007e7 1bea      	SUB  R30,R26
0007e8 0bfb      	SBC  R31,R27
0007e9 01af      	MOVW R20,R30
0007ea 9730      	SBIW R30,0
0007eb f009      	BREQ _0x6000A
                 _0x60009:
0007ec c001      	RJMP _0x60008
                 _0x6000A:
0007ed cfe7      	RJMP _0x60006
                 _0x60008:
                 ; 0003 0037 	return r;
0007ee 01fa      	MOVW R30,R20
0007ef 940e 18d5 	CALL __LOADLOCR6
0007f1 962c      	ADIW R28,12
0007f2 9508      	RET
                 ; 0003 0038 }
                 ; .FEND
                 ;
                 ;
                 ;
                 ;/*-----------------------------------------------------------------------*/
                 ;/* FAT access - Read value of a FAT entry                                */
                 ;/*-----------------------------------------------------------------------*/
                 ;
                 ;static
                 ;CLUST get_fat (	/* 1:IO error, Else:Cluster status */
                 ; 0003 0042 	CLUST clst	/* Cluster# to get the link information */
                 ; 0003 0043 )
                 ; 0003 0044 {
                 _get_fat_G003:
                 ; .FSTART _get_fat_G003
                 ; 0003 0045 	WORD wc, bc, ofs;
                 ; 0003 0046 	BYTE buf[4];
                 ; 0003 0047 	FATFS *fs = FatFs;
                 ; 0003 0048 
                 ; 0003 0049 
                 ; 0003 004A 	if (clst < 2 || clst >= fs->max_clust)	/* Range check */
0007f3 940e 1877 	CALL __PUTPARD2
0007f5 9726      	SBIW R28,6
0007f6 940e 18ce 	CALL __SAVELOCR6
                 ;	clst -> Y+12
                 ;	wc -> R16,R17
                 ;	bc -> R18,R19
                 ;	ofs -> R20,R21
                 ;	buf -> Y+8
                 ;	*fs -> Y+6
0007f8 940e 1536 	CALL SUBOPT_0x29
0007fa 83ee      	STD  Y+6,R30
0007fb 83ff      	STD  Y+6+1,R31
0007fc 940e 153b 	CALL SUBOPT_0x2A
0007fe 940e 1540 	CALL SUBOPT_0x2B
000800 f050      	BRLO _0x6000C
000801 81ae      	LDD  R26,Y+6
000802 81bf      	LDD  R27,Y+6+1
000803 9618      	ADIW R26,8
000804 940e 1841 	CALL __GETD1P
000806 940e 153b 	CALL SUBOPT_0x2A
000808 940e 18c9 	CALL __CPD21
00080a f008      	BRLO _0x6000B
                 _0x6000C:
                 ; 0003 004B 		return 1;
00080b c0a6      	RJMP _0x20C0013
                 ; 0003 004C 
                 ; 0003 004D 	switch (fs->fs_type) {
                 _0x6000B:
00080c 81ae      	LDD  R26,Y+6
00080d 81bf      	LDD  R27,Y+6+1
00080e 91ec      	LD   R30,X
00080f e0f0      	LDI  R31,0
                 ; 0003 004E 	case FS_FAT12 :
000810 30e1      	CPI  R30,LOW(0x1)
000811 e0a0      	LDI  R26,HIGH(0x1)
000812 07fa      	CPC  R31,R26
000813 f009      	BREQ PC+2
000814 c04d      	RJMP _0x60011
                 ; 0003 004F 		bc = (WORD)clst; bc += bc / 2;
                +
000815 852c     +LDD R18 , Y + 12
000816 853d     +LDD R19 , Y + 12 + 1
                 	__GETWRS 18,19,12
000817 01f9      	MOVW R30,R18
000818 95f6      	LSR  R31
000819 95e7      	ROR  R30
                +
00081a 0f2e     +ADD R18 , R30
00081b 1f3f     +ADC R19 , R31
                 	__ADDWRR 18,19,30,31
                 ; 0003 0050 		ofs = bc % 512; bc /= 512;
00081c 01f9      	MOVW R30,R18
00081d 70f1      	ANDI R31,HIGH(0x1FF)
00081e 01af      	MOVW R20,R30
00081f 01d9      	MOVW R26,R18
000820 e0e0      	LDI  R30,LOW(512)
000821 e0f2      	LDI  R31,HIGH(512)
000822 940e 1801 	CALL __DIVW21U
000824 019f      	MOVW R18,R30
                 ; 0003 0051 		if (ofs != 511) {
000825 efef      	LDI  R30,LOW(511)
000826 e0f1      	LDI  R31,HIGH(511)
000827 17e4      	CP   R30,R20
000828 07f5      	CPC  R31,R21
000829 f059      	BREQ _0x60012
                 ; 0003 0052 			if (disk_readp(buf, fs->fatbase + bc, ofs, 2)) break;
00082a 940e 1548 	CALL SUBOPT_0x2C
00082c 940e 1872 	CALL __PUTPARD1
00082e 935a      	ST   -Y,R21
00082f 934a      	ST   -Y,R20
000830 940e 1554 	CALL SUBOPT_0x2D
000832 f009      	BREQ _0x60013
000833 c07e      	RJMP _0x60010
                 ; 0003 0053 		} else {
                 _0x60013:
000834 c01f      	RJMP _0x60014
                 _0x60012:
                 ; 0003 0054 			if (disk_readp(buf, fs->fatbase + bc, 511, 1)) break;
000835 940e 1548 	CALL SUBOPT_0x2C
000837 940e 1872 	CALL __PUTPARD1
000839 efef      	LDI  R30,LOW(511)
00083a e0f1      	LDI  R31,HIGH(511)
00083b 93fa      	ST   -Y,R31
00083c 93ea      	ST   -Y,R30
00083d e0a1      	LDI  R26,LOW(1)
00083e 940e 155a 	CALL SUBOPT_0x2E
000840 f009      	BREQ _0x60015
000841 c070      	RJMP _0x60010
                 ; 0003 0055 			if (disk_readp(buf+1, fs->fatbase + bc + 1, 0, 1)) break;
                 _0x60015:
000842 01fe      	MOVW R30,R28
000843 9639      	ADIW R30,9
000844 940e 155f 	CALL SUBOPT_0x2F
000846 01f9      	MOVW R30,R18
000847 940e 14e7 	CALL SUBOPT_0x1B
000849 940e 1568 	CALL SUBOPT_0x30
00084b 940e 1872 	CALL __PUTPARD1
00084d 940e 144f 	CALL SUBOPT_0x5
00084f e0a1      	LDI  R26,LOW(1)
000850 940e 155a 	CALL SUBOPT_0x2E
000852 f009      	BREQ _0x60016
000853 c05e      	RJMP _0x60010
                 ; 0003 0056 		}
                 _0x60016:
                 _0x60014:
                 ; 0003 0057 		wc = LD_WORD(buf);
                +
000854 8508     +LDD R16 , Y + 8
000855 8519     +LDD R17 , Y + 8 + 1
                 	__GETWRS 16,17,8
                 ; 0003 0058 		return (clst & 1) ? (wc >> 4) : (wc & 0xFFF);
000856 85ec      	LDD  R30,Y+12
000857 70e1      	ANDI R30,LOW(0x1)
000858 f021      	BREQ _0x60017
000859 01f8      	MOVW R30,R16
00085a 940e 17bf 	CALL __LSRW4
00085c c002      	RJMP _0x60114
                 _0x60017:
00085d 01f8      	MOVW R30,R16
00085e 70ff      	ANDI R31,HIGH(0xFFF)
                 _0x60114:
00085f 2766      	CLR  R22
000860 2777      	CLR  R23
000861 c054      	RJMP _0x20C0012
                 ; 0003 0059 
                 ; 0003 005A 	case FS_FAT16 :
                 _0x60011:
000862 30e2      	CPI  R30,LOW(0x2)
000863 e0a0      	LDI  R26,HIGH(0x2)
000864 07fa      	CPC  R31,R26
000865 f509      	BRNE _0x6001A
                 ; 0003 005B 		if (disk_readp(buf, fs->fatbase + clst / 256, (WORD)(((WORD)clst % 256) * 2), 2)) break;
000866 01fe      	MOVW R30,R28
000867 9638      	ADIW R30,8
000868 940e 155f 	CALL SUBOPT_0x2F
00086a 939f      	PUSH R25
00086b 938f      	PUSH R24
00086c 93bf      	PUSH R27
00086d 93af      	PUSH R26
00086e 940e 156d 	CALL SUBOPT_0x31
                +
000870 e0e0     +LDI R30 , LOW ( 0x100 )
000871 e0f1     +LDI R31 , HIGH ( 0x100 )
000872 e060     +LDI R22 , BYTE3 ( 0x100 )
000873 e070     +LDI R23 , BYTE4 ( 0x100 )
                 	__GETD1N 0x100
000874 940e 1814 	CALL __DIVD21U
000876 91af      	POP  R26
000877 91bf      	POP  R27
000878 918f      	POP  R24
000879 919f      	POP  R25
00087a 940e 1572 	CALL SUBOPT_0x32
00087c 70f0      	ANDI R31,HIGH(0xFF)
00087d 0fee      	LSL  R30
00087e 1fff      	ROL  R31
00087f 940e 1579 	CALL SUBOPT_0x33
000881 f581      	BRNE _0x60010
                 ; 0003 005C 		return LD_WORD(buf);
000882 85e8      	LDD  R30,Y+8
000883 85f9      	LDD  R31,Y+8+1
000884 2766      	CLR  R22
000885 2777      	CLR  R23
000886 c02f      	RJMP _0x20C0012
                 ; 0003 005D #if _FS_FAT32
                 ; 0003 005E 	case FS_FAT32 :
                 _0x6001A:
000887 30e3      	CPI  R30,LOW(0x3)
000888 e0a0      	LDI  R26,HIGH(0x3)
000889 07fa      	CPC  R31,R26
00088a f539      	BRNE _0x60010
                 ; 0003 005F 		if (disk_readp(buf, fs->fatbase + clst / 128, (WORD)(((WORD)clst % 128) * 4), 4)) break;
00088b 01fe      	MOVW R30,R28
00088c 9638      	ADIW R30,8
00088d 940e 155f 	CALL SUBOPT_0x2F
00088f 939f      	PUSH R25
000890 938f      	PUSH R24
000891 93bf      	PUSH R27
000892 93af      	PUSH R26
000893 940e 156d 	CALL SUBOPT_0x31
                +
000895 e8e0     +LDI R30 , LOW ( 0x80 )
000896 e0f0     +LDI R31 , HIGH ( 0x80 )
000897 e060     +LDI R22 , BYTE3 ( 0x80 )
000898 e070     +LDI R23 , BYTE4 ( 0x80 )
                 	__GETD1N 0x80
000899 940e 1814 	CALL __DIVD21U
00089b 91af      	POP  R26
00089c 91bf      	POP  R27
00089d 918f      	POP  R24
00089e 919f      	POP  R25
00089f 940e 1572 	CALL SUBOPT_0x32
0008a1 77ef      	ANDI R30,LOW(0x7F)
0008a2 70f0      	ANDI R31,HIGH(0x7F)
0008a3 940e 17ba 	CALL __LSLW2
0008a5 93fa      	ST   -Y,R31
0008a6 93ea      	ST   -Y,R30
0008a7 e0a4      	LDI  R26,LOW(4)
0008a8 940e 155a 	CALL SUBOPT_0x2E
0008aa f439      	BRNE _0x60010
                 ; 0003 0060 		return LD_DWORD(buf) & 0x0FFFFFFF;
0008ab 940e 14dd 	CALL SUBOPT_0x19
                +
0008ad 7fef     +ANDI R30 , LOW ( 0xFFFFFFF )
0008ae 7fff     +ANDI R31 , HIGH ( 0xFFFFFFF )
0008af 7f6f     +ANDI R22 , BYTE3 ( 0xFFFFFFF )
0008b0 707f     +ANDI R23 , BYTE4 ( 0xFFFFFFF )
                 	__ANDD1N 0xFFFFFFF
0008b1 c004      	RJMP _0x20C0012
                 ; 0003 0061 #endif
                 ; 0003 0062 	}
                 _0x60010:
                 ; 0003 0063 
                 ; 0003 0064 	return 1;	/* An error occured at the disk I/O layer */
                 _0x20C0013:
                +
0008b2 e0e1     +LDI R30 , LOW ( 0x1 )
0008b3 e0f0     +LDI R31 , HIGH ( 0x1 )
0008b4 e060     +LDI R22 , BYTE3 ( 0x1 )
0008b5 e070     +LDI R23 , BYTE4 ( 0x1 )
                 	__GETD1N 0x1
                 _0x20C0012:
0008b6 940e 18d5 	CALL __LOADLOCR6
0008b8 9660      	ADIW R28,16
0008b9 9508      	RET
                 ; 0003 0065 }
                 ; .FEND
                 ;
                 ;
                 ;
                 ;
                 ;/*-----------------------------------------------------------------------*/
                 ;/* Get sector# from cluster#                                             */
                 ;/*-----------------------------------------------------------------------*/
                 ;
                 ;static
                 ;DWORD clust2sect (	/* !=0: Sector number, 0: Failed - invalid cluster# */
                 ; 0003 0070 	CLUST clst		/* Cluster# to be converted */
                 ; 0003 0071 )
                 ; 0003 0072 {
                 _clust2sect_G003:
                 ; .FSTART _clust2sect_G003
                 ; 0003 0073 	FATFS *fs = FatFs;
                 ; 0003 0074 
                 ; 0003 0075 
                 ; 0003 0076 	clst -= 2;
0008ba 940e 1877 	CALL __PUTPARD2
0008bc 940e 157c 	CALL SUBOPT_0x34
                 ;	clst -> Y+2
                 ;	*fs -> R16,R17
0008be 940e 150d 	CALL SUBOPT_0x21
                +
0008c0 50e2     +SUBI R30 , LOW ( 2 )
0008c1 40f0     +SBCI R31 , HIGH ( 2 )
0008c2 4060     +SBCI R22 , BYTE3 ( 2 )
0008c3 4070     +SBCI R23 , BYTE4 ( 2 )
                 	__SUBD1N 2
0008c4 940e 1583 	CALL SUBOPT_0x35
                 ; 0003 0077 	if (clst >= (fs->max_clust - 2)) return 0;		/* Invalid cluster# */
0008c6 01f8      	MOVW R30,R16
                +
0008c7 85a0     +LDD R26 , Z + 8
0008c8 85b1     +LDD R27 , Z + 8 + 1
0008c9 8582     +LDD R24 , Z + 8 + 2
0008ca 8593     +LDD R25 , Z + 8 + 3
                 	__GETD2Z 8
                +
0008cb e0e2     +LDI R30 , LOW ( 0x2 )
0008cc e0f0     +LDI R31 , HIGH ( 0x2 )
0008cd e060     +LDI R22 , BYTE3 ( 0x2 )
0008ce e070     +LDI R23 , BYTE4 ( 0x2 )
                 	__GETD1N 0x2
0008cf 940e 187c 	CALL __SWAPD12
0008d1 940e 1792 	CALL __SUBD12
0008d3 940e 1588 	CALL SUBOPT_0x36
0008d5 940e 18c9 	CALL __CPD21
0008d7 f028      	BRLO _0x6001E
0008d8 940e 158d 	CALL SUBOPT_0x37
0008da 8119      	LDD  R17,Y+1
0008db 8108      	LDD  R16,Y+0
0008dc c2e6      	RJMP _0x20C000D
                 ; 0003 0078 	return (DWORD)clst * fs->csize + fs->database;
                 _0x6001E:
0008dd 01f8      	MOVW R30,R16
0008de 81e1      	LDD  R30,Z+1
0008df e0f0      	LDI  R31,0
0008e0 940e 1588 	CALL SUBOPT_0x36
0008e2 940e 17d7 	CALL __CWD1
0008e4 940e 17e1 	CALL __MULD12U
0008e6 937f      	PUSH R23
0008e7 936f      	PUSH R22
0008e8 93ff      	PUSH R31
0008e9 93ef      	PUSH R30
0008ea 01d8      	MOVW R26,R16
0008eb 9654      	ADIW R26,20
0008ec 940e 1841 	CALL __GETD1P
0008ee 91af      	POP  R26
0008ef 91bf      	POP  R27
0008f0 918f      	POP  R24
0008f1 919f      	POP  R25
0008f2 940e 1788 	CALL __ADDD12
0008f4 8119      	LDD  R17,Y+1
0008f5 8108      	LDD  R16,Y+0
0008f6 c2cc      	RJMP _0x20C000D
                 ; 0003 0079 }
                 ; .FEND
                 ;
                 ;
                 ;
                 ;
                 ;/*-----------------------------------------------------------------------*/
                 ;/* Directory handling - Rewind directory index                           */
                 ;/*-----------------------------------------------------------------------*/
                 ;
                 ;static
                 ;FRESULT dir_rewind (
                 ; 0003 0084 	DIR *dj			/* Pointer to directory object */
                 ; 0003 0085 )
                 ; 0003 0086 {
                 _dir_rewind_G003:
                 ; .FSTART _dir_rewind_G003
                 ; 0003 0087 	CLUST clst;
                 ; 0003 0088 	FATFS *fs = FatFs;
                 ; 0003 0089 
                 ; 0003 008A 
                 ; 0003 008B 	dj->index = 0;
0008f7 93ba      	ST   -Y,R27
0008f8 93aa      	ST   -Y,R26
0008f9 9724      	SBIW R28,4
0008fa 940e 157c 	CALL SUBOPT_0x34
                 ;	*dj -> Y+6
                 ;	clst -> Y+2
                 ;	*fs -> R16,R17
0008fc 81ae      	LDD  R26,Y+6
0008fd 81bf      	LDD  R27,Y+6+1
0008fe 940e 1592 	CALL SUBOPT_0x38
                 ; 0003 008C 	clst = dj->sclust;
000900 81ae      	LDD  R26,Y+6
000901 81bf      	LDD  R27,Y+6+1
000902 9614      	ADIW R26,4
000903 940e 1597 	CALL SUBOPT_0x39
                 ; 0003 008D 	if (clst == 1 || clst >= fs->max_clust)	/* Check start cluster range */
000905 940e 1588 	CALL SUBOPT_0x36
                +
000907 30a1     +CPI R26 , LOW ( 0x1 )
000908 e0e0     +LDI R30 , HIGH ( 0x1 )
000909 07be     +CPC R27 , R30
00090a e0e0     +LDI R30 , BYTE3 ( 0x1 )
00090b 078e     +CPC R24 , R30
00090c e0e0     +LDI R30 , BYTE4 ( 0x1 )
00090d 079e     +CPC R25 , R30
                 	__CPD2N 0x1
00090e f049      	BREQ _0x60020
00090f 01d8      	MOVW R26,R16
000910 9618      	ADIW R26,8
000911 940e 1841 	CALL __GETD1P
000913 940e 1588 	CALL SUBOPT_0x36
000915 940e 18c9 	CALL __CPD21
000917 f020      	BRLO _0x6001F
                 _0x60020:
                 ; 0003 008E 		return FR_DISK_ERR;
000918 e0e1      	LDI  R30,LOW(1)
000919 8119      	LDD  R17,Y+1
00091a 8108      	LDD  R16,Y+0
00091b c271      	RJMP _0x20C000E
                 ; 0003 008F #if _FS_FAT32
                 ; 0003 0090 	if (!clst && fs->fs_type == FS_FAT32)	/* Replace cluster# 0 with root cluster# if in FAT32 */
                 _0x6001F:
00091c 940e 150d 	CALL SUBOPT_0x21
00091e 940e 18b6 	CALL __CPD10
000920 f421      	BRNE _0x60023
000921 01d8      	MOVW R26,R16
000922 91ac      	LD   R26,X
000923 30a3      	CPI  R26,LOW(0x3)
000924 f009      	BREQ _0x60024
                 _0x60023:
000925 c004      	RJMP _0x60022
                 _0x60024:
                 ; 0003 0091 		clst = fs->dirbase;
000926 01d8      	MOVW R26,R16
000927 9650      	ADIW R26,16
000928 940e 1597 	CALL SUBOPT_0x39
                 ; 0003 0092 #endif
                 ; 0003 0093 	dj->clust = clst;						/* Current cluster */
                 _0x60022:
00092a 940e 150d 	CALL SUBOPT_0x21
                +
00092c 81ae     +LDD R26 , Y + 6
00092d 81bf     +LDD R27 , Y + 6 + 1
00092e 9618     +ADIW R26 , 8
00092f 940e 184c+CALL __PUTDP1
                 	__PUTD1SNS 6,8
                 ; 0003 0094 	dj->sect = clst ? clust2sect(clst) : fs->dirbase;	/* Current sector */
000931 940e 150d 	CALL SUBOPT_0x21
000933 940e 18b6 	CALL __CPD10
000935 f021      	BREQ _0x60025
000936 940e 1588 	CALL SUBOPT_0x36
000938 df81      	RCALL _clust2sect_G003
000939 c004      	RJMP _0x60026
                 _0x60025:
00093a 01d8      	MOVW R26,R16
00093b 9650      	ADIW R26,16
00093c 940e 1841 	CALL __GETD1P
                 _0x60026:
                +
00093e 81ae     +LDD R26 , Y + 6
00093f 81bf     +LDD R27 , Y + 6 + 1
000940 961c     +ADIW R26 , 12
000941 940e 184c+CALL __PUTDP1
                 	__PUTD1SNS 6,12
                 ; 0003 0095 
                 ; 0003 0096 	return FR_OK;	/* Seek succeeded */
000943 e0e0      	LDI  R30,LOW(0)
000944 8119      	LDD  R17,Y+1
000945 8108      	LDD  R16,Y+0
000946 c246      	RJMP _0x20C000E
                 ; 0003 0097 }
                 ; .FEND
                 ;
                 ;
                 ;
                 ;
                 ;/*-----------------------------------------------------------------------*/
                 ;/* Directory handling - Move directory index next                        */
                 ;/*-----------------------------------------------------------------------*/
                 ;
                 ;static
                 ;FRESULT dir_next (	/* FR_OK:Succeeded, FR_NO_FILE:End of table */
                 ; 0003 00A2 	DIR *dj			/* Pointer to directory object */
                 ; 0003 00A3 )
                 ; 0003 00A4 {
                 _dir_next_G003:
                 ; .FSTART _dir_next_G003
                 ; 0003 00A5 	CLUST clst;
                 ; 0003 00A6 	WORD i;
                 ; 0003 00A7 	FATFS *fs = FatFs;
                 ; 0003 00A8 
                 ; 0003 00A9 
                 ; 0003 00AA 	i = dj->index + 1;
000947 93ba      	ST   -Y,R27
000948 93aa      	ST   -Y,R26
000949 9724      	SBIW R28,4
00094a 940e 159a 	CALL SUBOPT_0x3A
                 ;	*dj -> Y+8
                 ;	clst -> Y+4
                 ;	i -> R16,R17
                 ;	*fs -> R18,R19
00094c 85a8      	LDD  R26,Y+8
00094d 85b9      	LDD  R27,Y+8+1
00094e 940e 183d 	CALL __GETW1P
000950 9631      	ADIW R30,1
000951 018f      	MOVW R16,R30
                 ; 0003 00AB 	if (!i || !dj->sect)	/* Report EOT when index has reached 65535 */
000952 2e00      	MOV  R0,R16
000953 2a01      	OR   R0,R17
000954 f019      	BREQ _0x60029
000955 940e 15a1 	CALL SUBOPT_0x3B
000957 f421      	BRNE _0x60028
                 _0x60029:
                 ; 0003 00AC 		return FR_NO_FILE;
000958 e0e3      	LDI  R30,LOW(3)
000959 940e 18d7 	CALL __LOADLOCR4
00095b c1c1      	RJMP _0x20C000F
                 ; 0003 00AD 
                 ; 0003 00AE 	if (!(i & (16-1))) {	/* Sector changed? */
                 _0x60028:
00095c 01f8      	MOVW R30,R16
00095d 70ef      	ANDI R30,LOW(0xF)
00095e f009      	BREQ PC+2
00095f c059      	RJMP _0x6002B
                 ; 0003 00AF 		dj->sect++;			/* Next sector */
000960 85a8      	LDD  R26,Y+8
000961 85b9      	LDD  R27,Y+8+1
000962 961c      	ADIW R26,12
000963 940e 1847 	CALL __GETD1P_INC
                +
000965 5fef     +SUBI R30 , LOW ( - 1 )
000966 4fff     +SBCI R31 , HIGH ( - 1 )
000967 4f6f     +SBCI R22 , BYTE3 ( - 1 )
000968 4f7f     +SBCI R23 , BYTE4 ( - 1 )
                 	__SUBD1N -1
000969 940e 1851 	CALL __PUTDP1_DEC
                 ; 0003 00B0 
                 ; 0003 00B1 		if (dj->clust == 0) {	/* Static table */
00096b 85a8      	LDD  R26,Y+8
00096c 85b9      	LDD  R27,Y+8+1
00096d 9618      	ADIW R26,8
00096e 940e 1841 	CALL __GETD1P
000970 940e 18b6 	CALL __CPD10
000972 f461      	BRNE _0x6002C
                 ; 0003 00B2 			if (i >= fs->n_rootdir)	/* Report EOT when end of table */
000973 01d9      	MOVW R26,R18
000974 9614      	ADIW R26,4
000975 940e 183d 	CALL __GETW1P
000977 170e      	CP   R16,R30
000978 071f      	CPC  R17,R31
000979 f020      	BRLO _0x6002D
                 ; 0003 00B3 				return FR_NO_FILE;
00097a e0e3      	LDI  R30,LOW(3)
00097b 940e 18d7 	CALL __LOADLOCR4
00097d c19f      	RJMP _0x20C000F
                 ; 0003 00B4 		}
                 _0x6002D:
                 ; 0003 00B5 		else {					/* Dynamic table */
00097e c03a      	RJMP _0x6002E
                 _0x6002C:
                 ; 0003 00B6 			if (((i / 16) & (fs->csize-1)) == 0) {	/* Cluster changed? */
00097f 01f8      	MOVW R30,R16
000980 940e 17bf 	CALL __LSRW4
000982 01df      	MOVW R26,R30
000983 01f9      	MOVW R30,R18
000984 81e1      	LDD  R30,Z+1
000985 e0f0      	LDI  R31,0
000986 9731      	SBIW R30,1
000987 23ea      	AND  R30,R26
000988 23fb      	AND  R31,R27
000989 9730      	SBIW R30,0
00098a f571      	BRNE _0x6002F
                 ; 0003 00B7 				clst = get_fat(dj->clust);		/* Get next cluster */
00098b 85e8      	LDD  R30,Y+8
00098c 85f9      	LDD  R31,Y+8+1
                +
00098d 85a0     +LDD R26 , Z + 8
00098e 85b1     +LDD R27 , Z + 8 + 1
00098f 8582     +LDD R24 , Z + 8 + 2
000990 8593     +LDD R25 , Z + 8 + 3
                 	__GETD2Z 8
000991 de61      	RCALL _get_fat_G003
000992 940e 14e2 	CALL SUBOPT_0x1A
                 ; 0003 00B8 				if (clst <= 1) return FR_DISK_ERR;
000994 940e 15a9 	CALL SUBOPT_0x3C
000996 940e 1540 	CALL SUBOPT_0x2B
000998 f420      	BRSH _0x60030
000999 e0e1      	LDI  R30,LOW(1)
00099a 940e 18d7 	CALL __LOADLOCR4
00099c c180      	RJMP _0x20C000F
                 ; 0003 00B9 				if (clst >= fs->max_clust)		/* When it reached end of dynamic table */
                 _0x60030:
00099d 01d9      	MOVW R26,R18
00099e 9618      	ADIW R26,8
00099f 940e 1841 	CALL __GETD1P
0009a1 940e 15a9 	CALL SUBOPT_0x3C
0009a3 940e 18c9 	CALL __CPD21
0009a5 f020      	BRLO _0x60031
                 ; 0003 00BA 					return FR_NO_FILE;			/* Report EOT */
0009a6 e0e3      	LDI  R30,LOW(3)
0009a7 940e 18d7 	CALL __LOADLOCR4
0009a9 c173      	RJMP _0x20C000F
                 ; 0003 00BB 				dj->clust = clst;				/* Initialize data for new cluster */
                 _0x60031:
0009aa 940e 14a1 	CALL SUBOPT_0x11
                +
0009ac 85a8     +LDD R26 , Y + 8
0009ad 85b9     +LDD R27 , Y + 8 + 1
0009ae 9618     +ADIW R26 , 8
0009af 940e 184c+CALL __PUTDP1
                 	__PUTD1SNS 8,8
                 ; 0003 00BC 				dj->sect = clust2sect(clst);
0009b1 940e 15a9 	CALL SUBOPT_0x3C
0009b3 df06      	RCALL _clust2sect_G003
                +
0009b4 85a8     +LDD R26 , Y + 8
0009b5 85b9     +LDD R27 , Y + 8 + 1
0009b6 961c     +ADIW R26 , 12
0009b7 940e 184c+CALL __PUTDP1
                 	__PUTD1SNS 8,12
                 ; 0003 00BD 			}
                 ; 0003 00BE 		}
                 _0x6002F:
                 _0x6002E:
                 ; 0003 00BF 	}
                 ; 0003 00C0 
                 ; 0003 00C1 	dj->index = i;
                 _0x6002B:
0009b9 85a8      	LDD  R26,Y+8
0009ba 85b9      	LDD  R27,Y+8+1
0009bb 930d      	ST   X+,R16
0009bc 931c      	ST   X,R17
                 ; 0003 00C2 
                 ; 0003 00C3 	return FR_OK;
0009bd e0e0      	LDI  R30,LOW(0)
0009be 940e 18d7 	CALL __LOADLOCR4
0009c0 c15c      	RJMP _0x20C000F
                 ; 0003 00C4 }
                 ; .FEND
                 ;
                 ;
                 ;
                 ;
                 ;/*-----------------------------------------------------------------------*/
                 ;/* Directory handling - Find an object in the directory                  */
                 ;/*-----------------------------------------------------------------------*/
                 ;
                 ;static
                 ;FRESULT dir_find (
                 ; 0003 00CF 	DIR *dj			/* Pointer to the directory object linked to the file name */
                 ; 0003 00D0 )
                 ; 0003 00D1 {
                 _dir_find_G003:
                 ; .FSTART _dir_find_G003
                 ; 0003 00D2 	FRESULT res;
                 ; 0003 00D3 	BYTE c, *dir;
                 ; 0003 00D4 
                 ; 0003 00D5 
                 ; 0003 00D6 	res = dir_rewind(dj);			/* Rewind directory object */
0009c1 940e 1523 	CALL SUBOPT_0x25
                 ;	*dj -> Y+4
                 ;	res -> R17
                 ;	c -> R16
                 ;	*dir -> R18,R19
0009c3 81ac      	LDD  R26,Y+4
0009c4 81bd      	LDD  R27,Y+4+1
0009c5 df31      	RCALL _dir_rewind_G003
0009c6 2f1e      	MOV  R17,R30
                 ; 0003 00D7 	if (res != FR_OK) return res;
0009c7 3010      	CPI  R17,0
0009c8 f019      	BREQ _0x60032
0009c9 940e 18d7 	CALL __LOADLOCR4
0009cb c1f7      	RJMP _0x20C000D
                 ; 0003 00D8 
                 ; 0003 00D9 	dir = FatFs->buf;
                 _0x60032:
0009cc 940e 15ae 	CALL SUBOPT_0x3D
0009ce 912d      	LD   R18,X+
0009cf 913c      	LD   R19,X
                 ; 0003 00DA 	do {
                 _0x60034:
                 ; 0003 00DB 		res = disk_readp(dir, dj->sect, (WORD)((dj->index % 16) * 32), 32)	/* Read an entry */
                 ; 0003 00DC 			? FR_DISK_ERR : FR_OK;
0009d0 933a      	ST   -Y,R19
0009d1 932a      	ST   -Y,R18
0009d2 81ee      	LDD  R30,Y+6
0009d3 81ff      	LDD  R31,Y+6+1
0009d4 940e 15b4 	CALL SUBOPT_0x3E
0009d6 85aa      	LDD  R26,Y+10
0009d7 85bb      	LDD  R27,Y+10+1
0009d8 940e 15bb 	CALL SUBOPT_0x3F
0009da f011      	BREQ _0x60036
0009db e0e1      	LDI  R30,LOW(1)
0009dc c001      	RJMP _0x60037
                 _0x60036:
0009dd e0e0      	LDI  R30,LOW(0)
                 _0x60037:
0009de 2f1e      	MOV  R17,R30
                 ; 0003 00DD 		if (res != FR_OK) break;
0009df 3010      	CPI  R17,0
0009e0 f4f9      	BRNE _0x60035
                 ; 0003 00DE 		c = dir[DIR_Name];	/* First character */
0009e1 01d9      	MOVW R26,R18
0009e2 910c      	LD   R16,X
                 ; 0003 00DF 		if (c == 0) { res = FR_NO_FILE; break; }	/* Reached to end of table */
0009e3 3000      	CPI  R16,0
0009e4 f411      	BRNE _0x6003A
0009e5 e013      	LDI  R17,LOW(3)
0009e6 c019      	RJMP _0x60035
                 ; 0003 00E0 		if (!(dir[DIR_Attr] & AM_VOL) && !mem_cmp(dir, dj->fn, 11)) /* Is it a valid entry? */
                 _0x6003A:
0009e7 01f9      	MOVW R30,R18
0009e8 85e3      	LDD  R30,Z+11
0009e9 70e8      	ANDI R30,LOW(0x8)
0009ea f469      	BRNE _0x6003C
0009eb 933a      	ST   -Y,R19
0009ec 932a      	ST   -Y,R18
0009ed 81ee      	LDD  R30,Y+6
0009ee 81ff      	LDD  R31,Y+6+1
0009ef 81a2      	LDD  R26,Z+2
0009f0 81b3      	LDD  R27,Z+3
0009f1 93ba      	ST   -Y,R27
0009f2 93aa      	ST   -Y,R26
0009f3 e0ab      	LDI  R26,LOW(11)
0009f4 e0b0      	LDI  R27,0
0009f5 ddd7      	RCALL _mem_cmp_G003
0009f6 9730      	SBIW R30,0
0009f7 f009      	BREQ _0x6003D
                 _0x6003C:
0009f8 c001      	RJMP _0x6003B
                 _0x6003D:
                 ; 0003 00E1 			break;
0009f9 c006      	RJMP _0x60035
                 ; 0003 00E2 		res = dir_next(dj);							/* Next entry */
                 _0x6003B:
0009fa 81ac      	LDD  R26,Y+4
0009fb 81bd      	LDD  R27,Y+4+1
0009fc df4a      	RCALL _dir_next_G003
0009fd 2f1e      	MOV  R17,R30
                 ; 0003 00E3 	} while (res == FR_OK);
0009fe 3010      	CPI  R17,0
0009ff f281      	BREQ _0x60034
                 _0x60035:
                 ; 0003 00E4 
                 ; 0003 00E5 	return res;
000a00 2fe1      	MOV  R30,R17
000a01 940e 18d7 	CALL __LOADLOCR4
000a03 c1bf      	RJMP _0x20C000D
                 ; 0003 00E6 }
                 ; .FEND
                 ;
                 ;
                 ;
                 ;
                 ;/*-----------------------------------------------------------------------*/
                 ;/* Read an object from the directory                                     */
                 ;/*-----------------------------------------------------------------------*/
                 ;#if _USE_DIR
                 ;static
                 ;FRESULT dir_read (
                 ; 0003 00F1 	DIR *dj			/* Pointer to the directory object to store read object name */
                 ; 0003 00F2 )
                 ; 0003 00F3 {
                 _dir_read_G003:
                 ; .FSTART _dir_read_G003
                 ; 0003 00F4 	FRESULT res;
                 ; 0003 00F5 	BYTE a, c, *dir;
                 ; 0003 00F6 
                 ; 0003 00F7 
                 ; 0003 00F8 	res = FR_NO_FILE;
000a04 940e 1531 	CALL SUBOPT_0x28
                 ;	*dj -> Y+6
                 ;	res -> R17
                 ;	a -> R16
                 ;	c -> R19
                 ;	*dir -> R20,R21
000a06 e013      	LDI  R17,LOW(3)
                 ; 0003 00F9 	dir = FatFs->buf;
000a07 940e 15ae 	CALL SUBOPT_0x3D
000a09 914d      	LD   R20,X+
000a0a 915c      	LD   R21,X
                 ; 0003 00FA 	while (dj->sect) {
                 _0x6003E:
000a0b 81ae      	LDD  R26,Y+6
000a0c 81bf      	LDD  R27,Y+6+1
000a0d 961c      	ADIW R26,12
000a0e 940e 1841 	CALL __GETD1P
000a10 940e 18b6 	CALL __CPD10
000a12 f149      	BREQ _0x60040
                 ; 0003 00FB 		res = disk_readp(dir, dj->sect, (WORD)((dj->index % 16) * 32), 32)	/* Read an entry */
                 ; 0003 00FC 			? FR_DISK_ERR : FR_OK;
000a13 935a      	ST   -Y,R21
000a14 934a      	ST   -Y,R20
000a15 85e8      	LDD  R30,Y+8
000a16 85f9      	LDD  R31,Y+8+1
000a17 940e 15b4 	CALL SUBOPT_0x3E
000a19 85ac      	LDD  R26,Y+12
000a1a 85bd      	LDD  R27,Y+12+1
000a1b 940e 15bb 	CALL SUBOPT_0x3F
000a1d f011      	BREQ _0x60041
000a1e e0e1      	LDI  R30,LOW(1)
000a1f c001      	RJMP _0x60042
                 _0x60041:
000a20 e0e0      	LDI  R30,LOW(0)
                 _0x60042:
000a21 2f1e      	MOV  R17,R30
                 ; 0003 00FD 		if (res != FR_OK) break;
000a22 3010      	CPI  R17,0
000a23 f4c1      	BRNE _0x60040
                 ; 0003 00FE 		c = dir[DIR_Name];
000a24 01da      	MOVW R26,R20
000a25 913c      	LD   R19,X
                 ; 0003 00FF 		if (c == 0) { res = FR_NO_FILE; break; }	/* Reached to end of table */
000a26 3030      	CPI  R19,0
000a27 f411      	BRNE _0x60045
000a28 e013      	LDI  R17,LOW(3)
000a29 c012      	RJMP _0x60040
                 ; 0003 0100 		a = dir[DIR_Attr] & AM_MASK;
                 _0x60045:
000a2a 01fa      	MOVW R30,R20
000a2b 85e3      	LDD  R30,Z+11
000a2c 73ef      	ANDI R30,LOW(0x3F)
000a2d 2f0e      	MOV  R16,R30
                 ; 0003 0101 		if (c != 0xE5 && c != '.' && !(a & AM_VOL))	/* Is it a valid entry? */
000a2e 3e35      	CPI  R19,229
000a2f f021      	BREQ _0x60047
000a30 323e      	CPI  R19,46
000a31 f011      	BREQ _0x60047
000a32 ff03      	SBRS R16,3
000a33 c001      	RJMP _0x60048
                 _0x60047:
000a34 c001      	RJMP _0x60046
                 _0x60048:
                 ; 0003 0102 			break;
000a35 c006      	RJMP _0x60040
                 ; 0003 0103 		res = dir_next(dj);				/* Next entry */
                 _0x60046:
000a36 81ae      	LDD  R26,Y+6
000a37 81bf      	LDD  R27,Y+6+1
000a38 df0e      	RCALL _dir_next_G003
000a39 2f1e      	MOV  R17,R30
                 ; 0003 0104 		if (res != FR_OK) break;
000a3a 3010      	CPI  R17,0
000a3b f279      	BREQ _0x6003E
                 ; 0003 0105 	}
                 _0x60040:
                 ; 0003 0106 
                 ; 0003 0107 	if (res != FR_OK) dj->sect = 0;
000a3c 3010      	CPI  R17,0
000a3d f021      	BREQ _0x6004A
000a3e 81ae      	LDD  R26,Y+6
000a3f 81bf      	LDD  R27,Y+6+1
000a40 940e 15c6 	CALL SUBOPT_0x40
                 ; 0003 0108 
                 ; 0003 0109 	return res;
                 _0x6004A:
000a42 2fe1      	MOV  R30,R17
000a43 940e 18d5 	CALL __LOADLOCR6
000a45 c147      	RJMP _0x20C000E
                 ; 0003 010A }
                 ; .FEND
                 ;
                 ;#endif
                 ;
                 ;
                 ;
                 ;/*-----------------------------------------------------------------------*/
                 ;/* Pick a segment and create the object name in directory form           */
                 ;/*-----------------------------------------------------------------------*/
                 ;
                 ;#ifdef _EXCVT
                 ;	static const BYTE cvt[] = _EXCVT;
                 ;#endif
                 ;
                 ;static
                 ;FRESULT create_name (
                 ; 0003 011A 	DIR *dj,			/* Pointer to the directory object */
                 ; 0003 011B 	const char **path	/* Pointer to pointer to the segment in the path string */
                 ; 0003 011C )
                 ; 0003 011D {
                 _create_name_G003:
                 ; .FSTART _create_name_G003
                 ; 0003 011E 	BYTE c, d, ni, si, i, *sfn;
                 ; 0003 011F 	const char *p;
                 ; 0003 0120 
                 ; 0003 0121 	/* Create file name in directory form */
                 ; 0003 0122 	sfn = dj->fn;
000a46 93ba      	ST   -Y,R27
000a47 93aa      	ST   -Y,R26
000a48 9724      	SBIW R28,4
000a49 940e 18ce 	CALL __SAVELOCR6
                 ;	*dj -> Y+12
                 ;	*path -> Y+10
                 ;	c -> R17
                 ;	d -> R16
                 ;	ni -> R19
                 ;	si -> R18
                 ;	i -> R21
                 ;	*sfn -> Y+8
                 ;	*p -> Y+6
000a4b 85ac      	LDD  R26,Y+12
000a4c 85bd      	LDD  R27,Y+12+1
000a4d 9612      	ADIW R26,2
000a4e 940e 183d 	CALL __GETW1P
000a50 87e8      	STD  Y+8,R30
000a51 87f9      	STD  Y+8+1,R31
                 ; 0003 0123 	mem_set(sfn, ' ', 11);
000a52 93fa      	ST   -Y,R31
000a53 93ea      	ST   -Y,R30
000a54 e2e0      	LDI  R30,LOW(32)
000a55 e0f0      	LDI  R31,HIGH(32)
000a56 93fa      	ST   -Y,R31
000a57 93ea      	ST   -Y,R30
000a58 e0ab      	LDI  R26,LOW(11)
000a59 e0b0      	LDI  R27,0
000a5a dd5b      	RCALL _mem_set_G003
                 ; 0003 0124 	si = i = 0; ni = 8;
000a5b e0e0      	LDI  R30,LOW(0)
000a5c 2f5e      	MOV  R21,R30
000a5d 2f2e      	MOV  R18,R30
000a5e e038      	LDI  R19,LOW(8)
                 ; 0003 0125 	p = *path;
000a5f 85aa      	LDD  R26,Y+10
000a60 85bb      	LDD  R27,Y+10+1
000a61 940e 183d 	CALL __GETW1P
000a63 83ee      	STD  Y+6,R30
000a64 83ff      	STD  Y+6+1,R31
                 ; 0003 0126 	for (;;) {
                 _0x6004C:
                 ; 0003 0127 		c = p[si++];
000a65 940e 15cb 	CALL SUBOPT_0x41
000a67 911c      	LD   R17,X
                 ; 0003 0128 		if (c <= ' ' || c == '/') break;	/* Break on end of segment */
000a68 3211      	CPI  R17,33
000a69 f010      	BRLO _0x6004F
000a6a 321f      	CPI  R17,47
000a6b f409      	BRNE _0x6004E
                 _0x6004F:
000a6c c039      	RJMP _0x6004D
                 ; 0003 0129 		if (c == '.' || i >= ni) {
                 _0x6004E:
000a6d 321e      	CPI  R17,46
000a6e f011      	BREQ _0x60052
000a6f 1753      	CP   R21,R19
000a70 f040      	BRLO _0x60051
                 _0x60052:
                 ; 0003 012A 			if (ni != 8 || c != '.') break;
000a71 3038      	CPI  R19,8
000a72 f411      	BRNE _0x60055
000a73 321e      	CPI  R17,46
000a74 f009      	BREQ _0x60054
                 _0x60055:
000a75 c030      	RJMP _0x6004D
                 ; 0003 012B 			i = 8; ni = 11;
                 _0x60054:
000a76 e058      	LDI  R21,LOW(8)
000a77 e03b      	LDI  R19,LOW(11)
                 ; 0003 012C 			continue;
000a78 c02c      	RJMP _0x6004B
                 ; 0003 012D 		}
                 ; 0003 012E #ifdef _EXCVT
                 ; 0003 012F 		if (c >= 0x80)					/* To upper extended char (SBCS) */
                 _0x60051:
000a79 3810      	CPI  R17,128
000a7a f058      	BRLO _0x60057
                 ; 0003 0130 			c = cvt[c - 0x80];
000a7b 2fe1      	MOV  R30,R17
000a7c e0f0      	LDI  R31,0
000a7d 58e0      	SUBI R30,LOW(128)
000a7e 40f0      	SBCI R31,HIGH(128)
000a7f 2766      	CLR  R22
000a80 2777      	CLR  R23
000a81 53e0      	SUBI R30,LOW(-_cvt_G003*2)
000a82 4fff      	SBCI R31,HIGH(-_cvt_G003*2)
000a83 4f6f      	SBCI R22,BYTE3(-_cvt_G003*2)
                +
000a84 bf6b     +OUT RAMPZ , R22
000a85 9116     +ELPM R17 , Z
                 	__GETBRPF 17
                 ; 0003 0131 #endif
                 ; 0003 0132 		if (IsDBCS1(c) && i >= ni - 1) {	/* DBC 1st byte? */
                 _0x60057:
000a86 e0e0      	LDI  R30,LOW(0)
000a87 30e0      	CPI  R30,0
000a88 f041      	BREQ _0x60059
000a89 2fe3      	MOV  R30,R19
000a8a e0f0      	LDI  R31,0
000a8b 9731      	SBIW R30,1
000a8c 2fa5      	MOV  R26,R21
000a8d e0b0      	LDI  R27,0
000a8e 17ae      	CP   R26,R30
000a8f 07bf      	CPC  R27,R31
000a90 f40c      	BRGE _0x6005A
                 _0x60059:
000a91 c00a      	RJMP _0x60058
                 _0x6005A:
                 ; 0003 0133 			d = p[si++];					/* Get 2nd byte */
000a92 940e 15cb 	CALL SUBOPT_0x41
000a94 910c      	LD   R16,X
                 ; 0003 0134 			sfn[i++] = c;
000a95 940e 15d3 	CALL SUBOPT_0x42
000a97 8310      	ST   Z,R17
                 ; 0003 0135 			sfn[i++] = d;
000a98 940e 15d3 	CALL SUBOPT_0x42
000a9a 8300      	ST   Z,R16
                 ; 0003 0136 		} else {						/* Single byte code */
000a9b c009      	RJMP _0x6005B
                 _0x60058:
                 ; 0003 0137 			if (IsLower(c)) c -= 0x20;	/* toupper */
000a9c 3611      	CPI  R17,97
000a9d f010      	BRLO _0x6005D
000a9e 371b      	CPI  R17,123
000a9f f008      	BRLO _0x6005E
                 _0x6005D:
000aa0 c001      	RJMP _0x6005C
                 _0x6005E:
000aa1 5210      	SUBI R17,LOW(32)
                 ; 0003 0138 			sfn[i++] = c;
                 _0x6005C:
000aa2 940e 15d3 	CALL SUBOPT_0x42
000aa4 8310      	ST   Z,R17
                 ; 0003 0139 		}
                 _0x6005B:
                 ; 0003 013A 	}
                 _0x6004B:
000aa5 cfbf      	RJMP _0x6004C
                 _0x6004D:
                 ; 0003 013B 	*path = &p[si];						/* Rerurn pointer to the next segment */
000aa6 2fe2      	MOV  R30,R18
000aa7 81ae      	LDD  R26,Y+6
000aa8 81bf      	LDD  R27,Y+6+1
000aa9 e0f0      	LDI  R31,0
000aaa 0fea      	ADD  R30,R26
000aab 1ffb      	ADC  R31,R27
000aac 85aa      	LDD  R26,Y+10
000aad 85bb      	LDD  R27,Y+10+1
000aae 93ed      	ST   X+,R30
000aaf 93fc      	ST   X,R31
                 ; 0003 013C 
                 ; 0003 013D 	sfn[11] = (c <= ' ') ? 1 : 0;		/* Set last segment flag if end of path */
000ab0 3211      	CPI  R17,33
000ab1 f410      	BRSH _0x6005F
000ab2 e0e1      	LDI  R30,LOW(1)
000ab3 c001      	RJMP _0x60060
                 _0x6005F:
000ab4 e0e0      	LDI  R30,LOW(0)
                 _0x60060:
                +
000ab5 85a8     +LDD R26 , Y + 8
000ab6 85b9     +LDD R27 , Y + 8 + 1
000ab7 961b     +ADIW R26 , 11
000ab8 93ec     +ST X , R30
                 	__PUTB1SNS 8,11
                 ; 0003 013E 
                 ; 0003 013F 	return FR_OK;
000ab9 e0e0      	LDI  R30,LOW(0)
000aba 940e 18d5 	CALL __LOADLOCR6
                 _0x20C0011:
000abc 962e      	ADIW R28,14
000abd 9508      	RET
                 ; 0003 0140 }
                 ; .FEND
                 ;
                 ;
                 ;
                 ;
                 ;/*-----------------------------------------------------------------------*/
                 ;/* Get file information from directory entry                             */
                 ;/*-----------------------------------------------------------------------*/
                 ;#if _USE_DIR
                 ;static
                 ;void get_fileinfo (		/* No return code */
                 ; 0003 014B 	DIR *dj,			/* Pointer to the directory object */
                 ; 0003 014C 	FILINFO *fno	 	/* Pointer to store the file information */
                 ; 0003 014D )
                 ; 0003 014E {
                 _get_fileinfo_G003:
                 ; .FSTART _get_fileinfo_G003
                 ; 0003 014F 	BYTE i, c, *dir;
                 ; 0003 0150 	char *p;
                 ; 0003 0151 
                 ; 0003 0152 
                 ; 0003 0153 	p = fno->fname;
000abe 940e 1531 	CALL SUBOPT_0x28
                 ;	*dj -> Y+8
                 ;	*fno -> Y+6
                 ;	i -> R17
                 ;	c -> R16
                 ;	*dir -> R18,R19
                 ;	*p -> R20,R21
000ac0 81ee      	LDD  R30,Y+6
000ac1 81ff      	LDD  R31,Y+6+1
000ac2 9639      	ADIW R30,9
000ac3 01af      	MOVW R20,R30
                 ; 0003 0154 	if (dj->sect) {
000ac4 940e 15a1 	CALL SUBOPT_0x3B
000ac6 f409      	BRNE PC+2
000ac7 c050      	RJMP _0x60062
                 ; 0003 0155 		dir = FatFs->buf;
000ac8 940e 15ae 	CALL SUBOPT_0x3D
000aca 912d      	LD   R18,X+
000acb 913c      	LD   R19,X
                 ; 0003 0156 		for (i = 0; i < 8; i++) {	/* Copy file name body */
000acc e010      	LDI  R17,LOW(0)
                 _0x60064:
000acd 3018      	CPI  R17,8
000ace f480      	BRSH _0x60065
                 ; 0003 0157 			c = dir[i];
000acf 940e 15db 	CALL SUBOPT_0x43
                 ; 0003 0158 			if (c == ' ') break;
000ad1 f069      	BREQ _0x60065
                 ; 0003 0159 			if (c == 0x05) c = 0xE5;
000ad2 3005      	CPI  R16,5
000ad3 f409      	BRNE _0x60067
000ad4 ee05      	LDI  R16,LOW(229)
                 ; 0003 015A 			*p++ = c;
                 _0x60067:
000ad5 935f      	PUSH R21
000ad6 934f      	PUSH R20
                +
000ad7 5f4f     +SUBI R20 , LOW ( - 1 )
000ad8 4f5f     +SBCI R21 , HIGH ( - 1 )
                 	__ADDWRN 20,21,1
000ad9 2fe0      	MOV  R30,R16
000ada 91af      	POP  R26
000adb 91bf      	POP  R27
000adc 93ec      	ST   X,R30
                 ; 0003 015B 		}
000add 5f1f      	SUBI R17,-1
000ade cfee      	RJMP _0x60064
                 _0x60065:
                 ; 0003 015C 		if (dir[8] != ' ') {		/* Copy file name extension */
000adf 01f9      	MOVW R30,R18
000ae0 85a0      	LDD  R26,Z+8
000ae1 32a0      	CPI  R26,LOW(0x20)
000ae2 f0a9      	BREQ _0x60068
                 ; 0003 015D 			*p++ = '.';
000ae3 01da      	MOVW R26,R20
                +
000ae4 5f4f     +SUBI R20 , LOW ( - 1 )
000ae5 4f5f     +SBCI R21 , HIGH ( - 1 )
                 	__ADDWRN 20,21,1
000ae6 e2ee      	LDI  R30,LOW(46)
000ae7 93ec      	ST   X,R30
                 ; 0003 015E 			for (i = 8; i < 11; i++) {
000ae8 e018      	LDI  R17,LOW(8)
                 _0x6006A:
000ae9 301b      	CPI  R17,11
000aea f468      	BRSH _0x6006B
                 ; 0003 015F 				c = dir[i];
000aeb 940e 15db 	CALL SUBOPT_0x43
                 ; 0003 0160 				if (c == ' ') break;
000aed f051      	BREQ _0x6006B
                 ; 0003 0161 				*p++ = c;
000aee 935f      	PUSH R21
000aef 934f      	PUSH R20
                +
000af0 5f4f     +SUBI R20 , LOW ( - 1 )
000af1 4f5f     +SBCI R21 , HIGH ( - 1 )
                 	__ADDWRN 20,21,1
000af2 2fe0      	MOV  R30,R16
000af3 91af      	POP  R26
000af4 91bf      	POP  R27
000af5 93ec      	ST   X,R30
                 ; 0003 0162 			}
000af6 5f1f      	SUBI R17,-1
000af7 cff1      	RJMP _0x6006A
                 _0x6006B:
                 ; 0003 0163 		}
                 ; 0003 0164 		fno->fattrib = dir[DIR_Attr];				/* Attribute */
                 _0x60068:
000af8 01f9      	MOVW R30,R18
000af9 85e3      	LDD  R30,Z+11
                +
000afa 81ae     +LDD R26 , Y + 6
000afb 81bf     +LDD R27 , Y + 6 + 1
000afc 9618     +ADIW R26 , 8
000afd 93ec     +ST X , R30
                 	__PUTB1SNS 6,8
                 ; 0003 0165 		fno->fsize = LD_DWORD(dir+DIR_FileSize);	/* Size */
000afe 01d9      	MOVW R26,R18
000aff 965c      	ADIW R26,28
000b00 940e 1841 	CALL __GETD1P
000b02 81ae      	LDD  R26,Y+6
000b03 81bf      	LDD  R27,Y+6+1
000b04 940e 184c 	CALL __PUTDP1
                 ; 0003 0166 		fno->fdate = LD_WORD(dir+DIR_WrtDate);		/* Date */
000b06 01d9      	MOVW R26,R18
000b07 9658      	ADIW R26,24
000b08 940e 183d 	CALL __GETW1P
                +
000b0a 81ae     +LDD R26 , Y + 6
000b0b 81bf     +LDD R27 , Y + 6 + 1
000b0c 9614     +ADIW R26 , 4
000b0d 93ed     +ST X + , R30
000b0e 93fc     +ST X , R31
                 	__PUTW1SNS 6,4
                 ; 0003 0167 		fno->ftime = LD_WORD(dir+DIR_WrtTime);		/* Time */
000b0f 01d9      	MOVW R26,R18
000b10 9656      	ADIW R26,22
000b11 940e 183d 	CALL __GETW1P
                +
000b13 81ae     +LDD R26 , Y + 6
000b14 81bf     +LDD R27 , Y + 6 + 1
000b15 9616     +ADIW R26 , 6
000b16 93ed     +ST X + , R30
000b17 93fc     +ST X , R31
                 	__PUTW1SNS 6,6
                 ; 0003 0168 	}
                 ; 0003 0169 	*p = 0;
                 _0x60062:
000b18 01da      	MOVW R26,R20
000b19 e0e0      	LDI  R30,LOW(0)
000b1a 93ec      	ST   X,R30
                 ; 0003 016A }
                 _0x20C0010:
000b1b 940e 18d5 	CALL __LOADLOCR6
                 _0x20C000F:
000b1d 962a      	ADIW R28,10
000b1e 9508      	RET
                 ; .FEND
                 ;
                 ;
                 ;#endif /* _USE_DIR */
                 ;
                 ;
                 ;
                 ;/*-----------------------------------------------------------------------*/
                 ;/* Follow a file path                                                    */
                 ;/*-----------------------------------------------------------------------*/
                 ;
                 ;static
                 ;FRESULT follow_path (	/* FR_OK(0): successful, !=0: error code */
                 ; 0003 0177 	DIR *dj,			/* Directory object to return last directory and found object */
                 ; 0003 0178 	const char *path	/* Full-path string to find a file or directory */
                 ; 0003 0179 )
                 ; 0003 017A {
                 _follow_path_G003:
                 ; .FSTART _follow_path_G003
                 ; 0003 017B 	FRESULT res;
                 ; 0003 017C 	BYTE *dir;
                 ; 0003 017D 
                 ; 0003 017E 
                 ; 0003 017F 	while (*path == ' ') path++;		/* Skip leading spaces */
000b1f 940e 1523 	CALL SUBOPT_0x25
                 ;	*dj -> Y+6
                 ;	*path -> Y+4
                 ;	res -> R17
                 ;	*dir -> R18,R19
                 _0x6006D:
000b21 81ac      	LDD  R26,Y+4
000b22 81bd      	LDD  R27,Y+4+1
000b23 91ac      	LD   R26,X
000b24 32a0      	CPI  R26,LOW(0x20)
000b25 f431      	BRNE _0x6006F
000b26 81ec      	LDD  R30,Y+4
000b27 81fd      	LDD  R31,Y+4+1
000b28 9631      	ADIW R30,1
000b29 83ec      	STD  Y+4,R30
000b2a 83fd      	STD  Y+4+1,R31
000b2b cff5      	RJMP _0x6006D
                 _0x6006F:
                 ; 0003 0180 if (*path == '/') path++;
000b2c 81ac      	LDD  R26,Y+4
000b2d 81bd      	LDD  R27,Y+4+1
000b2e 91ac      	LD   R26,X
000b2f 32af      	CPI  R26,LOW(0x2F)
000b30 f429      	BRNE _0x60070
000b31 81ec      	LDD  R30,Y+4
000b32 81fd      	LDD  R31,Y+4+1
000b33 9631      	ADIW R30,1
000b34 83ec      	STD  Y+4,R30
000b35 83fd      	STD  Y+4+1,R31
                 ; 0003 0181 	dj->sclust = 0;						/* Set start directory (always root dir) */
                 _0x60070:
000b36 81ae      	LDD  R26,Y+6
000b37 81bf      	LDD  R27,Y+6+1
000b38 9614      	ADIW R26,4
000b39 940e 15e2 	CALL SUBOPT_0x44
                 ; 0003 0182 
                 ; 0003 0183 	if ((BYTE)*path <= ' ') {			/* Null path means the root directory */
000b3b 81ac      	LDD  R26,Y+4
000b3c 81bd      	LDD  R27,Y+4+1
000b3d 91ac      	LD   R26,X
000b3e 32a1      	CPI  R26,LOW(0x21)
000b3f f458      	BRSH _0x60071
                 ; 0003 0184 		res = dir_rewind(dj);
000b40 81ae      	LDD  R26,Y+6
000b41 81bf      	LDD  R27,Y+6+1
000b42 ddb4      	RCALL _dir_rewind_G003
000b43 2f1e      	MOV  R17,R30
                 ; 0003 0185 		FatFs->buf[0] = 0;
000b44 940e 1536 	CALL SUBOPT_0x29
000b46 81a6      	LDD  R26,Z+6
000b47 81b7      	LDD  R27,Z+7
000b48 e0e0      	LDI  R30,LOW(0)
000b49 93ec      	ST   X,R30
                 ; 0003 0186 
                 ; 0003 0187 	} else {							/* Follow path */
000b4a c03f      	RJMP _0x60072
                 _0x60071:
                 ; 0003 0188 		for (;;) {
                 _0x60074:
                 ; 0003 0189 			res = create_name(dj, &path);	/* Get a segment */
000b4b 81ee      	LDD  R30,Y+6
000b4c 81ff      	LDD  R31,Y+6+1
000b4d 93fa      	ST   -Y,R31
000b4e 93ea      	ST   -Y,R30
000b4f 01de      	MOVW R26,R28
000b50 9616      	ADIW R26,6
000b51 def4      	RCALL _create_name_G003
000b52 2f1e      	MOV  R17,R30
                 ; 0003 018A 			if (res != FR_OK) break;
000b53 3010      	CPI  R17,0
000b54 f5a9      	BRNE _0x60075
                 ; 0003 018B 			res = dir_find(dj);				/* Find it */
000b55 81ae      	LDD  R26,Y+6
000b56 81bf      	LDD  R27,Y+6+1
000b57 de69      	RCALL _dir_find_G003
000b58 2f1e      	MOV  R17,R30
                 ; 0003 018C 			if (res != FR_OK) {				/* Could not find the object */
000b59 3010      	CPI  R17,0
000b5a f041      	BREQ _0x60077
                 ; 0003 018D 				if (res == FR_NO_FILE && !*(dj->fn+11))
000b5b 3013      	CPI  R17,3
000b5c f419      	BRNE _0x60079
000b5d 940e 15e6 	CALL SUBOPT_0x45
000b5f f009      	BREQ _0x6007A
                 _0x60079:
000b60 c001      	RJMP _0x60078
                 _0x6007A:
                 ; 0003 018E 					res = FR_NO_PATH;
000b61 e014      	LDI  R17,LOW(4)
                 ; 0003 018F 				break;
                 _0x60078:
000b62 c027      	RJMP _0x60075
                 ; 0003 0190 			}
                 ; 0003 0191 			if (*(dj->fn+11)) break;		/* Last segment match. Function completed. */
                 _0x60077:
000b63 940e 15e6 	CALL SUBOPT_0x45
000b65 f521      	BRNE _0x60075
                 ; 0003 0192 			dir = FatFs->buf;				/* There is next segment. Follow the sub directory */
000b66 940e 15ae 	CALL SUBOPT_0x3D
000b68 912d      	LD   R18,X+
000b69 913c      	LD   R19,X
                 ; 0003 0193 			if (!(dir[DIR_Attr] & AM_DIR)) { /* Cannot follow because it is a file */
000b6a 01f9      	MOVW R30,R18
000b6b 85e3      	LDD  R30,Z+11
000b6c 71e0      	ANDI R30,LOW(0x10)
000b6d f411      	BRNE _0x6007C
                 ; 0003 0194 				res = FR_NO_PATH; break;
000b6e e014      	LDI  R17,LOW(4)
000b6f c01a      	RJMP _0x60075
                 ; 0003 0195 			}
                 ; 0003 0196 			dj->sclust =
                 _0x6007C:
                 ; 0003 0197 #if _FS_FAT32
                 ; 0003 0198 				((DWORD)LD_WORD(dir+DIR_FstClusHI) << 16) |
                 ; 0003 0199 #endif
                 ; 0003 019A 				LD_WORD(dir+DIR_FstClusLO);
000b70 01d9      	MOVW R26,R18
000b71 9654      	ADIW R26,20
000b72 940e 15ee 	CALL SUBOPT_0x46
000b74 940e 17d2 	CALL __LSLD16
000b76 937f      	PUSH R23
000b77 936f      	PUSH R22
000b78 93ff      	PUSH R31
000b79 93ef      	PUSH R30
000b7a 01d9      	MOVW R26,R18
000b7b 965a      	ADIW R26,26
000b7c 940e 183d 	CALL __GETW1P
000b7e 91af      	POP  R26
000b7f 91bf      	POP  R27
000b80 918f      	POP  R24
000b81 919f      	POP  R25
000b82 940e 15f3 	CALL SUBOPT_0x47
                +
000b84 81ae     +LDD R26 , Y + 6
000b85 81bf     +LDD R27 , Y + 6 + 1
000b86 9614     +ADIW R26 , 4
000b87 940e 184c+CALL __PUTDP1
                 	__PUTD1SNS 6,4
                 ; 0003 019B 		}
000b89 cfc1      	RJMP _0x60074
                 _0x60075:
                 ; 0003 019C 	}
                 _0x60072:
                 ; 0003 019D 
                 ; 0003 019E 	return res;
000b8a 2fe1      	MOV  R30,R17
000b8b 940e 18d7 	CALL __LOADLOCR4
                 _0x20C000E:
000b8d 9628      	ADIW R28,8
000b8e 9508      	RET
                 ; 0003 019F }
                 ; .FEND
                 ;
                 ;
                 ;
                 ;
                 ;/*-----------------------------------------------------------------------*/
                 ;/* Check a sector if it is an FAT boot record                            */
                 ;/*-----------------------------------------------------------------------*/
                 ;
                 ;static
                 ;BYTE check_fs (	/* 0:The FAT boot record, 1:Valid boot record but not an FAT, 2:Not a boot record, 3:Error */
                 ; 0003 01AA 	BYTE *buf,	/* Working buffer */
                 ; 0003 01AB 	DWORD sect	/* Sector# (lba) to check if it is an FAT boot record or not */
                 ; 0003 01AC )
                 ; 0003 01AD {
                 _check_fs_G003:
                 ; .FSTART _check_fs_G003
                 ; 0003 01AE     if (disk_readp(buf, sect, 510, 2))		/* Read the boot sector */
000b8f 940e 1877 	CALL __PUTPARD2
                 ;	*buf -> Y+4
                 ;	sect -> Y+0
000b91 940e 15f8 	CALL SUBOPT_0x48
000b93 efee      	LDI  R30,LOW(510)
000b94 e0f1      	LDI  R31,HIGH(510)
000b95 940e 1579 	CALL SUBOPT_0x33
000b97 f011      	BREQ _0x6007D
                 ; 0003 01AF 		return 3;
000b98 e0e3      	LDI  R30,LOW(3)
000b99 c029      	RJMP _0x20C000D
                 ; 0003 01B0 	if (LD_WORD(buf) != 0xAA55)				/* Check record signature */
                 _0x6007D:
000b9a 940e 1600 	CALL SUBOPT_0x49
000b9c 35e5      	CPI  R30,LOW(0xAA55)
000b9d eaaa      	LDI  R26,HIGH(0xAA55)
000b9e 07fa      	CPC  R31,R26
000b9f f011      	BREQ _0x6007E
                 ; 0003 01B1 		return 2;
000ba0 e0e2      	LDI  R30,LOW(2)
000ba1 c021      	RJMP _0x20C000D
                 ; 0003 01B2 
                 ; 0003 01B3 	if (!disk_readp(buf, sect, BS_FilSysType, 2) && LD_WORD(buf) == 0x4146)	/* Check FAT12/16 */
                 _0x6007E:
000ba2 940e 15f8 	CALL SUBOPT_0x48
000ba4 e3e6      	LDI  R30,LOW(54)
000ba5 e0f0      	LDI  R31,HIGH(54)
000ba6 940e 1579 	CALL SUBOPT_0x33
000ba8 f431      	BRNE _0x60080
000ba9 940e 1600 	CALL SUBOPT_0x49
000bab 34e6      	CPI  R30,LOW(0x4146)
000bac e4a1      	LDI  R26,HIGH(0x4146)
000bad 07fa      	CPC  R31,R26
000bae f009      	BREQ _0x60081
                 _0x60080:
000baf c002      	RJMP _0x6007F
                 _0x60081:
                 ; 0003 01B4 		return 0;
000bb0 e0e0      	LDI  R30,LOW(0)
000bb1 c011      	RJMP _0x20C000D
                 ; 0003 01B5 #if _FS_FAT32
                 ; 0003 01B6 	if (!disk_readp(buf, sect, BS_FilSysType32, 2) && LD_WORD(buf) == 0x4146)	/* Check FAT32 */
                 _0x6007F:
000bb2 940e 15f8 	CALL SUBOPT_0x48
000bb4 e5e2      	LDI  R30,LOW(82)
000bb5 e0f0      	LDI  R31,HIGH(82)
000bb6 940e 1579 	CALL SUBOPT_0x33
000bb8 f431      	BRNE _0x60083
000bb9 940e 1600 	CALL SUBOPT_0x49
000bbb 34e6      	CPI  R30,LOW(0x4146)
000bbc e4a1      	LDI  R26,HIGH(0x4146)
000bbd 07fa      	CPC  R31,R26
000bbe f009      	BREQ _0x60084
                 _0x60083:
000bbf c002      	RJMP _0x60082
                 _0x60084:
                 ; 0003 01B7 		return 0;
000bc0 e0e0      	LDI  R30,LOW(0)
000bc1 c001      	RJMP _0x20C000D
                 ; 0003 01B8 #endif
                 ; 0003 01B9 	return 1;
                 _0x60082:
000bc2 e0e1      	LDI  R30,LOW(1)
                 _0x20C000D:
000bc3 9626      	ADIW R28,6
000bc4 9508      	RET
                 ; 0003 01BA }
                 ; .FEND
                 ;
                 ;
                 ;
                 ;
                 ;/*--------------------------------------------------------------------------
                 ;
                 ;   Public Functions
                 ;
                 ;--------------------------------------------------------------------------*/
                 ;
                 ;
                 ;
                 ;/*-----------------------------------------------------------------------*/
                 ;/* Mount/Unmount a Locical Drive                                         */
                 ;/*-----------------------------------------------------------------------*/
                 ;
                 ;FRESULT pf_mount (
                 ; 0003 01CC 	FATFS *fs		/* Pointer to new file system object (NULL: Unmount) */
                 ; 0003 01CD )
                 ; 0003 01CE {
                 _pf_mount:
                 ; .FSTART _pf_mount
                 ; 0003 01CF 	BYTE fmt, buf[36];
                 ; 0003 01D0 	DWORD bsect, fsize, tsect, mclst;
                 ; 0003 01D1 
                 ; 0003 01D2 
                 ; 0003 01D3 	FatFs = 0;
000bc5 93ba      	ST   -Y,R27
000bc6 93aa      	ST   -Y,R26
000bc7 97e4      	SBIW R28,52
000bc8 931a      	ST   -Y,R17
                 ;	*fs -> Y+53
                 ;	fmt -> R17
                 ;	buf -> Y+17
                 ;	bsect -> Y+13
                 ;	fsize -> Y+9
                 ;	tsect -> Y+5
                 ;	mclst -> Y+1
000bc9 e0e0      	LDI  R30,LOW(0)
000bca 93e0 0b00 	STS  _FatFs_G003,R30
000bcc 93e0 0b01 	STS  _FatFs_G003+1,R30
                 ; 0003 01D4 	if (!fs) return FR_OK;				/* Unregister fs object */
000bce a9ed      	LDD  R30,Y+53
000bcf a9fe      	LDD  R31,Y+53+1
000bd0 9730      	SBIW R30,0
000bd1 f409      	BRNE _0x60085
000bd2 c111      	RJMP _0x20C000C
                 ; 0003 01D5 
                 ; 0003 01D6 
                 ; 0003 01D7 	if (disk_initialize() & STA_NOINIT)	/* Check if the drive is ready or not */
                 _0x60085:
000bd3 da74      	RCALL _disk_initialize
000bd4 70e1      	ANDI R30,LOW(0x1)
000bd5 f011      	BREQ _0x60086
                 ; 0003 01D8 		return FR_NOT_READY;
000bd6 e0e2      	LDI  R30,LOW(2)
000bd7 c10d      	RJMP _0x20C000B
                 ; 0003 01D9 
                 ; 0003 01DA 	/* Search FAT partition on the drive */
                 ; 0003 01DB 	bsect = 0;
                 _0x60086:
000bd8 e0e0      	LDI  R30,LOW(0)
                +
000bd9 87ed     +STD Y + 13 , R30
000bda 87ee     +STD Y + 13 + 1 , R30
000bdb 87ef     +STD Y + 13 + 2 , R30
000bdc 8be8     +STD Y + 13 + 3 , R30
                 	__CLRD1S 13
                 ; 0003 01DC 	fmt = check_fs(buf, bsect);			/* Check sector 0 as an SFD format */
000bdd 940e 1605 	CALL SUBOPT_0x4A
000bdf 940e 160a 	CALL SUBOPT_0x4B
                 ; 0003 01DD 	if (fmt == 1) {						/* Not an FAT boot record, it may be FDISK format */
000be1 3011      	CPI  R17,1
000be2 f4e9      	BRNE _0x60087
                 ; 0003 01DE 		/* Check a partition listed in top of the partition table */
                 ; 0003 01DF 		if (disk_readp(buf, bsect, MBR_Table, 16)) {	/* 1st partition entry */
000be3 940e 1605 	CALL SUBOPT_0x4A
000be5 940e 1612 	CALL SUBOPT_0x4C
000be7 ebee      	LDI  R30,LOW(446)
000be8 e0f1      	LDI  R31,HIGH(446)
000be9 93fa      	ST   -Y,R31
000bea 93ea      	ST   -Y,R30
000beb e1a0      	LDI  R26,LOW(16)
000bec 940e 155a 	CALL SUBOPT_0x2E
000bee f011      	BREQ _0x60088
                 ; 0003 01E0 			fmt = 3;
000bef e013      	LDI  R17,LOW(3)
                 ; 0003 01E1 		} else {
000bf0 c00f      	RJMP _0x60089
                 _0x60088:
                 ; 0003 01E2 			if (buf[4]) {					/* Is the partition existing? */
000bf1 89ed      	LDD  R30,Y+21
000bf2 30e0      	CPI  R30,0
000bf3 f061      	BREQ _0x6008A
                 ; 0003 01E3 				bsect = LD_DWORD(&buf[8]);	/* Partition offset in LBA */
                +
000bf4 8de9     +LDD R30 , Y + 25
000bf5 8dfa     +LDD R31 , Y + 25 + 1
000bf6 8d6b     +LDD R22 , Y + 25 + 2
000bf7 8d7c     +LDD R23 , Y + 25 + 3
                 	__GETD1S 25
                +
000bf8 87ed     +STD Y + 13 , R30
000bf9 87fe     +STD Y + 13 + 1 , R31
000bfa 876f     +STD Y + 13 + 2 , R22
000bfb 8b78     +STD Y + 13 + 3 , R23
                 	__PUTD1S 13
                 ; 0003 01E4 				fmt = check_fs(buf, bsect);	/* Check the partition */
000bfc 940e 1605 	CALL SUBOPT_0x4A
000bfe 940e 160a 	CALL SUBOPT_0x4B
                 ; 0003 01E5 			}
                 ; 0003 01E6 		}
                 _0x6008A:
                 _0x60089:
                 ; 0003 01E7 	}
                 ; 0003 01E8 	if (fmt == 3) return FR_DISK_ERR;
                 _0x60087:
000c00 3013      	CPI  R17,3
000c01 f411      	BRNE _0x6008B
000c02 e0e1      	LDI  R30,LOW(1)
000c03 c0e1      	RJMP _0x20C000B
                 ; 0003 01E9 	if (fmt) return FR_NO_FILESYSTEM;	/* No valid FAT patition is found */
                 _0x6008B:
000c04 3010      	CPI  R17,0
000c05 f011      	BREQ _0x6008C
000c06 e0e7      	LDI  R30,LOW(7)
000c07 c0dd      	RJMP _0x20C000B
                 ; 0003 01EA 
                 ; 0003 01EB 	/* Initialize the file system object */
                 ; 0003 01EC 	if (disk_readp(buf, bsect, 13, sizeof(buf))) return FR_DISK_ERR;
                 _0x6008C:
000c08 940e 1605 	CALL SUBOPT_0x4A
000c0a 940e 1612 	CALL SUBOPT_0x4C
000c0c e0ed      	LDI  R30,LOW(13)
000c0d e0f0      	LDI  R31,HIGH(13)
000c0e 93fa      	ST   -Y,R31
000c0f 93ea      	ST   -Y,R30
000c10 e2a4      	LDI  R26,LOW(36)
000c11 940e 155a 	CALL SUBOPT_0x2E
000c13 f011      	BREQ _0x6008D
000c14 e0e1      	LDI  R30,LOW(1)
000c15 c0cf      	RJMP _0x20C000B
                 ; 0003 01ED 
                 ; 0003 01EE 	fsize = LD_WORD(buf+BPB_FATSz16-13);				/* Number of sectors per FAT */
                 _0x6008D:
000c16 01fe      	MOVW R30,R28
000c17 96b7      	ADIW R30,39
000c18 973d      	SBIW R30,13
000c19 01df      	MOVW R26,R30
000c1a 940e 15ee 	CALL SUBOPT_0x46
000c1c 940e 1619 	CALL SUBOPT_0x4D
                 ; 0003 01EF 	if (!fsize) fsize = LD_DWORD(buf+BPB_FATSz32-13);
000c1e 940e 161e 	CALL SUBOPT_0x4E
000c20 940e 18b6 	CALL __CPD10
000c22 f441      	BRNE _0x6008E
000c23 01fe      	MOVW R30,R28
000c24 96f5      	ADIW R30,53
000c25 973d      	SBIW R30,13
000c26 01df      	MOVW R26,R30
000c27 940e 1841 	CALL __GETD1P
000c29 940e 1619 	CALL SUBOPT_0x4D
                 ; 0003 01F0 
                 ; 0003 01F1 	fsize *= buf[BPB_NumFATs-13];						/* Number of sectors in FAT area */
                 _0x6008E:
000c2b 89ec      	LDD  R30,Y+20
000c2c e0f0      	LDI  R31,0
000c2d 940e 152c 	CALL SUBOPT_0x27
000c2f 940e 17d7 	CALL __CWD1
000c31 940e 17e1 	CALL __MULD12U
000c33 940e 1619 	CALL SUBOPT_0x4D
                 ; 0003 01F2 	fs->fatbase = bsect + LD_WORD(buf+BPB_RsvdSecCnt-13); /* FAT start sector (lba) */
000c35 940e 1623 	CALL SUBOPT_0x4F
                +
000c37 85ad     +LDD R26 , Y + 13
000c38 85be     +LDD R27 , Y + 13 + 1
000c39 858f     +LDD R24 , Y + 13 + 2
000c3a 8998     +LDD R25 , Y + 13 + 3
                 	__GETD2S 13
000c3b 940e 14e7 	CALL SUBOPT_0x1B
                +
000c3d a9ad     +LDD R26 , Y + 53
000c3e a9be     +LDD R27 , Y + 53 + 1
000c3f 961c     +ADIW R26 , 12
000c40 940e 184c+CALL __PUTDP1
                 	__PUTD1SNS 53,12
                 ; 0003 01F3 	fs->csize = buf[BPB_SecPerClus-13];					/* Number of sectors per cluster */
000c42 89e9      	LDD  R30,Y+17
                +
000c43 a9ad     +LDD R26 , Y + 53
000c44 a9be     +LDD R27 , Y + 53 + 1
000c45 9611     +ADIW R26 , 1
000c46 93ec     +ST X , R30
                 	__PUTB1SNS 53,1
                 ; 0003 01F4 	fs->n_rootdir = LD_WORD(buf+BPB_RootEntCnt-13);		/* Nmuber of root directory entries */
000c47 01fe      	MOVW R30,R28
000c48 96b2      	ADIW R30,34
000c49 973d      	SBIW R30,13
000c4a 01df      	MOVW R26,R30
000c4b 940e 183d 	CALL __GETW1P
                +
000c4d a9ad     +LDD R26 , Y + 53
000c4e a9be     +LDD R27 , Y + 53 + 1
000c4f 9614     +ADIW R26 , 4
000c50 93ed     +ST X + , R30
000c51 93fc     +ST X , R31
                 	__PUTW1SNS 53,4
                 ; 0003 01F5 	tsect = LD_WORD(buf+BPB_TotSec16-13);				/* Number of sectors on the file system */
000c52 01fe      	MOVW R30,R28
000c53 96b4      	ADIW R30,36
000c54 973d      	SBIW R30,13
000c55 01df      	MOVW R26,R30
000c56 940e 15ee 	CALL SUBOPT_0x46
                +
000c58 83ed     +STD Y + 5 , R30
000c59 83fe     +STD Y + 5 + 1 , R31
000c5a 836f     +STD Y + 5 + 2 , R22
000c5b 8778     +STD Y + 5 + 3 , R23
                 	__PUTD1S 5
                 ; 0003 01F6 	if (!tsect) tsect = LD_DWORD(buf+BPB_TotSec32-13);
000c5c 940e 18b6 	CALL __CPD10
000c5e f451      	BRNE _0x6008F
000c5f 01fe      	MOVW R30,R28
000c60 96f1      	ADIW R30,49
000c61 973d      	SBIW R30,13
000c62 01df      	MOVW R26,R30
000c63 940e 1841 	CALL __GETD1P
                +
000c65 83ed     +STD Y + 5 , R30
000c66 83fe     +STD Y + 5 + 1 , R31
000c67 836f     +STD Y + 5 + 2 , R22
000c68 8778     +STD Y + 5 + 3 , R23
                 	__PUTD1S 5
                 ; 0003 01F7 	mclst = (tsect						/* Last cluster# + 1 */
                 _0x6008F:
                 ; 0003 01F8 		- LD_WORD(buf+BPB_RsvdSecCnt-13) - fsize - fs->n_rootdir / 16
                 ; 0003 01F9 		) / fs->csize + 2;
000c69 940e 1623 	CALL SUBOPT_0x4F
                +
000c6b 81ad     +LDD R26 , Y + 5
000c6c 81be     +LDD R27 , Y + 5 + 1
000c6d 818f     +LDD R24 , Y + 5 + 2
000c6e 8598     +LDD R25 , Y + 5 + 3
                 	__GETD2S 5
000c6f 2766      	CLR  R22
000c70 2777      	CLR  R23
000c71 940e 187c 	CALL __SWAPD12
000c73 940e 1792 	CALL __SUBD12
000c75 940e 152c 	CALL SUBOPT_0x27
000c77 940e 1792 	CALL __SUBD12
000c79 937f      	PUSH R23
000c7a 936f      	PUSH R22
000c7b 93ff      	PUSH R31
000c7c 93ef      	PUSH R30
000c7d 940e 162a 	CALL SUBOPT_0x50
000c7f 91af      	POP  R26
000c80 91bf      	POP  R27
000c81 918f      	POP  R24
000c82 919f      	POP  R25
000c83 2766      	CLR  R22
000c84 2777      	CLR  R23
000c85 940e 1797 	CALL __SUBD21
000c87 a9ed      	LDD  R30,Y+53
000c88 a9fe      	LDD  R31,Y+53+1
000c89 940e 1632 	CALL SUBOPT_0x51
000c8b 940e 1814 	CALL __DIVD21U
                +
000c8d 5fee     +SUBI R30 , LOW ( - 2 )
000c8e 4fff     +SBCI R31 , HIGH ( - 2 )
000c8f 4f6f     +SBCI R22 , BYTE3 ( - 2 )
000c90 4f7f     +SBCI R23 , BYTE4 ( - 2 )
                 	__ADDD1N 2
                +
000c91 83e9     +STD Y + 1 , R30
000c92 83fa     +STD Y + 1 + 1 , R31
000c93 836b     +STD Y + 1 + 2 , R22
000c94 837c     +STD Y + 1 + 3 , R23
                 	__PUTD1S 1
                 ; 0003 01FA 	fs->max_clust = (CLUST)mclst;
                +
000c95 a9ad     +LDD R26 , Y + 53
000c96 a9be     +LDD R27 , Y + 53 + 1
000c97 9618     +ADIW R26 , 8
000c98 940e 184c+CALL __PUTDP1
                 	__PUTD1SNS 53,8
                 ; 0003 01FB 
                 ; 0003 01FC 	fmt = FS_FAT12;							/* Determine the FAT sub type */
000c9a e011      	LDI  R17,LOW(1)
                 ; 0003 01FD 	if (mclst >= 0xFF7) fmt = FS_FAT16;		/* Number of clusters >= 0xFF5 */
                +
000c9b 81a9     +LDD R26 , Y + 1
000c9c 81ba     +LDD R27 , Y + 1 + 1
000c9d 818b     +LDD R24 , Y + 1 + 2
000c9e 819c     +LDD R25 , Y + 1 + 3
                 	__GETD2S 1
                +
000c9f 3fa7     +CPI R26 , LOW ( 0xFF7 )
000ca0 e0ef     +LDI R30 , HIGH ( 0xFF7 )
000ca1 07be     +CPC R27 , R30
000ca2 e0e0     +LDI R30 , BYTE3 ( 0xFF7 )
000ca3 078e     +CPC R24 , R30
000ca4 e0e0     +LDI R30 , BYTE4 ( 0xFF7 )
000ca5 079e     +CPC R25 , R30
                 	__CPD2N 0xFF7
000ca6 f008      	BRLO _0x60090
000ca7 e012      	LDI  R17,LOW(2)
                 ; 0003 01FE 	if (mclst >= 0xFFF7)					/* Number of clusters >= 0xFFF5 */
                 _0x60090:
                +
000ca8 81a9     +LDD R26 , Y + 1
000ca9 81ba     +LDD R27 , Y + 1 + 1
000caa 818b     +LDD R24 , Y + 1 + 2
000cab 819c     +LDD R25 , Y + 1 + 3
                 	__GETD2S 1
                +
000cac 3fa7     +CPI R26 , LOW ( 0xFFF7 )
000cad efef     +LDI R30 , HIGH ( 0xFFF7 )
000cae 07be     +CPC R27 , R30
000caf e0e0     +LDI R30 , BYTE3 ( 0xFFF7 )
000cb0 078e     +CPC R24 , R30
000cb1 e0e0     +LDI R30 , BYTE4 ( 0xFFF7 )
000cb2 079e     +CPC R25 , R30
                 	__CPD2N 0xFFF7
000cb3 f008      	BRLO _0x60091
                 ; 0003 01FF #if _FS_FAT32
                 ; 0003 0200 		fmt = FS_FAT32;
000cb4 e013      	LDI  R17,LOW(3)
                 ; 0003 0201 #else
                 ; 0003 0202 		return FR_NO_FILESYSTEM;
                 ; 0003 0203 #endif
                 ; 0003 0204 
                 ; 0003 0205 	fs->fs_type = fmt;		/* FAT sub-type */
                 _0x60091:
000cb5 a9ad      	LDD  R26,Y+53
000cb6 a9be      	LDD  R27,Y+53+1
000cb7 931c      	ST   X,R17
                 ; 0003 0206 #if _FS_FAT32
                 ; 0003 0207 	if (fmt == FS_FAT32)
000cb8 3013      	CPI  R17,3
000cb9 f429      	BRNE _0x60092
                 ; 0003 0208 		fs->dirbase = LD_DWORD(buf+(BPB_RootClus-13));	/* Root directory start cluster */
                +
000cba a9e8     +LDD R30 , Y + 48
000cbb a9f9     +LDD R31 , Y + 48 + 1
000cbc a96a     +LDD R22 , Y + 48 + 2
000cbd a97b     +LDD R23 , Y + 48 + 3
                 	__GETD1S 48
000cbe c002      	RJMP _0x60115
                 ; 0003 0209 	else
                 _0x60092:
                 ; 0003 020A #endif
                 ; 0003 020B 		fs->dirbase = fs->fatbase + fsize;				/* Root directory start sector (lba) */
000cbf 940e 1637 	CALL SUBOPT_0x52
                 _0x60115:
                +
000cc1 a9ad     +LDD R26 , Y + 53
000cc2 a9be     +LDD R27 , Y + 53 + 1
000cc3 9650     +ADIW R26 , 16
000cc4 940e 184c+CALL __PUTDP1
                 	__PUTD1SNS 53,16
                 ; 0003 020C 	fs->database = fs->fatbase + fsize + fs->n_rootdir / 16;	/* Data start sector (lba) */
000cc6 940e 1637 	CALL SUBOPT_0x52
000cc8 937f      	PUSH R23
000cc9 936f      	PUSH R22
000cca 93ff      	PUSH R31
000ccb 93ef      	PUSH R30
000ccc 940e 162a 	CALL SUBOPT_0x50
000cce 91af      	POP  R26
000ccf 91bf      	POP  R27
000cd0 918f      	POP  R24
000cd1 919f      	POP  R25
000cd2 940e 14e7 	CALL SUBOPT_0x1B
                +
000cd4 a9ad     +LDD R26 , Y + 53
000cd5 a9be     +LDD R27 , Y + 53 + 1
000cd6 9654     +ADIW R26 , 20
000cd7 940e 184c+CALL __PUTDP1
                 	__PUTD1SNS 53,20
                 ; 0003 020D 
                 ; 0003 020E 	fs->flag = 0;
000cd9 a9ad      	LDD  R26,Y+53
000cda a9be      	LDD  R27,Y+53+1
000cdb 9612      	ADIW R26,2
000cdc e0e0      	LDI  R30,LOW(0)
000cdd 93ec      	ST   X,R30
                 ; 0003 020F 	FatFs = fs;
000cde a9ed      	LDD  R30,Y+53
000cdf a9fe      	LDD  R31,Y+53+1
000ce0 93e0 0b00 	STS  _FatFs_G003,R30
000ce2 93f0 0b01 	STS  _FatFs_G003+1,R31
                 ; 0003 0210 
                 ; 0003 0211 	return FR_OK;
                 _0x20C000C:
000ce4 e0e0      	LDI  R30,LOW(0)
                 _0x20C000B:
000ce5 8118      	LDD  R17,Y+0
000ce6 96e7      	ADIW R28,55
000ce7 9508      	RET
                 ; 0003 0212 }
                 ; .FEND
                 ;
                 ;
                 ;
                 ;
                 ;/*-----------------------------------------------------------------------*/
                 ;/* Open or Create a File                                                 */
                 ;/*-----------------------------------------------------------------------*/
                 ;
                 ;FRESULT pf_open (
                 ; 0003 021C 	const char *path	/* Pointer to the file name */
                 ; 0003 021D )
                 ; 0003 021E {
                 _pf_open:
                 ; .FSTART _pf_open
                 ; 0003 021F 	FRESULT res;
                 ; 0003 0220 	DIR dj;
                 ; 0003 0221 	BYTE sp[12], dir[32];
                 ; 0003 0222 	FATFS *fs = FatFs;
                 ; 0003 0223 
                 ; 0003 0224 
                 ; 0003 0225 	if (!fs)						/* Check file system */
000ce8 93ba      	ST   -Y,R27
000ce9 93aa      	ST   -Y,R26
000cea 97ec      	SBIW R28,60
000ceb 940e 159a 	CALL SUBOPT_0x3A
                 ;	*path -> Y+64
                 ;	res -> R17
                 ;	dj -> Y+48
                 ;	sp -> Y+36
                 ;	dir -> Y+4
                 ;	*fs -> R18,R19
000ced 2e02      	MOV  R0,R18
000cee 2a03      	OR   R0,R19
000cef f411      	BRNE _0x60094
                 ; 0003 0226 		return FR_NOT_ENABLED;
000cf0 e0e6      	LDI  R30,LOW(6)
000cf1 c036      	RJMP _0x20C000A
                 ; 0003 0227 
                 ; 0003 0228 	fs->flag = 0;
                 _0x60094:
000cf2 01d9      	MOVW R26,R18
000cf3 9612      	ADIW R26,2
000cf4 e0e0      	LDI  R30,LOW(0)
000cf5 93ec      	ST   X,R30
                 ; 0003 0229 	fs->buf = dir;
000cf6 940e 1641 	CALL SUBOPT_0x53
                 ; 0003 022A 	dj.fn = sp;
000cf8 abea      	STD  Y+50,R30
000cf9 abfb      	STD  Y+50+1,R31
                 ; 0003 022B 	res = follow_path(&dj, path);	/* Follow the file path */
000cfa 01fe      	MOVW R30,R28
000cfb 96f0      	ADIW R30,48
000cfc 93fa      	ST   -Y,R31
000cfd 93ea      	ST   -Y,R30
                +
000cfe 01de     +MOVW R26 , R28
000cff 5bae     +SUBI R26 , LOW ( - 66 )
000d00 4fbf     +SBCI R27 , HIGH ( - 66 )
000d01 900d     +LD R0 , X +
000d02 91bc     +LD R27 , X
000d03 2da0     +MOV R26 , R0
                 	__GETW2SX 66
000d04 de1a      	RCALL _follow_path_G003
000d05 2f1e      	MOV  R17,R30
                 ; 0003 022C 	if (res != FR_OK) return res;	/* Follow failed */
000d06 3010      	CPI  R17,0
000d07 f009      	BREQ _0x60095
000d08 c01f      	RJMP _0x20C000A
                 ; 0003 022D 	if (!dir[0] || (dir[DIR_Attr] & AM_DIR))	/* It is a directory */
                 _0x60095:
000d09 81ec      	LDD  R30,Y+4
000d0a 30e0      	CPI  R30,0
000d0b f019      	BREQ _0x60097
000d0c 85ef      	LDD  R30,Y+15
000d0d 71e0      	ANDI R30,LOW(0x10)
000d0e f011      	BREQ _0x60096
                 _0x60097:
                 ; 0003 022E 		return FR_NO_FILE;
000d0f e0e3      	LDI  R30,LOW(3)
000d10 c017      	RJMP _0x20C000A
                 ; 0003 022F 
                 ; 0003 0230 	fs->org_clust =						/* File start cluster */
                 _0x60096:
                 ; 0003 0231 #if _FS_FAT32
                 ; 0003 0232 		((DWORD)LD_WORD(dir+DIR_FstClusHI) << 16) |
                 ; 0003 0233 #endif
                 ; 0003 0234 		LD_WORD(dir+DIR_FstClusLO);
000d11 940e 164a 	CALL SUBOPT_0x54
                +
000d13 01d9     +MOVW R26 , R18
000d14 9690     +ADIW R26 , 32
000d15 940e 184c+CALL __PUTDP1
                 	__PUTD1RNS 18,32
                 ; 0003 0235 	fs->fsize = LD_DWORD(dir+DIR_FileSize);	/* File size */
                +
000d17 a1e8     +LDD R30 , Y + 32
000d18 a1f9     +LDD R31 , Y + 32 + 1
000d19 a16a     +LDD R22 , Y + 32 + 2
000d1a a17b     +LDD R23 , Y + 32 + 3
                 	__GETD1S 32
                +
000d1b 01d9     +MOVW R26 , R18
000d1c 965c     +ADIW R26 , 28
000d1d 940e 184c+CALL __PUTDP1
                 	__PUTD1RNS 18,28
                 ; 0003 0236 	fs->fptr = 0;						/* File pointer */
000d1f 01d9      	MOVW R26,R18
000d20 9658      	ADIW R26,24
000d21 940e 15e2 	CALL SUBOPT_0x44
                 ; 0003 0237 	fs->flag = FA_OPENED;
000d23 01d9      	MOVW R26,R18
000d24 9612      	ADIW R26,2
000d25 e0e1      	LDI  R30,LOW(1)
000d26 93ec      	ST   X,R30
                 ; 0003 0238 
                 ; 0003 0239 	return FR_OK;
000d27 e0e0      	LDI  R30,LOW(0)
                 _0x20C000A:
000d28 940e 18d7 	CALL __LOADLOCR4
000d2a 96ef      	ADIW R28,63
000d2b 9623      	ADIW R28,3
000d2c 9508      	RET
                 ; 0003 023A }
                 ; .FEND
                 ;
                 ;
                 ;
                 ;
                 ;/*-----------------------------------------------------------------------*/
                 ;/* Read File                                                             */
                 ;/*-----------------------------------------------------------------------*/
                 ;#if _USE_READ
                 ;
                 ;FRESULT pf_read (
                 ; 0003 0245 	void* buff,		/* Pointer to the read buffer (NULL:Forward data to the stream)*/
                 ; 0003 0246 	WORD btr,		/* Number of bytes to read */
                 ; 0003 0247 	WORD* br		/* Pointer to number of bytes read */
                 ; 0003 0248 )
                 ; 0003 0249 {
                 _pf_read:
                 ; .FSTART _pf_read
                 ; 0003 024A 	DRESULT dr;
                 ; 0003 024B 	CLUST clst;
                 ; 0003 024C 	DWORD sect, remain;
                 ; 0003 024D 	BYTE *rbuff = buff;
                 ; 0003 024E 	WORD rcnt;
                 ; 0003 024F 	FATFS *fs = FatFs;
                 ; 0003 0250 
                 ; 0003 0251 
                 ; 0003 0252 	*br = 0;
000d2d 93ba      	ST   -Y,R27
000d2e 93aa      	ST   -Y,R26
000d2f 972e      	SBIW R28,14
000d30 940e 18ce 	CALL __SAVELOCR6
                 ;	*buff -> Y+24
                 ;	btr -> Y+22
                 ;	*br -> Y+20
                 ;	dr -> R17
                 ;	clst -> Y+16
                 ;	sect -> Y+12
                 ;	remain -> Y+8
                 ;	*rbuff -> R18,R19
                 ;	rcnt -> R20,R21
                 ;	*fs -> Y+6
                +
000d32 8d28     +LDD R18 , Y + 24
000d33 8d39     +LDD R19 , Y + 24 + 1
                 	__GETWRS 18,19,24
000d34 940e 1536 	CALL SUBOPT_0x29
000d36 83ee      	STD  Y+6,R30
000d37 83ff      	STD  Y+6+1,R31
000d38 89ac      	LDD  R26,Y+20
000d39 89bd      	LDD  R27,Y+20+1
000d3a 940e 1592 	CALL SUBOPT_0x38
                 ; 0003 0253 	if (!fs) return FR_NOT_ENABLED;		/* Check file system */
000d3c 81ee      	LDD  R30,Y+6
000d3d 81ff      	LDD  R31,Y+6+1
000d3e 9730      	SBIW R30,0
000d3f f411      	BRNE _0x60099
000d40 e0e6      	LDI  R30,LOW(6)
000d41 c0d6      	RJMP _0x20C0009
                 ; 0003 0254 	if (!(fs->flag & FA_OPENED))		/* Check if opened */
                 _0x60099:
000d42 81ee      	LDD  R30,Y+6
000d43 81ff      	LDD  R31,Y+6+1
000d44 81a2      	LDD  R26,Z+2
000d45 70a1      	ANDI R26,LOW(0x1)
000d46 f411      	BRNE _0x6009A
                 ; 0003 0255 		return FR_NOT_OPENED;
000d47 e0e5      	LDI  R30,LOW(5)
000d48 c0cf      	RJMP _0x20C0009
                 ; 0003 0256 
                 ; 0003 0257 	remain = fs->fsize - fs->fptr;
                 _0x6009A:
000d49 81ee      	LDD  R30,Y+6
000d4a 81ff      	LDD  R31,Y+6+1
                +
000d4b 8da4     +LDD R26 , Z + 28
000d4c 8db5     +LDD R27 , Z + 28 + 1
000d4d 8d86     +LDD R24 , Z + 28 + 2
000d4e 8d97     +LDD R25 , Z + 28 + 3
                 	__GETD2Z 28
000d4f 939f      	PUSH R25
000d50 938f      	PUSH R24
000d51 93bf      	PUSH R27
000d52 93af      	PUSH R26
000d53 940e 1655 	CALL SUBOPT_0x55
000d55 91ef      	POP  R30
000d56 91ff      	POP  R31
000d57 916f      	POP  R22
000d58 917f      	POP  R23
000d59 940e 1792 	CALL __SUBD12
                +
000d5b 87e8     +STD Y + 8 , R30
000d5c 87f9     +STD Y + 8 + 1 , R31
000d5d 876a     +STD Y + 8 + 2 , R22
000d5e 877b     +STD Y + 8 + 3 , R23
                 	__PUTD1S 8
                 ; 0003 0258 	if (btr > remain) btr = (WORD)remain;			/* Truncate btr by remaining bytes */
000d5f 940e 14dd 	CALL SUBOPT_0x19
000d61 89ae      	LDD  R26,Y+22
000d62 89bf      	LDD  R27,Y+22+1
000d63 2788      	CLR  R24
000d64 2799      	CLR  R25
000d65 940e 18c4 	CALL __CPD12
000d67 f420      	BRSH _0x6009B
000d68 85e8      	LDD  R30,Y+8
000d69 85f9      	LDD  R31,Y+8+1
000d6a 8bee      	STD  Y+22,R30
000d6b 8bff      	STD  Y+22+1,R31
                 ; 0003 0259 
                 ; 0003 025A 	while (btr)	{									/* Repeat until all data transferred */
                 _0x6009B:
                 _0x6009C:
000d6c 89ee      	LDD  R30,Y+22
000d6d 89ff      	LDD  R31,Y+22+1
000d6e 9730      	SBIW R30,0
000d6f f409      	BRNE PC+2
000d70 c0a1      	RJMP _0x6009E
                 ; 0003 025B 		if ((fs->fptr % 512) == 0) {				/* On the sector boundary? */
000d71 940e 1655 	CALL SUBOPT_0x55
000d73 01fd      	MOVW R30,R26
000d74 01bc      	MOVW R22,R24
000d75 70f1      	ANDI R31,HIGH(0x1FF)
000d76 9730      	SBIW R30,0
000d77 f009      	BREQ PC+2
000d78 c04d      	RJMP _0x6009F
                 ; 0003 025C 			if ((fs->fptr / 512 % fs->csize) == 0) {	/* On the cluster boundary? */
000d79 940e 1655 	CALL SUBOPT_0x55
000d7b 940e 165c 	CALL SUBOPT_0x56
000d7d 81ee      	LDD  R30,Y+6
000d7e 81ff      	LDD  R31,Y+6+1
000d7f 940e 1632 	CALL SUBOPT_0x51
000d81 940e 1839 	CALL __MODD21U
000d83 940e 18b6 	CALL __CPD10
000d85 f541      	BRNE _0x600A0
                 ; 0003 025D 				clst = (fs->fptr == 0) ?			/* On the top of the file? */
                 ; 0003 025E 					fs->org_clust : get_fat(fs->curr_clust);
000d86 940e 1655 	CALL SUBOPT_0x55
000d88 940e 18be 	CALL __CPD02
000d8a f431      	BRNE _0x600A1
000d8b 81ae      	LDD  R26,Y+6
000d8c 81bf      	LDD  R27,Y+6+1
000d8d 9690      	ADIW R26,32
000d8e 940e 1841 	CALL __GETD1P
000d90 c003      	RJMP _0x600A2
                 _0x600A1:
000d91 940e 1665 	CALL SUBOPT_0x57
000d93 da5f      	RCALL _get_fat_G003
                 _0x600A2:
                +
000d94 8be8     +STD Y + 16 , R30
000d95 8bf9     +STD Y + 16 + 1 , R31
000d96 8b6a     +STD Y + 16 + 2 , R22
000d97 8b7b     +STD Y + 16 + 3 , R23
                 	__PUTD1S 16
                 ; 0003 025F 				if (clst <= 1) goto fr_abort;
                +
000d98 89a8     +LDD R26 , Y + 16
000d99 89b9     +LDD R27 , Y + 16 + 1
000d9a 898a     +LDD R24 , Y + 16 + 2
000d9b 899b     +LDD R25 , Y + 16 + 3
                 	__GETD2S 16
000d9c 940e 1540 	CALL SUBOPT_0x2B
000d9e f408      	BRSH _0x600A4
000d9f c074      	RJMP _0x600A5
                 ; 0003 0260 				fs->curr_clust = clst;				/* Update current cluster */
                 _0x600A4:
                +
000da0 89e8     +LDD R30 , Y + 16
000da1 89f9     +LDD R31 , Y + 16 + 1
000da2 896a     +LDD R22 , Y + 16 + 2
000da3 897b     +LDD R23 , Y + 16 + 3
                 	__GETD1S 16
                +
000da4 81ae     +LDD R26 , Y + 6
000da5 81bf     +LDD R27 , Y + 6 + 1
000da6 9694     +ADIW R26 , 36
000da7 940e 184c+CALL __PUTDP1
                 	__PUTD1SNS 6,36
                 ; 0003 0261 				fs->csect = 0;						/* Reset sector offset in the cluster */
000da9 81ae      	LDD  R26,Y+6
000daa 81bf      	LDD  R27,Y+6+1
000dab 9613      	ADIW R26,3
000dac e0e0      	LDI  R30,LOW(0)
000dad 93ec      	ST   X,R30
                 ; 0003 0262 			}
                 ; 0003 0263 			sect = clust2sect(fs->curr_clust);		/* Get current sector */
                 _0x600A0:
000dae 940e 1665 	CALL SUBOPT_0x57
000db0 db09      	RCALL _clust2sect_G003
                +
000db1 87ec     +STD Y + 12 , R30
000db2 87fd     +STD Y + 12 + 1 , R31
000db3 876e     +STD Y + 12 + 2 , R22
000db4 877f     +STD Y + 12 + 3 , R23
                 	__PUTD1S 12
                 ; 0003 0264 			if (!sect) goto fr_abort;
000db5 940e 18b6 	CALL __CPD10
000db7 f409      	BRNE _0x600A6
000db8 c05b      	RJMP _0x600A5
                 ; 0003 0265 			fs->dsect = sect + fs->csect++;
                 _0x600A6:
000db9 81ae      	LDD  R26,Y+6
000dba 81bf      	LDD  R27,Y+6+1
000dbb 940e 166c 	CALL SUBOPT_0x58
000dbd 940e 153b 	CALL SUBOPT_0x2A
000dbf 940e 1673 	CALL SUBOPT_0x59
                +
000dc1 81ae     +LDD R26 , Y + 6
000dc2 81bf     +LDD R27 , Y + 6 + 1
000dc3 9698     +ADIW R26 , 40
000dc4 940e 184c+CALL __PUTDP1
                 	__PUTD1SNS 6,40
                 ; 0003 0266 		}
                 ; 0003 0267 		rcnt = 512 - ((WORD)fs->fptr % 512);		/* Get partial sector data from sector buffer */
                 _0x6009F:
000dc6 81ee      	LDD  R30,Y+6
000dc7 81ff      	LDD  R31,Y+6+1
000dc8 940e 1678 	CALL SUBOPT_0x5A
000dca e0a0      	LDI  R26,LOW(512)
000dcb e0b2      	LDI  R27,HIGH(512)
000dcc 1bae      	SUB  R26,R30
000dcd 0bbf      	SBC  R27,R31
000dce 01ad      	MOVW R20,R26
                 ; 0003 0268 		if (rcnt > btr) rcnt = btr;
000dcf 89ee      	LDD  R30,Y+22
000dd0 89ff      	LDD  R31,Y+22+1
000dd1 17e4      	CP   R30,R20
000dd2 07f5      	CPC  R31,R21
000dd3 f410      	BRSH _0x600A7
                +
000dd4 894e     +LDD R20 , Y + 22
000dd5 895f     +LDD R21 , Y + 22 + 1
                 	__GETWRS 20,21,22
                 ; 0003 0269 		dr = disk_readp(!buff ? 0 : rbuff, fs->dsect, (WORD)(fs->fptr % 512), rcnt);
                 _0x600A7:
000dd6 8de8      	LDD  R30,Y+24
000dd7 8df9      	LDD  R31,Y+24+1
000dd8 9730      	SBIW R30,0
000dd9 f419      	BRNE _0x600A8
000dda e0e0      	LDI  R30,LOW(0)
000ddb e0f0      	LDI  R31,HIGH(0)
000ddc c001      	RJMP _0x600A9
                 _0x600A8:
000ddd 01f9      	MOVW R30,R18
                 _0x600A9:
000dde 93fa      	ST   -Y,R31
000ddf 93ea      	ST   -Y,R30
000de0 85e8      	LDD  R30,Y+8
000de1 85f9      	LDD  R31,Y+8+1
                +
000de2 a5a0     +LDD R26 , Z + 40
000de3 a5b1     +LDD R27 , Z + 40 + 1
000de4 a582     +LDD R24 , Z + 40 + 2
000de5 a593     +LDD R25 , Z + 40 + 3
                 	__GETD2Z 40
000de6 940e 1877 	CALL __PUTPARD2
000de8 85ac      	LDD  R26,Y+12
000de9 85bd      	LDD  R27,Y+12+1
000dea 9658      	ADIW R26,24
000deb 940e 183d 	CALL __GETW1P
000ded 70f1      	ANDI R31,HIGH(0x1FF)
000dee 93fa      	ST   -Y,R31
000def 93ea      	ST   -Y,R30
000df0 01da      	MOVW R26,R20
000df1 d8ee      	RCALL _disk_readp
000df2 2f1e      	MOV  R17,R30
                 ; 0003 026A 		if (dr) goto fr_abort;
000df3 3010      	CPI  R17,0
000df4 f4f9      	BRNE _0x600A5
                 ; 0003 026B 		fs->fptr += rcnt; rbuff += rcnt;			/* Update pointers and counters */
000df5 81ee      	LDD  R30,Y+6
000df6 81ff      	LDD  R31,Y+6+1
000df7 940e 167d 	CALL SUBOPT_0x5B
000df9 01df      	MOVW R26,R30
000dfa 01cb      	MOVW R24,R22
000dfb 01fa      	MOVW R30,R20
000dfc 940e 14e7 	CALL SUBOPT_0x1B
000dfe 01d0      	MOVW R26,R0
000dff 940e 184c 	CALL __PUTDP1
                +
000e01 0f24     +ADD R18 , R20
000e02 1f35     +ADC R19 , R21
                 	__ADDWRR 18,19,20,21
                 ; 0003 026C 		btr -= rcnt; *br += rcnt;
000e03 89ee      	LDD  R30,Y+22
000e04 89ff      	LDD  R31,Y+22+1
000e05 1be4      	SUB  R30,R20
000e06 0bf5      	SBC  R31,R21
000e07 8bee      	STD  Y+22,R30
000e08 8bff      	STD  Y+22+1,R31
000e09 89ac      	LDD  R26,Y+20
000e0a 89bd      	LDD  R27,Y+20+1
000e0b 91ed      	LD   R30,X+
000e0c 91fd      	LD   R31,X+
000e0d 0fe4      	ADD  R30,R20
000e0e 1ff5      	ADC  R31,R21
000e0f 93fe      	ST   -X,R31
000e10 93ee      	ST   -X,R30
                 ; 0003 026D 	}
000e11 cf5a      	RJMP _0x6009C
                 _0x6009E:
                 ; 0003 026E 
                 ; 0003 026F 	return FR_OK;
000e12 e0e0      	LDI  R30,LOW(0)
000e13 c004      	RJMP _0x20C0009
                 ; 0003 0270 
                 ; 0003 0271 fr_abort:
                 _0x600A5:
                 ; 0003 0272 	fs->flag = 0;
000e14 81ae      	LDD  R26,Y+6
000e15 81bf      	LDD  R27,Y+6+1
000e16 940e 1683 	CALL SUBOPT_0x5C
                 ; 0003 0273 	return FR_DISK_ERR;
                 _0x20C0009:
000e18 940e 18d5 	CALL __LOADLOCR6
000e1a 966a      	ADIW R28,26
000e1b 9508      	RET
                 ; 0003 0274 }
                 ; .FEND
                 ;#endif
                 ;
                 ;
                 ;
                 ;/*-----------------------------------------------------------------------*/
                 ;/* Write File                                                            */
                 ;/*-----------------------------------------------------------------------*/
                 ;#if _USE_WRITE
                 ;
                 ;FRESULT pf_write (
                 ; 0003 027F 	const void* buff,	/* Pointer to the data to be written */
                 ; 0003 0280 	WORD btw,			/* Number of bytes to write (0:Finalize the current write operation) */
                 ; 0003 0281 	WORD* bw			/* Pointer to number of bytes written */
                 ; 0003 0282 )
                 ; 0003 0283 {
                 _pf_write:
                 ; .FSTART _pf_write
                 ; 0003 0284 	CLUST clst;
                 ; 0003 0285 	DWORD sect, remain;
                 ; 0003 0286 	const BYTE *p = buff;
                 ; 0003 0287 	WORD wcnt;
                 ; 0003 0288 	FATFS *fs = FatFs;
                 ; 0003 0289 
                 ; 0003 028A 
                 ; 0003 028B 	*bw = 0;
000e1c 93ba      	ST   -Y,R27
000e1d 93aa      	ST   -Y,R26
000e1e 972c      	SBIW R28,12
000e1f 940e 18ce 	CALL __SAVELOCR6
                 ;	*buff -> Y+22
                 ;	btw -> Y+20
                 ;	*bw -> Y+18
                 ;	clst -> Y+14
                 ;	sect -> Y+10
                 ;	remain -> Y+6
                 ;	*p -> R16,R17
                 ;	wcnt -> R18,R19
                 ;	*fs -> R20,R21
                +
000e21 890e     +LDD R16 , Y + 22
000e22 891f     +LDD R17 , Y + 22 + 1
                 	__GETWRS 16,17,22
                +
000e23 9140 0b00+LDS R20 , 0 + ( _FatFs_G003 )
000e25 9150 0b01+LDS R21 , 0 + ( _FatFs_G003 ) + 1
                 	__GETWRMN 20,21,0,_FatFs_G003
000e27 89aa      	LDD  R26,Y+18
000e28 89bb      	LDD  R27,Y+18+1
000e29 940e 1592 	CALL SUBOPT_0x38
                 ; 0003 028C 	if (!fs) return FR_NOT_ENABLED;		/* Check file system */
000e2b 2e04      	MOV  R0,R20
000e2c 2a05      	OR   R0,R21
000e2d f411      	BRNE _0x600AC
000e2e e0e6      	LDI  R30,LOW(6)
000e2f c005      	RJMP _0x20C0008
                 ; 0003 028D 	if (!(fs->flag & FA_OPENED))		/* Check if opened */
                 _0x600AC:
000e30 01fa      	MOVW R30,R20
000e31 81a2      	LDD  R26,Z+2
000e32 70a1      	ANDI R26,LOW(0x1)
000e33 f429      	BRNE _0x600AD
                 ; 0003 028E 		return FR_NOT_OPENED;
000e34 e0e5      	LDI  R30,LOW(5)
                 _0x20C0008:
000e35 940e 18d5 	CALL __LOADLOCR6
000e37 9668      	ADIW R28,24
000e38 9508      	RET
                 ; 0003 028F 
                 ; 0003 0290 	if (!btw) {		/* Finalize request */
                 _0x600AD:
000e39 89ec      	LDD  R30,Y+20
000e3a 89fd      	LDD  R31,Y+20+1
000e3b 9730      	SBIW R30,0
000e3c f4a9      	BRNE _0x600AE
                 ; 0003 0291 		if ((fs->flag & FA__WIP) && disk_writep(0, 0)) goto fw_abort;
000e3d 01fa      	MOVW R30,R20
000e3e 81a2      	LDD  R26,Z+2
000e3f 74a0      	ANDI R26,LOW(0x40)
000e40 f039      	BREQ _0x600B0
000e41 940e 144f 	CALL SUBOPT_0x5
000e43 940e 1519 	CALL SUBOPT_0x23
000e45 d8fd      	RCALL _disk_writep
000e46 30e0      	CPI  R30,0
000e47 f409      	BRNE _0x600B1
                 _0x600B0:
000e48 c001      	RJMP _0x600AF
                 _0x600B1:
000e49 c0df      	RJMP _0x600B2
                 ; 0003 0292 		fs->flag &= ~FA__WIP;
                 _0x600AF:
000e4a 01da      	MOVW R26,R20
000e4b 9612      	ADIW R26,2
000e4c 91ec      	LD   R30,X
000e4d 7bef      	ANDI R30,0xBF
000e4e 93ec      	ST   X,R30
                 ; 0003 0293 		return FR_OK;
000e4f e0e0      	LDI  R30,LOW(0)
000e50 940c 1301 	JMP  _0x20C0003
                 ; 0003 0294 	} else {		/* Write data request */
                 _0x600AE:
                 ; 0003 0295 		if (!(fs->flag & FA__WIP))		/* Round down fptr to the sector boundary */
000e52 01fa      	MOVW R30,R20
000e53 81a2      	LDD  R26,Z+2
000e54 74a0      	ANDI R26,LOW(0x40)
000e55 f441      	BRNE _0x600B4
                 ; 0003 0296 			fs->fptr &= 0xFFFFFE00;
000e56 01da      	MOVW R26,R20
000e57 9658      	ADIW R26,24
000e58 91ed      	LD   R30,X+
000e59 91fd      	LD   R31,X+
000e5a 70e0      	ANDI R30,LOW(0xFFFFFE00)
000e5b 7ffe      	ANDI R31,HIGH(0xFFFFFE00)
000e5c 93fe      	ST   -X,R31
000e5d 93ee      	ST   -X,R30
                 ; 0003 0297 	}
                 _0x600B4:
                 ; 0003 0298 	remain = fs->fsize - fs->fptr;
000e5e 01fa      	MOVW R30,R20
                +
000e5f 8da4     +LDD R26 , Z + 28
000e60 8db5     +LDD R27 , Z + 28 + 1
000e61 8d86     +LDD R24 , Z + 28 + 2
000e62 8d97     +LDD R25 , Z + 28 + 3
                 	__GETD2Z 28
000e63 939f      	PUSH R25
000e64 938f      	PUSH R24
000e65 93bf      	PUSH R27
000e66 93af      	PUSH R26
000e67 940e 1688 	CALL SUBOPT_0x5D
000e69 91ef      	POP  R30
000e6a 91ff      	POP  R31
000e6b 916f      	POP  R22
000e6c 917f      	POP  R23
000e6d 940e 1792 	CALL __SUBD12
000e6f 940e 14b6 	CALL SUBOPT_0x14
                 ; 0003 0299 	if (btw > remain) btw = (WORD)remain;			/* Truncate btw by remaining bytes */
000e71 940e 14b1 	CALL SUBOPT_0x13
000e73 89ac      	LDD  R26,Y+20
000e74 89bd      	LDD  R27,Y+20+1
000e75 2788      	CLR  R24
000e76 2799      	CLR  R25
000e77 940e 18c4 	CALL __CPD12
000e79 f420      	BRSH _0x600B5
000e7a 81ee      	LDD  R30,Y+6
000e7b 81ff      	LDD  R31,Y+6+1
000e7c 8bec      	STD  Y+20,R30
000e7d 8bfd      	STD  Y+20+1,R31
                 ; 0003 029A 
                 ; 0003 029B 	while (btw)	{									/* Repeat until all data transferred */
                 _0x600B5:
                 _0x600B6:
000e7e 89ec      	LDD  R30,Y+20
000e7f 89fd      	LDD  R31,Y+20+1
000e80 9730      	SBIW R30,0
000e81 f409      	BRNE PC+2
000e82 c0a3      	RJMP _0x600B8
                 ; 0003 029C 		if (((WORD)fs->fptr % 512) == 0) {				/* On the sector boundary? */
000e83 01fa      	MOVW R30,R20
000e84 940e 1678 	CALL SUBOPT_0x5A
000e86 9730      	SBIW R30,0
000e87 f009      	BREQ PC+2
000e88 c059      	RJMP _0x600B9
                 ; 0003 029D 			if ((fs->fptr / 512 % fs->csize) == 0) {	/* On the cluster boundary? */
000e89 940e 1688 	CALL SUBOPT_0x5D
000e8b 940e 165c 	CALL SUBOPT_0x56
000e8d 01fa      	MOVW R30,R20
000e8e 940e 1632 	CALL SUBOPT_0x51
000e90 940e 1839 	CALL __MODD21U
000e92 940e 18b6 	CALL __CPD10
000e94 f511      	BRNE _0x600BA
                 ; 0003 029E 				clst = (fs->fptr == 0) ?			/* On the top of the file? */
                 ; 0003 029F 					fs->org_clust : get_fat(fs->curr_clust);
000e95 940e 1688 	CALL SUBOPT_0x5D
000e97 940e 18be 	CALL __CPD02
000e99 f429      	BRNE _0x600BB
000e9a 01da      	MOVW R26,R20
000e9b 9690      	ADIW R26,32
000e9c 940e 1841 	CALL __GETD1P
000e9e c006      	RJMP _0x600BC
                 _0x600BB:
000e9f 01fa      	MOVW R30,R20
                +
000ea0 a1a4     +LDD R26 , Z + 36
000ea1 a1b5     +LDD R27 , Z + 36 + 1
000ea2 a186     +LDD R24 , Z + 36 + 2
000ea3 a197     +LDD R25 , Z + 36 + 3
                 	__GETD2Z 36
000ea4 d94e      	RCALL _get_fat_G003
                 _0x600BC:
000ea5 940e 168e 	CALL SUBOPT_0x5E
                 ; 0003 02A0 				if (clst <= 1) goto fw_abort;
000ea7 940e 156d 	CALL SUBOPT_0x31
000ea9 940e 1540 	CALL SUBOPT_0x2B
000eab f408      	BRSH _0x600BE
000eac c07c      	RJMP _0x600B2
                 ; 0003 02A1 				fs->curr_clust = clst;				/* Update current cluster */
                 _0x600BE:
000ead 940e 1693 	CALL SUBOPT_0x5F
                +
000eaf 01da     +MOVW R26 , R20
000eb0 9694     +ADIW R26 , 36
000eb1 940e 184c+CALL __PUTDP1
                 	__PUTD1RNS 20,36
                 ; 0003 02A2 				fs->csect = 0;						/* Reset sector offset in the cluster */
000eb3 01da      	MOVW R26,R20
000eb4 9613      	ADIW R26,3
000eb5 e0e0      	LDI  R30,LOW(0)
000eb6 93ec      	ST   X,R30
                 ; 0003 02A3 			}
                 ; 0003 02A4 			sect = clust2sect(fs->curr_clust);		/* Get current sector */
                 _0x600BA:
000eb7 01fa      	MOVW R30,R20
                +
000eb8 a1a4     +LDD R26 , Z + 36
000eb9 a1b5     +LDD R27 , Z + 36 + 1
000eba a186     +LDD R24 , Z + 36 + 2
000ebb a197     +LDD R25 , Z + 36 + 3
                 	__GETD2Z 36
000ebc d9fd      	RCALL _clust2sect_G003
                +
000ebd 87ea     +STD Y + 10 , R30
000ebe 87fb     +STD Y + 10 + 1 , R31
000ebf 876c     +STD Y + 10 + 2 , R22
000ec0 877d     +STD Y + 10 + 3 , R23
                 	__PUTD1S 10
                 ; 0003 02A5 			if (!sect) goto fw_abort;
000ec1 940e 14ec 	CALL SUBOPT_0x1C
000ec3 940e 18b6 	CALL __CPD10
000ec5 f409      	BRNE _0x600BF
000ec6 c062      	RJMP _0x600B2
                 ; 0003 02A6 			fs->dsect = sect + fs->csect++;
                 _0x600BF:
000ec7 01da      	MOVW R26,R20
000ec8 940e 166c 	CALL SUBOPT_0x58
000eca 940e 14f1 	CALL SUBOPT_0x1D
000ecc 940e 1673 	CALL SUBOPT_0x59
                +
000ece 01da     +MOVW R26 , R20
000ecf 9698     +ADIW R26 , 40
000ed0 940e 184c+CALL __PUTDP1
                 	__PUTD1RNS 20,40
                 ; 0003 02A7 			if (disk_writep(0, fs->dsect)) goto fw_abort;	/* Initiate a sector write operation */
000ed2 940e 144f 	CALL SUBOPT_0x5
000ed4 01fa      	MOVW R30,R20
                +
000ed5 a5a0     +LDD R26 , Z + 40
000ed6 a5b1     +LDD R27 , Z + 40 + 1
000ed7 a582     +LDD R24 , Z + 40 + 2
000ed8 a593     +LDD R25 , Z + 40 + 3
                 	__GETD2Z 40
000ed9 d869      	RCALL _disk_writep
000eda 30e0      	CPI  R30,0
000edb f009      	BREQ _0x600C0
000edc c04c      	RJMP _0x600B2
                 ; 0003 02A8 			fs->flag |= FA__WIP;
                 _0x600C0:
000edd 01da      	MOVW R26,R20
000ede 9612      	ADIW R26,2
000edf 91ec      	LD   R30,X
000ee0 64e0      	ORI  R30,0x40
000ee1 93ec      	ST   X,R30
                 ; 0003 02A9 		}
                 ; 0003 02AA 		wcnt = 512 - ((WORD)fs->fptr % 512);		/* Number of bytes to write to the sector */
                 _0x600B9:
000ee2 01fa      	MOVW R30,R20
000ee3 940e 1678 	CALL SUBOPT_0x5A
000ee5 e0a0      	LDI  R26,LOW(512)
000ee6 e0b2      	LDI  R27,HIGH(512)
000ee7 1bae      	SUB  R26,R30
000ee8 0bbf      	SBC  R27,R31
000ee9 019d      	MOVW R18,R26
                 ; 0003 02AB 		if (wcnt > btw) wcnt = btw;
000eea 89ec      	LDD  R30,Y+20
000eeb 89fd      	LDD  R31,Y+20+1
000eec 17e2      	CP   R30,R18
000eed 07f3      	CPC  R31,R19
000eee f410      	BRSH _0x600C1
                +
000eef 892c     +LDD R18 , Y + 20
000ef0 893d     +LDD R19 , Y + 20 + 1
                 	__GETWRS 18,19,20
                 ; 0003 02AC 		if (disk_writep(p, wcnt)) goto fw_abort;	/* Send data to the sector */
                 _0x600C1:
000ef1 931a      	ST   -Y,R17
000ef2 930a      	ST   -Y,R16
000ef3 01d9      	MOVW R26,R18
000ef4 2788      	CLR  R24
000ef5 2799      	CLR  R25
000ef6 d84c      	RCALL _disk_writep
000ef7 30e0      	CPI  R30,0
000ef8 f581      	BRNE _0x600B2
                 ; 0003 02AD 		fs->fptr += wcnt; p += wcnt;				/* Update pointers and counters */
000ef9 01fa      	MOVW R30,R20
000efa 940e 167d 	CALL SUBOPT_0x5B
000efc 01df      	MOVW R26,R30
000efd 01cb      	MOVW R24,R22
000efe 01f9      	MOVW R30,R18
000eff 940e 14e7 	CALL SUBOPT_0x1B
000f01 01d0      	MOVW R26,R0
000f02 940e 184c 	CALL __PUTDP1
                +
000f04 0f02     +ADD R16 , R18
000f05 1f13     +ADC R17 , R19
                 	__ADDWRR 16,17,18,19
                 ; 0003 02AE 		btw -= wcnt; *bw += wcnt;
000f06 89ec      	LDD  R30,Y+20
000f07 89fd      	LDD  R31,Y+20+1
000f08 1be2      	SUB  R30,R18
000f09 0bf3      	SBC  R31,R19
000f0a 8bec      	STD  Y+20,R30
000f0b 8bfd      	STD  Y+20+1,R31
000f0c 89aa      	LDD  R26,Y+18
000f0d 89bb      	LDD  R27,Y+18+1
000f0e 91ed      	LD   R30,X+
000f0f 91fd      	LD   R31,X+
000f10 0fe2      	ADD  R30,R18
000f11 1ff3      	ADC  R31,R19
000f12 93fe      	ST   -X,R31
000f13 93ee      	ST   -X,R30
                 ; 0003 02AF 		if (((WORD)fs->fptr % 512) == 0) {
000f14 01fa      	MOVW R30,R20
000f15 940e 1678 	CALL SUBOPT_0x5A
000f17 9730      	SBIW R30,0
000f18 f461      	BRNE _0x600C3
                 ; 0003 02B0 			if (disk_writep(0, 0)) goto fw_abort;	/* Finalize the currtent secter write operation */
000f19 940e 144f 	CALL SUBOPT_0x5
000f1b 940e 1519 	CALL SUBOPT_0x23
000f1d d825      	RCALL _disk_writep
000f1e 30e0      	CPI  R30,0
000f1f f449      	BRNE _0x600B2
                 ; 0003 02B1 			fs->flag &= ~FA__WIP;
000f20 01da      	MOVW R26,R20
000f21 9612      	ADIW R26,2
000f22 91ec      	LD   R30,X
000f23 7bef      	ANDI R30,0xBF
000f24 93ec      	ST   X,R30
                 ; 0003 02B2 		}
                 ; 0003 02B3 	}
                 _0x600C3:
000f25 cf58      	RJMP _0x600B6
                 _0x600B8:
                 ; 0003 02B4 
                 ; 0003 02B5 	return FR_OK;
000f26 e0e0      	LDI  R30,LOW(0)
000f27 940c 1301 	JMP  _0x20C0003
                 ; 0003 02B6 
                 ; 0003 02B7 fw_abort:
                 _0x600B2:
                 ; 0003 02B8 	fs->flag = 0;
000f29 01da      	MOVW R26,R20
000f2a 940e 1683 	CALL SUBOPT_0x5C
                 ; 0003 02B9 	return FR_DISK_ERR;
000f2c 940c 1301 	JMP  _0x20C0003
                 ; 0003 02BA }
                 ; .FEND
                 ;
                 ;FRESULT pf_write512 (
                 ; 0003 02BD 	BYTE* buff,	/* Pointer to the data to be written */
                 ; 0003 02BE 	WORD ofs,			//offset to fill data
                 ; 0003 02BF 	WORD btw,           /* Number of bytes to write */
                 ; 0003 02C0     WORD* bw			/* Pointer to number of bytes written */
                 ; 0003 02C1 )
                 ; 0003 02C2 {
                 _pf_write512:
                 ; .FSTART _pf_write512
                 ; 0003 02C3      BYTE res;
                 ; 0003 02C4      WORD i=ofs%512,j=0;
                 ; 0003 02C5      BYTE buf512[512];
                 ; 0003 02C6      FATFS *fs = FatFs;
                 ; 0003 02C7 
                 ; 0003 02C8      //WORD nbytes=0;
                 ; 0003 02C9      if((btw)>512){
000f2e 93ba      	ST   -Y,R27
000f2f 93aa      	ST   -Y,R26
000f30 9722      	SBIW R28,2
000f31 50d2      	SUBI R29,2
000f32 940e 18ce 	CALL __SAVELOCR6
                 ;	*buff -> Y+526
                 ;	ofs -> Y+524
                 ;	btw -> Y+522
                 ;	*bw -> Y+520
                 ;	res -> R17
                 ;	i -> R18,R19
                 ;	j -> R20,R21
                 ;	buf512 -> Y+8
                 ;	*fs -> Y+6
000f34 940e 1698 	CALL SUBOPT_0x60
000f36 019f      	MOVW R18,R30
                +
000f37 e040     +LDI R20 , LOW ( 0 )
000f38 e050     +LDI R21 , HIGH ( 0 )
                 	__GETWRN 20,21,0
000f39 940e 1536 	CALL SUBOPT_0x29
000f3b 83ee      	STD  Y+6,R30
000f3c 83ff      	STD  Y+6+1,R31
000f3d 940e 16a0 	CALL SUBOPT_0x61
000f3f 30a1      	CPI  R26,LOW(0x201)
000f40 e0e2      	LDI  R30,HIGH(0x201)
000f41 07be      	CPC  R27,R30
000f42 f010      	BRLO _0x600C5
                 ; 0003 02CA          return FR_DISK_ERR; //write bytes great than 512
000f43 e0e1      	LDI  R30,LOW(1)
000f44 c05b      	RJMP _0x20C0007
                 ; 0003 02CB      }
                 ; 0003 02CC      res=pf_lseek((ofs/512)*512);
                 _0x600C5:
000f45 940e 16a7 	CALL SUBOPT_0x62
000f47 e0e0      	LDI  R30,LOW(512)
000f48 e0f2      	LDI  R31,HIGH(512)
000f49 940e 1801 	CALL __DIVW21U
000f4b 0fee      	LSL  R30
000f4c 1fff      	ROL  R31
000f4d 2ffe      	MOV  R31,R30
000f4e e0e0      	LDI  R30,0
000f4f 2766      	CLR  R22
000f50 2777      	CLR  R23
000f51 01df      	MOVW R26,R30
000f52 01cb      	MOVW R24,R22
000f53 d051      	RCALL _pf_lseek
000f54 2f1e      	MOV  R17,R30
                 ; 0003 02CD      if(((ofs%512)+btw)>512){//read replace then write
000f55 940e 1698 	CALL SUBOPT_0x60
000f57 940e 16a0 	CALL SUBOPT_0x61
000f59 0fae      	ADD  R26,R30
000f5a 1fbf      	ADC  R27,R31
000f5b 30a1      	CPI  R26,LOW(0x201)
000f5c e0e2      	LDI  R30,HIGH(0x201)
000f5d 07be      	CPC  R27,R30
000f5e f0f8      	BRLO _0x600C6
                 ; 0003 02CE         res=pf_read(buf512, 512, bw);
000f5f 940e 16ae 	CALL SUBOPT_0x63
000f61 ddcb      	RCALL _pf_read
000f62 2f1e      	MOV  R17,R30
                 ; 0003 02CF         if(res!=FR_OK){
000f63 3010      	CPI  R17,0
000f64 f009      	BREQ _0x600C7
                 ; 0003 02D0             return res;
000f65 c03a      	RJMP _0x20C0007
                 ; 0003 02D1         }
                 ; 0003 02D2         for(;i<512;i++,j++){
                 _0x600C7:
                 _0x600C9:
                +
000f66 3020     +CPI R18 , LOW ( 512 )
000f67 e0e2     +LDI R30 , HIGH ( 512 )
000f68 073e     +CPC R19 , R30
                 	__CPWRN 18,19,512
000f69 f438      	BRSH _0x600CA
                 ; 0003 02D3             buf512[i]=buff[j];
000f6a 940e 16b7 	CALL SUBOPT_0x64
                 ; 0003 02D4         }
                +
000f6c 5f2f     +SUBI R18 , LOW ( - 1 )
000f6d 4f3f     +SBCI R19 , HIGH ( - 1 )
                 	__ADDWRN 18,19,1
                +
000f6e 5f4f     +SUBI R20 , LOW ( - 1 )
000f6f 4f5f     +SBCI R21 , HIGH ( - 1 )
                 	__ADDWRN 20,21,1
000f70 cff5      	RJMP _0x600C9
                 _0x600CA:
                 ; 0003 02D5         res=pf_lseek(fs->fptr - 512);
000f71 940e 1655 	CALL SUBOPT_0x55
000f73 940e 16ca 	CALL SUBOPT_0x65
                 ; 0003 02D6         //res=pf_lseek((ofs/512)*512);
                 ; 0003 02D7         res=pf_write(buf512, 512, bw);
000f75 940e 16ae 	CALL SUBOPT_0x63
000f77 dea4      	RCALL _pf_write
000f78 2f1e      	MOV  R17,R30
                 ; 0003 02D8         if(res!=FR_OK){
000f79 3010      	CPI  R17,0
000f7a f009      	BREQ _0x600CB
                 ; 0003 02D9             return res;
000f7b c024      	RJMP _0x20C0007
                 ; 0003 02DA         }
                 ; 0003 02DB         i=0;
                 _0x600CB:
                +
000f7c e020     +LDI R18 , LOW ( 0 )
000f7d e030     +LDI R19 , HIGH ( 0 )
                 	__GETWRN 18,19,0
                 ; 0003 02DC          //return FR_DISK_ERR; //write bytes great than 512
                 ; 0003 02DD      }
                 ; 0003 02DE      {
                 _0x600C6:
                 ; 0003 02DF 
                 ; 0003 02E0         res=pf_read(buf512, 512, bw);
000f7e 940e 16ae 	CALL SUBOPT_0x63
000f80 ddac      	RCALL _pf_read
000f81 2f1e      	MOV  R17,R30
                 ; 0003 02E1         res=pf_lseek(fs->fptr - 512);
000f82 940e 1655 	CALL SUBOPT_0x55
000f84 940e 16ca 	CALL SUBOPT_0x65
                 ; 0003 02E2         /*
                 ; 0003 02E3         if(j>0){
                 ; 0003 02E4             res=pf_lseek(((ofs/512)+1)*512);
                 ; 0003 02E5         }
                 ; 0003 02E6         else{
                 ; 0003 02E7             res=pf_lseek((ofs/512)*512);
                 ; 0003 02E8         }
                 ; 0003 02E9         */
                 ; 0003 02EA         if(res!=FR_OK){
000f86 3010      	CPI  R17,0
000f87 f011      	BREQ _0x600CC
                 ; 0003 02EB             return res;
000f88 2fe1      	MOV  R30,R17
000f89 c016      	RJMP _0x20C0007
                 ; 0003 02EC         }
                 ; 0003 02ED         for(;j<btw;i++,j++){
                 _0x600CC:
                 _0x600CE:
                +
000f8a 01fe     +MOVW R30 , R28
000f8b 5fe6     +SUBI R30 , LOW ( - 522 )
000f8c 4ffd     +SBCI R31 , HIGH ( - 522 )
000f8d 9001     +LD R0 , Z +
000f8e 81f0     +LD R31 , Z
000f8f 2de0     +MOV R30 , R0
                 	__GETW1SX 522
000f90 174e      	CP   R20,R30
000f91 075f      	CPC  R21,R31
000f92 f438      	BRSH _0x600CF
                 ; 0003 02EE             buf512[i]=buff[j];
000f93 940e 16b7 	CALL SUBOPT_0x64
                 ; 0003 02EF         }
                +
000f95 5f2f     +SUBI R18 , LOW ( - 1 )
000f96 4f3f     +SBCI R19 , HIGH ( - 1 )
                 	__ADDWRN 18,19,1
                +
000f97 5f4f     +SUBI R20 , LOW ( - 1 )
000f98 4f5f     +SBCI R21 , HIGH ( - 1 )
                 	__ADDWRN 20,21,1
000f99 cff0      	RJMP _0x600CE
                 _0x600CF:
                 ; 0003 02F0 
                 ; 0003 02F1         res=pf_write(buf512, 512, bw);
000f9a 940e 16ae 	CALL SUBOPT_0x63
000f9c de7f      	RCALL _pf_write
000f9d 2f1e      	MOV  R17,R30
                 ; 0003 02F2         if(res!=FR_OK){
000f9e 3010      	CPI  R17,0
000f9f f001      	BREQ _0x600D0
                 ; 0003 02F3             return res;
                 ; 0003 02F4         }
                 ; 0003 02F5      }
                 _0x600D0:
                 ; 0003 02F6 
                 ; 0003 02F7 }
                 _0x20C0007:
000fa0 940e 18d5 	CALL __LOADLOCR6
000fa2 9660      	ADIW R28,16
000fa3 5fde      	SUBI R29,-2
000fa4 9508      	RET
                 ; .FEND
                 ;#endif
                 ;
                 ;
                 ;
                 ;/*-----------------------------------------------------------------------*/
                 ;/* Seek File R/W Pointer                                                 */
                 ;/*-----------------------------------------------------------------------*/
                 ;#if _USE_LSEEK
                 ;
                 ;FRESULT pf_lseek (
                 ; 0003 0302 	DWORD ofs		/* File pointer from top of file */
                 ; 0003 0303 )
                 ; 0003 0304 {
                 _pf_lseek:
                 ; .FSTART _pf_lseek
                 ; 0003 0305 	CLUST clst;
                 ; 0003 0306 	DWORD bcs, sect, ifptr;
                 ; 0003 0307 	FATFS *fs = FatFs;
                 ; 0003 0308 
                 ; 0003 0309 
                 ; 0003 030A 	if (!fs) return FR_NOT_ENABLED;		/* Check file system */
000fa5 940e 1877 	CALL __PUTPARD2
000fa7 9760      	SBIW R28,16
000fa8 940e 157c 	CALL SUBOPT_0x34
                 ;	ofs -> Y+18
                 ;	clst -> Y+14
                 ;	bcs -> Y+10
                 ;	sect -> Y+6
                 ;	ifptr -> Y+2
                 ;	*fs -> R16,R17
000faa 2e00      	MOV  R0,R16
000fab 2a01      	OR   R0,R17
000fac f411      	BRNE _0x600D1
000fad e0e6      	LDI  R30,LOW(6)
000fae c0d7      	RJMP _0x20C0006
                 ; 0003 030B 	if (!(fs->flag & FA_OPENED))		/* Check if opened */
                 _0x600D1:
000faf 01f8      	MOVW R30,R16
000fb0 81a2      	LDD  R26,Z+2
000fb1 70a1      	ANDI R26,LOW(0x1)
000fb2 f411      	BRNE _0x600D2
                 ; 0003 030C 			return FR_NOT_OPENED;
000fb3 e0e5      	LDI  R30,LOW(5)
000fb4 c0d1      	RJMP _0x20C0006
                 ; 0003 030D 
                 ; 0003 030E 	if (ofs > fs->fsize) ofs = fs->fsize;	/* Clip offset with the file size */
                 _0x600D2:
000fb5 01d8      	MOVW R26,R16
000fb6 965c      	ADIW R26,28
000fb7 940e 16d2 	CALL SUBOPT_0x66
000fb9 940e 18c4 	CALL __CPD12
000fbb f440      	BRSH _0x600D3
000fbc 01d8      	MOVW R26,R16
000fbd 965c      	ADIW R26,28
000fbe 940e 1841 	CALL __GETD1P
                +
000fc0 8bea     +STD Y + 18 , R30
000fc1 8bfb     +STD Y + 18 + 1 , R31
000fc2 8b6c     +STD Y + 18 + 2 , R22
000fc3 8b7d     +STD Y + 18 + 3 , R23
                 	__PUTD1S 18
                 ; 0003 030F 	ifptr = fs->fptr;
                 _0x600D3:
000fc4 01d8      	MOVW R26,R16
000fc5 9658      	ADIW R26,24
000fc6 940e 1597 	CALL SUBOPT_0x39
                 ; 0003 0310 	fs->fptr = 0;
000fc8 01d8      	MOVW R26,R16
000fc9 9658      	ADIW R26,24
000fca 940e 15e2 	CALL SUBOPT_0x44
                 ; 0003 0311 	if (ofs > 0) {
000fcc 940e 16d9 	CALL SUBOPT_0x67
000fce 940e 18be 	CALL __CPD02
000fd0 f008      	BRLO PC+2
000fd1 c0af      	RJMP _0x600D4
                 ; 0003 0312 		bcs = (DWORD)fs->csize * 512;	/* Cluster size (byte) */
000fd2 01f8      	MOVW R30,R16
000fd3 940e 1632 	CALL SUBOPT_0x51
000fd5 940e 1528 	CALL SUBOPT_0x26
                +
000fd7 87ea     +STD Y + 10 , R30
000fd8 87fb     +STD Y + 10 + 1 , R31
000fd9 876c     +STD Y + 10 + 2 , R22
000fda 877d     +STD Y + 10 + 3 , R23
                 	__PUTD1S 10
                 ; 0003 0313 		if (ifptr > 0 &&
                 ; 0003 0314 			(ofs - 1) / bcs >= (ifptr - 1) / bcs) {	/* When seek to same or following cluster, */
000fdb 940e 1588 	CALL SUBOPT_0x36
000fdd 940e 18be 	CALL __CPD02
000fdf f498      	BRSH _0x600D6
000fe0 940e 16de 	CALL SUBOPT_0x68
000fe2 940e 16e3 	CALL SUBOPT_0x69
000fe4 937f      	PUSH R23
000fe5 936f      	PUSH R22
000fe6 93ff      	PUSH R31
000fe7 93ef      	PUSH R30
000fe8 940e 150d 	CALL SUBOPT_0x21
000fea 940e 16e3 	CALL SUBOPT_0x69
000fec 91af      	POP  R26
000fed 91bf      	POP  R27
000fee 918f      	POP  R24
000fef 919f      	POP  R25
000ff0 940e 18c9 	CALL __CPD21
000ff2 f408      	BRSH _0x600D7
                 _0x600D6:
000ff3 c023      	RJMP _0x600D5
                 _0x600D7:
                 ; 0003 0315 			fs->fptr = (ifptr - 1) & ~(bcs - 1);	/* start from the current cluster */
000ff4 940e 150d 	CALL SUBOPT_0x21
000ff6 940e 16ed 	CALL SUBOPT_0x6A
000ff8 01df      	MOVW R26,R30
000ff9 01cb      	MOVW R24,R22
000ffa 940e 14ec 	CALL SUBOPT_0x1C
000ffc 940e 16ed 	CALL SUBOPT_0x6A
000ffe 940e 17dc 	CALL __COMD1
001000 940e 179c 	CALL __ANDD12
                +
001002 01d8     +MOVW R26 , R16
001003 9658     +ADIW R26 , 24
001004 940e 184c+CALL __PUTDP1
                 	__PUTD1RNS 16,24
                 ; 0003 0316 			ofs -= fs->fptr;
001006 01d8      	MOVW R26,R16
001007 9658      	ADIW R26,24
001008 940e 16d2 	CALL SUBOPT_0x66
00100a 940e 1797 	CALL __SUBD21
                +
00100c 8baa     +STD Y + 18 , R26
00100d 8bbb     +STD Y + 18 + 1 , R27
00100e 8b8c     +STD Y + 18 + 2 , R24
00100f 8b9d     +STD Y + 18 + 3 , R25
                 	__PUTD2S 18
                 ; 0003 0317 			clst = fs->curr_clust;
001010 01d8      	MOVW R26,R16
001011 9694      	ADIW R26,36
001012 940e 1841 	CALL __GETD1P
001014 940e 168e 	CALL SUBOPT_0x5E
                 ; 0003 0318 		} else {							/* When seek to back cluster, */
001016 c008      	RJMP _0x600D8
                 _0x600D5:
                 ; 0003 0319 			clst = fs->org_clust;			/* start from the first cluster */
001017 01d8      	MOVW R26,R16
001018 9690      	ADIW R26,32
001019 940e 1841 	CALL __GETD1P
00101b 940e 168e 	CALL SUBOPT_0x5E
                 ; 0003 031A 			fs->curr_clust = clst;
00101d 940e 16f2 	CALL SUBOPT_0x6B
                 ; 0003 031B 		}
                 _0x600D8:
                 ; 0003 031C 		while (ofs > bcs) {				/* Cluster following loop */
                 _0x600D9:
00101f 940e 14ec 	CALL SUBOPT_0x1C
001021 940e 16d9 	CALL SUBOPT_0x67
001023 940e 18c4 	CALL __CPD12
001025 f560      	BRSH _0x600DB
                 ; 0003 031D 			clst = get_fat(clst);		/* Follow cluster chain */
001026 940e 156d 	CALL SUBOPT_0x31
001028 940e 07f3 	CALL _get_fat_G003
00102a 940e 168e 	CALL SUBOPT_0x5E
                 ; 0003 031E 			if (clst <= 1 || clst >= fs->max_clust) goto fe_abort;
00102c 940e 156d 	CALL SUBOPT_0x31
00102e 940e 1540 	CALL SUBOPT_0x2B
001030 f048      	BRLO _0x600DD
001031 01d8      	MOVW R26,R16
001032 9618      	ADIW R26,8
001033 940e 1841 	CALL __GETD1P
001035 940e 156d 	CALL SUBOPT_0x31
001037 940e 18c9 	CALL __CPD21
001039 f008      	BRLO _0x600DC
                 _0x600DD:
00103a c048      	RJMP _0x600DF
                 ; 0003 031F 			fs->curr_clust = clst;
                 _0x600DC:
00103b 940e 16f2 	CALL SUBOPT_0x6B
                 ; 0003 0320 			fs->fptr += bcs;
00103d 01f8      	MOVW R30,R16
00103e 940e 167d 	CALL SUBOPT_0x5B
001040 940e 14f1 	CALL SUBOPT_0x1D
001042 940e 1788 	CALL __ADDD12
001044 01d0      	MOVW R26,R0
001045 940e 184c 	CALL __PUTDP1
                 ; 0003 0321 			ofs -= bcs;
001047 940e 14f1 	CALL SUBOPT_0x1D
001049 940e 16de 	CALL SUBOPT_0x68
00104b 940e 1792 	CALL __SUBD12
                +
00104d 8bea     +STD Y + 18 , R30
00104e 8bfb     +STD Y + 18 + 1 , R31
00104f 8b6c     +STD Y + 18 + 2 , R22
001050 8b7d     +STD Y + 18 + 3 , R23
                 	__PUTD1S 18
                 ; 0003 0322 		}
001051 cfcd      	RJMP _0x600D9
                 _0x600DB:
                 ; 0003 0323 		fs->fptr += ofs;
001052 01f8      	MOVW R30,R16
001053 940e 167d 	CALL SUBOPT_0x5B
001055 940e 16d9 	CALL SUBOPT_0x67
001057 940e 1788 	CALL __ADDD12
001059 01d0      	MOVW R26,R0
00105a 940e 184c 	CALL __PUTDP1
                 ; 0003 0324 		sect = clust2sect(clst);		/* Current sector */
00105c 940e 156d 	CALL SUBOPT_0x31
00105e d85b      	RCALL _clust2sect_G003
00105f 940e 14b6 	CALL SUBOPT_0x14
                 ; 0003 0325 		if (!sect) goto fe_abort;
001061 940e 14b1 	CALL SUBOPT_0x13
001063 940e 18b6 	CALL __CPD10
001065 f0e9      	BREQ _0x600DF
                 ; 0003 0326 		fs->csect = (BYTE)(ofs / 512);	/* Sector offset in the cluster */
001066 940e 16d9 	CALL SUBOPT_0x67
                +
001068 e0e0     +LDI R30 , LOW ( 0x200 )
001069 e0f2     +LDI R31 , HIGH ( 0x200 )
00106a e060     +LDI R22 , BYTE3 ( 0x200 )
00106b e070     +LDI R23 , BYTE4 ( 0x200 )
                 	__GETD1N 0x200
00106c 940e 1814 	CALL __DIVD21U
                +
00106e 01d8     +MOVW R26 , R16
00106f 9613     +ADIW R26 , 3
001070 93ec     +ST X , R30
                 	__PUTB1RNS 16,3
                 ; 0003 0327 		if (ofs % 512)
001071 940e 16de 	CALL SUBOPT_0x68
001073 70f1      	ANDI R31,HIGH(0x1FF)
001074 9730      	SBIW R30,0
001075 f059      	BREQ _0x600E1
                 ; 0003 0328 			fs->dsect = sect + fs->csect++;
001076 01d8      	MOVW R26,R16
001077 940e 166c 	CALL SUBOPT_0x58
001079 940e 14bb 	CALL SUBOPT_0x15
00107b 940e 1673 	CALL SUBOPT_0x59
                +
00107d 01d8     +MOVW R26 , R16
00107e 9698     +ADIW R26 , 40
00107f 940e 184c+CALL __PUTDP1
                 	__PUTD1RNS 16,40
                 ; 0003 0329 	}
                 _0x600E1:
                 ; 0003 032A 
                 ; 0003 032B 	return FR_OK;
                 _0x600D4:
001081 e0e0      	LDI  R30,LOW(0)
001082 c003      	RJMP _0x20C0006
                 ; 0003 032C 
                 ; 0003 032D fe_abort:
                 _0x600DF:
                 ; 0003 032E 	fs->flag = 0;
001083 01d8      	MOVW R26,R16
001084 940e 1683 	CALL SUBOPT_0x5C
                 ; 0003 032F 	return FR_DISK_ERR;
                 _0x20C0006:
001086 8119      	LDD  R17,Y+1
001087 8108      	LDD  R16,Y+0
001088 9666      	ADIW R28,22
001089 9508      	RET
                 ; 0003 0330 }
                 ; .FEND
                 ;#endif
                 ;
                 ;
                 ;
                 ;/*-----------------------------------------------------------------------*/
                 ;/* Create a Directroy Object                                             */
                 ;/*-----------------------------------------------------------------------*/
                 ;#if _USE_DIR
                 ;
                 ;FRESULT pf_opendir (
                 ; 0003 033B 	DIR *dj,			/* Pointer to directory object to create */
                 ; 0003 033C 	const char *path	/* Pointer to the directory path */
                 ; 0003 033D )
                 ; 0003 033E {
                 _pf_opendir:
                 ; .FSTART _pf_opendir
                 ; 0003 033F 	FRESULT res;
                 ; 0003 0340 	BYTE sp[12], dir[32];
                 ; 0003 0341 	FATFS *fs = FatFs;
                 ; 0003 0342 
                 ; 0003 0343 
                 ; 0003 0344 	if (!fs) {				/* Check file system */
00108a 93ba      	ST   -Y,R27
00108b 93aa      	ST   -Y,R26
00108c 97ac      	SBIW R28,44
00108d 940e 159a 	CALL SUBOPT_0x3A
                 ;	*dj -> Y+50
                 ;	*path -> Y+48
                 ;	res -> R17
                 ;	sp -> Y+36
                 ;	dir -> Y+4
                 ;	*fs -> R18,R19
00108f 2e02      	MOV  R0,R18
001090 2a03      	OR   R0,R19
001091 f411      	BRNE _0x600E2
                 ; 0003 0345 		res = FR_NOT_ENABLED;
001092 e016      	LDI  R17,LOW(6)
                 ; 0003 0346 	} else {
001093 c025      	RJMP _0x600E3
                 _0x600E2:
                 ; 0003 0347 		fs->buf = dir;
001094 940e 1641 	CALL SUBOPT_0x53
                 ; 0003 0348 		dj->fn = sp;
                +
001096 a9aa     +LDD R26 , Y + 50
001097 a9bb     +LDD R27 , Y + 50 + 1
001098 9612     +ADIW R26 , 2
001099 93ed     +ST X + , R30
00109a 93fc     +ST X , R31
                 	__PUTW1SNS 50,2
                 ; 0003 0349 		res = follow_path(dj, path);			/* Follow the path to the directory */
00109b 940e 16f8 	CALL SUBOPT_0x6C
00109d da81      	RCALL _follow_path_G003
00109e 2f1e      	MOV  R17,R30
                 ; 0003 034A 		if (res == FR_OK) {						/* Follow completed */
00109f 3010      	CPI  R17,0
0010a0 f4a9      	BRNE _0x600E4
                 ; 0003 034B 			if (dir[0]) {						/* It is not the root dir */
0010a1 81ec      	LDD  R30,Y+4
0010a2 30e0      	CPI  R30,0
0010a3 f061      	BREQ _0x600E5
                 ; 0003 034C 				if (dir[DIR_Attr] & AM_DIR) {	/* The object is a directory */
0010a4 85ef      	LDD  R30,Y+15
0010a5 71e0      	ANDI R30,LOW(0x10)
0010a6 f041      	BREQ _0x600E6
                 ; 0003 034D 					dj->sclust =
                 ; 0003 034E #if _FS_FAT32
                 ; 0003 034F 					((DWORD)LD_WORD(dir+DIR_FstClusHI) << 16) |
                 ; 0003 0350 #endif
                 ; 0003 0351 					LD_WORD(dir+DIR_FstClusLO);
0010a7 940e 164a 	CALL SUBOPT_0x54
                +
0010a9 a9aa     +LDD R26 , Y + 50
0010aa a9bb     +LDD R27 , Y + 50 + 1
0010ab 9614     +ADIW R26 , 4
0010ac 940e 184c+CALL __PUTDP1
                 	__PUTD1SNS 50,4
                 ; 0003 0352 				} else {						/* The object is not a directory */
0010ae c001      	RJMP _0x600E7
                 _0x600E6:
                 ; 0003 0353 					res = FR_NO_PATH;
0010af e014      	LDI  R17,LOW(4)
                 ; 0003 0354 				}
                 _0x600E7:
                 ; 0003 0355 			}
                 ; 0003 0356 			if (res == FR_OK)
                 _0x600E5:
0010b0 3010      	CPI  R17,0
0010b1 f421      	BRNE _0x600E8
                 ; 0003 0357 				res = dir_rewind(dj);			/* Rewind dir */
0010b2 a9aa      	LDD  R26,Y+50
0010b3 a9bb      	LDD  R27,Y+50+1
0010b4 d842      	RCALL _dir_rewind_G003
0010b5 2f1e      	MOV  R17,R30
                 ; 0003 0358 		}
                 _0x600E8:
                 ; 0003 0359 		if (res == FR_NO_FILE) res = FR_NO_PATH;
                 _0x600E4:
0010b6 3013      	CPI  R17,3
0010b7 f409      	BRNE _0x600E9
0010b8 e014      	LDI  R17,LOW(4)
                 ; 0003 035A 	}
                 _0x600E9:
                 _0x600E3:
                 ; 0003 035B 
                 ; 0003 035C 	return res;
0010b9 c036      	RJMP _0x20C0005
                 ; 0003 035D }
                 ; .FEND
                 ;
                 ;
                 ;
                 ;
                 ;/*-----------------------------------------------------------------------*/
                 ;/* Read Directory Entry in Sequense                                      */
                 ;/*-----------------------------------------------------------------------*/
                 ;
                 ;FRESULT pf_readdir (
                 ; 0003 0367 	DIR *dj,			/* Pointer to the open directory object */
                 ; 0003 0368 	FILINFO *fno		/* Pointer to file information to return */
                 ; 0003 0369 )
                 ; 0003 036A {
                 _pf_readdir:
                 ; .FSTART _pf_readdir
                 ; 0003 036B 	FRESULT res;
                 ; 0003 036C 	BYTE sp[12], dir[32];
                 ; 0003 036D 	FATFS *fs = FatFs;
                 ; 0003 036E 
                 ; 0003 036F 
                 ; 0003 0370 	if (!fs) {				/* Check file system */
0010ba 93ba      	ST   -Y,R27
0010bb 93aa      	ST   -Y,R26
0010bc 97ac      	SBIW R28,44
0010bd 940e 159a 	CALL SUBOPT_0x3A
                 ;	*dj -> Y+50
                 ;	*fno -> Y+48
                 ;	res -> R17
                 ;	sp -> Y+36
                 ;	dir -> Y+4
                 ;	*fs -> R18,R19
0010bf 2e02      	MOV  R0,R18
0010c0 2a03      	OR   R0,R19
0010c1 f411      	BRNE _0x600EA
                 ; 0003 0371 		res = FR_NOT_ENABLED;
0010c2 e016      	LDI  R17,LOW(6)
                 ; 0003 0372 	} else {
0010c3 c02c      	RJMP _0x600EB
                 _0x600EA:
                 ; 0003 0373 		fs->buf = dir;
0010c4 940e 1641 	CALL SUBOPT_0x53
                 ; 0003 0374 		dj->fn = sp;
                +
0010c6 a9aa     +LDD R26 , Y + 50
0010c7 a9bb     +LDD R27 , Y + 50 + 1
0010c8 9612     +ADIW R26 , 2
0010c9 93ed     +ST X + , R30
0010ca 93fc     +ST X , R31
                 	__PUTW1SNS 50,2
                 ; 0003 0375 		if (!fno) {
0010cb a9e8      	LDD  R30,Y+48
0010cc a9f9      	LDD  R31,Y+48+1
0010cd 9730      	SBIW R30,0
0010ce f431      	BRNE _0x600EC
                 ; 0003 0376 			res = dir_rewind(dj);
0010cf a9aa      	LDD  R26,Y+50
0010d0 a9bb      	LDD  R27,Y+50+1
0010d1 940e 08f7 	CALL _dir_rewind_G003
0010d3 2f1e      	MOV  R17,R30
                 ; 0003 0377 		} else {
0010d4 c01b      	RJMP _0x600ED
                 _0x600EC:
                 ; 0003 0378 			res = dir_read(dj);
0010d5 a9aa      	LDD  R26,Y+50
0010d6 a9bb      	LDD  R27,Y+50+1
0010d7 d92c      	RCALL _dir_read_G003
0010d8 2f1e      	MOV  R17,R30
                 ; 0003 0379 			if (res == FR_NO_FILE) {
0010d9 3013      	CPI  R17,3
0010da f429      	BRNE _0x600EE
                 ; 0003 037A 				dj->sect = 0;
0010db a9aa      	LDD  R26,Y+50
0010dc a9bb      	LDD  R27,Y+50+1
0010dd 940e 15c6 	CALL SUBOPT_0x40
                 ; 0003 037B 				res = FR_OK;
0010df e010      	LDI  R17,LOW(0)
                 ; 0003 037C 			}
                 ; 0003 037D 			if (res == FR_OK) {				/* A valid entry is found */
                 _0x600EE:
0010e0 3010      	CPI  R17,0
0010e1 f471      	BRNE _0x600EF
                 ; 0003 037E 				get_fileinfo(dj, fno);		/* Get the object information */
0010e2 940e 16f8 	CALL SUBOPT_0x6C
0010e4 d9d9      	RCALL _get_fileinfo_G003
                 ; 0003 037F 				res = dir_next(dj);			/* Increment index for next */
0010e5 a9aa      	LDD  R26,Y+50
0010e6 a9bb      	LDD  R27,Y+50+1
0010e7 d85f      	RCALL _dir_next_G003
0010e8 2f1e      	MOV  R17,R30
                 ; 0003 0380 				if (res == FR_NO_FILE) {
0010e9 3013      	CPI  R17,3
0010ea f429      	BRNE _0x600F0
                 ; 0003 0381 					dj->sect = 0;
0010eb a9aa      	LDD  R26,Y+50
0010ec a9bb      	LDD  R27,Y+50+1
0010ed 940e 15c6 	CALL SUBOPT_0x40
                 ; 0003 0382 					res = FR_OK;
0010ef e010      	LDI  R17,LOW(0)
                 ; 0003 0383 				}
                 ; 0003 0384 			}
                 _0x600F0:
                 ; 0003 0385 		}
                 _0x600EF:
                 _0x600ED:
                 ; 0003 0386 	}
                 _0x600EB:
                 ; 0003 0387 
                 ; 0003 0388 	return res;
                 _0x20C0005:
0010f0 2fe1      	MOV  R30,R17
0010f1 940e 18d7 	CALL __LOADLOCR4
0010f3 96e4      	ADIW R28,52
0010f4 9508      	RET
                 ; 0003 0389 }
                 ; .FEND
                 ;
                 ;
                 ;/*-----------------------------------------------------------------------*/
                 ;/* Rename file inside provided directory                                      */
                 ;/*-----------------------------------------------------------------------*/
                 ;FRESULT pf_rename (
                 ; 0003 0390     const char* dirname,
                 ; 0003 0391     const char* oldname,
                 ; 0003 0392     const char* newname
                 ; 0003 0393 )
                 ; 0003 0394 {
                 _pf_rename:
                 ; .FSTART _pf_rename
                 ; 0003 0395     FRESULT res;
                 ; 0003 0396     FILINFO fno;
                 ; 0003 0397     DIR dir;
                 ; 0003 0398     int i,j;
                 ; 0003 0399     BYTE rwbuf[512];
                 ; 0003 039A     //open directory structure
                 ; 0003 039B     res = pf_opendir(&dir, dirname);
0010f5 93ba      	ST   -Y,R27
0010f6 93aa      	ST   -Y,R26
0010f7 97a6      	SBIW R28,38
0010f8 50d2      	SUBI R29,2
0010f9 940e 18ce 	CALL __SAVELOCR6
                 ;	*dirname -> Y+560
                 ;	*oldname -> Y+558
                 ;	*newname -> Y+556
                 ;	res -> R17
                 ;	fno -> Y+534
                 ;	dir -> Y+518
                 ;	i -> R18,R19
                 ;	j -> R20,R21
                 ;	rwbuf -> Y+6
0010fb 940e 16ff 	CALL SUBOPT_0x6D
0010fd 940e 1705 	CALL SUBOPT_0x6E
                 ; 0003 039C     if (res == FR_OK) {
0010ff f009      	BREQ PC+2
001100 c0a4      	RJMP _0x600F1
                 ; 0003 039D         i = strlen(oldname);//save old flename length
001101 940e 1710 	CALL SUBOPT_0x6F
001103 940e 1365 	CALL _strlen
001105 019f      	MOVW R18,R30
                 ; 0003 039E         for (;;) {
                 _0x600F3:
                 ; 0003 039F             res = pf_readdir(&dir, &fno);
001106 940e 16ff 	CALL SUBOPT_0x6D
001108 940e 1717 	CALL SUBOPT_0x70
                 ; 0003 03A0             if (res != FR_OK || fno.fname[0] == 0){
00110a f431      	BRNE _0x600F6
00110b 01fe      	MOVW R30,R28
00110c 5eea      	SUBI R30,LOW(-(534))
00110d 4ffd      	SBCI R31,HIGH(-(534))
00110e 85a1      	LDD  R26,Z+9
00110f 30a0      	CPI  R26,LOW(0x0)
001110 f411      	BRNE _0x600F5
                 _0x600F6:
                 ; 0003 03A1                 res=FR_NO_FILE;
001111 e013      	LDI  R17,LOW(3)
                 ; 0003 03A2                 break;
001112 c069      	RJMP _0x600F4
                 ; 0003 03A3             }
                 ; 0003 03A4             for(j=0;j<i;j++){//check compare the oldname chars to filename read from directory
                 _0x600F5:
                +
001113 e040     +LDI R20 , LOW ( 0 )
001114 e050     +LDI R21 , HIGH ( 0 )
                 	__GETWRN 20,21,0
                 _0x600F9:
                +
001115 1742     +CP R20 , R18
001116 0753     +CPC R21 , R19
                 	__CPWRR 20,21,18,19
001117 f474      	BRGE _0x600FA
                 ; 0003 03A5                 if(fno.fname[j] != oldname[j]){
001118 940e 171f 	CALL SUBOPT_0x71
00111a 940e 1710 	CALL SUBOPT_0x6F
00111c 0fae      	ADD  R26,R30
00111d 1fbf      	ADC  R27,R31
00111e 91ec      	LD   R30,X
00111f 15e1      	CP   R30,R1
001120 f011      	BREQ _0x600FB
                 ; 0003 03A6                     res=FR_NO_FILE;
001121 e013      	LDI  R17,LOW(3)
                 ; 0003 03A7                     break;//if not match -> read next filename in directory
001122 c003      	RJMP _0x600FA
                 ; 0003 03A8                 }
                 ; 0003 03A9             }
                 _0x600FB:
                +
001123 5f4f     +SUBI R20 , LOW ( - 1 )
001124 4f5f     +SBCI R21 , HIGH ( - 1 )
                 	__ADDWRN 20,21,1
001125 cfef      	RJMP _0x600F9
                 _0x600FA:
                 ; 0003 03AA             //on old filename part match, read the filenames sector to buffer[512] and replace the old filename with new ...
                 ; 0003 03AB             if(i==j){
                +
001126 1742     +CP R20 , R18
001127 0753     +CPC R21 , R19
                 	__CPWRR 20,21,18,19
001128 f009      	BREQ PC+2
001129 c050      	RJMP _0x600FC
                 ; 0003 03AC                //read sector on found filename
                 ; 0003 03AD                res = disk_readp(rwbuf,dir.sect,0,512);
00112a 01fe      	MOVW R30,R28
00112b 9636      	ADIW R30,6
00112c 93fa      	ST   -Y,R31
00112d 93ea      	ST   -Y,R30
00112e 940e 1728 	CALL SUBOPT_0x72
001130 940e 1872 	CALL __PUTPARD1
001132 940e 144f 	CALL SUBOPT_0x5
001134 e0a0      	LDI  R26,LOW(512)
001135 e0b2      	LDI  R27,HIGH(512)
001136 940e 06e0 	CALL _disk_readp
001138 2f1e      	MOV  R17,R30
                 ; 0003 03AE                if (res != FR_OK) break;
001139 3010      	CPI  R17,0
00113a f009      	BREQ _0x600FD
00113b c040      	RJMP _0x600F4
                 ; 0003 03AF                i = strlen(newname);//save new flename length
                 _0x600FD:
00113c 940e 1730 	CALL SUBOPT_0x73
00113e 940e 1365 	CALL _strlen
001140 019f      	MOVW R18,R30
                 ; 0003 03B0                //replace the old name with new on accoding to index of filename in directory sector
                 ; 0003 03B1                for(j=0;j<11;j++){
                +
001141 e040     +LDI R20 , LOW ( 0 )
001142 e050     +LDI R21 , HIGH ( 0 )
                 	__GETWRN 20,21,0
                 _0x600FF:
                +
001143 304b     +CPI R20 , LOW ( 11 )
001144 e0e0     +LDI R30 , HIGH ( 11 )
001145 075e     +CPC R21 , R30
                 	__CPWRN 20,21,11
001146 f4cc      	BRGE _0x60100
                 ; 0003 03B2                   if(j<i){
                +
001147 1742     +CP R20 , R18
001148 0753     +CPC R21 , R19
                 	__CPWRR 20,21,18,19
001149 f46c      	BRGE _0x60101
                 ; 0003 03B3                     rwbuf[((dir.index-1)*32)%512+j]=newname[j];
00114a 940e 1737 	CALL SUBOPT_0x74
00114c 0fea      	ADD  R30,R26
00114d 1ffb      	ADC  R31,R27
00114e 01bf      	MOVW R22,R30
00114f 01fa      	MOVW R30,R20
001150 940e 1730 	CALL SUBOPT_0x73
001152 0fae      	ADD  R26,R30
001153 1fbf      	ADC  R27,R31
001154 91ec      	LD   R30,X
001155 01db      	MOVW R26,R22
001156 c005      	RJMP _0x60116
                 ; 0003 03B4                   }
                 ; 0003 03B5                   else{
                 _0x60101:
                 ; 0003 03B6                     rwbuf[((dir.index-1)*32)%512+j]=' ';//fill spaces rest of chars
001157 940e 1737 	CALL SUBOPT_0x74
001159 0fae      	ADD  R26,R30
00115a 1fbf      	ADC  R27,R31
00115b e2e0      	LDI  R30,LOW(32)
                 _0x60116:
00115c 93ec      	ST   X,R30
                 ; 0003 03B7                   }
                 ; 0003 03B8                }
                +
00115d 5f4f     +SUBI R20 , LOW ( - 1 )
00115e 4f5f     +SBCI R21 , HIGH ( - 1 )
                 	__ADDWRN 20,21,1
00115f cfe3      	RJMP _0x600FF
                 _0x60100:
                 ; 0003 03B9                //write the sector with new filename
                 ; 0003 03BA                res = disk_writep(0,dir.sect);
001160 940e 144f 	CALL SUBOPT_0x5
001162 940e 1728 	CALL SUBOPT_0x72
001164 01df      	MOVW R26,R30
001165 01cb      	MOVW R24,R22
001166 940e 1748 	CALL SUBOPT_0x75
                 ; 0003 03BB                if (res != FR_OK) break;
001168 f499      	BRNE _0x600F4
                 ; 0003 03BC                res = disk_writep(rwbuf,512);
001169 01fe      	MOVW R30,R28
00116a 9636      	ADIW R30,6
00116b 93fa      	ST   -Y,R31
00116c 93ea      	ST   -Y,R30
00116d 940e 151e 	CALL SUBOPT_0x24
00116f 940e 1748 	CALL SUBOPT_0x75
                 ; 0003 03BD                if (res != FR_OK) break;
001171 f451      	BRNE _0x600F4
                 ; 0003 03BE                res = disk_writep(0,0);
001172 940e 144f 	CALL SUBOPT_0x5
001174 940e 1519 	CALL SUBOPT_0x23
001176 940e 1748 	CALL SUBOPT_0x75
                 ; 0003 03BF                if (res != FR_OK) break;
001178 f419      	BRNE _0x600F4
                 ; 0003 03C0                break;//exit for loop
001179 c002      	RJMP _0x600F4
                 ; 0003 03C1             }
                 ; 0003 03C2             else{
                 _0x600FC:
                 ; 0003 03C3                res=FR_NO_FILE;
00117a e013      	LDI  R17,LOW(3)
                 ; 0003 03C4             }
                 ; 0003 03C5         }
00117b cf8a      	RJMP _0x600F3
                 _0x600F4:
                 ; 0003 03C6        if (res != FR_OK) return res;
00117c 3010      	CPI  R17,0
00117d f539      	BRNE _0x20C0004
                 ; 0003 03C7         //open the dir and read/check the new filename is found
                 ; 0003 03C8        res = pf_opendir(&dir, dirname);
00117e 940e 16ff 	CALL SUBOPT_0x6D
001180 940e 1705 	CALL SUBOPT_0x6E
                 ; 0003 03C9        if (res != FR_OK) return res;//break;
001182 f511      	BRNE _0x20C0004
                 ; 0003 03CA        //read filenames in directory and compare to new filename
                 ; 0003 03CB        for(;;){
                 _0x6010A:
                 ; 0003 03CC            res = pf_readdir(&dir, &fno);
001183 940e 16ff 	CALL SUBOPT_0x6D
001185 940e 1717 	CALL SUBOPT_0x70
                 ; 0003 03CD            if (res != FR_OK || fno.fname[0] == 0) break;
001187 f431      	BRNE _0x6010D
001188 01fe      	MOVW R30,R28
001189 5eea      	SUBI R30,LOW(-(534))
00118a 4ffd      	SBCI R31,HIGH(-(534))
00118b 85a1      	LDD  R26,Z+9
00118c 30a0      	CPI  R26,LOW(0x0)
00118d f409      	BRNE _0x6010C
                 _0x6010D:
00118e c016      	RJMP _0x6010B
                 ; 0003 03CE            for(j=0;j<i;j++){
                 _0x6010C:
                +
00118f e040     +LDI R20 , LOW ( 0 )
001190 e050     +LDI R21 , HIGH ( 0 )
                 	__GETWRN 20,21,0
                 _0x60110:
                +
001191 1742     +CP R20 , R18
001192 0753     +CPC R21 , R19
                 	__CPWRR 20,21,18,19
001193 f474      	BRGE _0x60111
                 ; 0003 03CF                 if(fno.fname[j] != newname[j]){
001194 940e 171f 	CALL SUBOPT_0x71
001196 940e 1730 	CALL SUBOPT_0x73
001198 0fae      	ADD  R26,R30
001199 1fbf      	ADC  R27,R31
00119a 91ec      	LD   R30,X
00119b 15e1      	CP   R30,R1
00119c f011      	BREQ _0x60112
                 ; 0003 03D0                     res = FR_NO_FILE;
00119d e013      	LDI  R17,LOW(3)
                 ; 0003 03D1                     break;//read next filename if not match
00119e c003      	RJMP _0x60111
                 ; 0003 03D2                     //return FR_NO_FILE;
                 ; 0003 03D3                 }
                 ; 0003 03D4            }
                 _0x60112:
                +
00119f 5f4f     +SUBI R20 , LOW ( - 1 )
0011a0 4f5f     +SBCI R21 , HIGH ( - 1 )
                 	__ADDWRN 20,21,1
0011a1 cfef      	RJMP _0x60110
                 _0x60111:
                 ; 0003 03D5            if(i==j){
                +
0011a2 1742     +CP R20 , R18
0011a3 0753     +CPC R21 , R19
                 	__CPWRR 20,21,18,19
0011a4 f6f1      	BRNE _0x6010A
                 ; 0003 03D6               break;//exit for loop on match read new filename
                 ; 0003 03D7            }
                 ; 0003 03D8        }
                 _0x6010B:
                 ; 0003 03D9     }
                 ; 0003 03DA 
                 ; 0003 03DB     return res;
                 _0x600F1:
                 _0x20C0004:
0011a5 2fe1      	MOV  R30,R17
0011a6 940e 18d5 	CALL __LOADLOCR6
0011a8 96e2      	ADIW R28,50
0011a9 5fde      	SUBI R29,-2
0011aa 9508      	RET
                 ; 0003 03DC }
                 ; .FEND
                 ;#endif /* _USE_DIR */
                 ;
                 	#ifndef __SLEEP_DEFINED__
                 	#endif
                 
                 	.CSEG
                 _putchar:
                 ; .FSTART _putchar
0011ab 93aa      	ST   -Y,R26
                 putchar0:
0011ac 9b5d           sbis usr,udre
0011ad cffe           rjmp putchar0
0011ae 81e8           ld   r30,y
0011af b9ec           out  udr,r30
0011b0 940c 1427 	JMP  _0x20C0001
                 ; .FEND
                 _put_usart_G100:
                 ; .FSTART _put_usart_G100
0011b2 93ba      	ST   -Y,R27
0011b3 93aa      	ST   -Y,R26
0011b4 81aa      	LDD  R26,Y+2
0011b5 dff5      	RCALL _putchar
0011b6 81a8      	LD   R26,Y
0011b7 81b9      	LDD  R27,Y+1
0011b8 91ed      	LD   R30,X+
0011b9 91fd      	LD   R31,X+
0011ba 9631      	ADIW R30,1
0011bb 93fe      	ST   -X,R31
0011bc 93ee      	ST   -X,R30
0011bd 940c 13e6 	JMP  _0x20C0002
                 ; .FEND
                 __print_G100:
                 ; .FSTART __print_G100
0011bf 93ba      	ST   -Y,R27
0011c0 93aa      	ST   -Y,R26
0011c1 9728      	SBIW R28,8
0011c2 940e 18ce 	CALL __SAVELOCR6
0011c4 e010      	LDI  R17,0
0011c5 85ae      	LDD  R26,Y+14
0011c6 85bf      	LDD  R27,Y+14+1
0011c7 940e 1592 	CALL SUBOPT_0x38
                 _0x2000016:
0011c9 01de      	MOVW R26,R28
0011ca 9654      	ADIW R26,20
0011cb 940e 174d 	CALL SUBOPT_0x76
                +
0011cd bf6b     +OUT RAMPZ , R22
0011ce 91e6     +ELPM R30 , Z
                 	__GETBRPF 30
0011cf 2f2e      	MOV  R18,R30
0011d0 30e0      	CPI  R30,0
0011d1 f409      	BRNE PC+2
0011d2 c12a      	RJMP _0x2000018
0011d3 2fe1      	MOV  R30,R17
0011d4 30e0      	CPI  R30,0
0011d5 f439      	BRNE _0x200001C
0011d6 3225      	CPI  R18,37
0011d7 f411      	BRNE _0x200001D
0011d8 e011      	LDI  R17,LOW(1)
0011d9 c002      	RJMP _0x200001E
                 _0x200001D:
0011da 940e 1753 	CALL SUBOPT_0x77
                 _0x200001E:
0011dc c11f      	RJMP _0x200001B
                 _0x200001C:
0011dd 30e1      	CPI  R30,LOW(0x1)
0011de f4a9      	BRNE _0x200001F
0011df 3225      	CPI  R18,37
0011e0 f419      	BRNE _0x2000020
0011e1 940e 1753 	CALL SUBOPT_0x77
0011e3 c117      	RJMP _0x20000CC
                 _0x2000020:
0011e4 e012      	LDI  R17,LOW(2)
0011e5 e040      	LDI  R20,LOW(0)
0011e6 e000      	LDI  R16,LOW(0)
0011e7 322d      	CPI  R18,45
0011e8 f411      	BRNE _0x2000021
0011e9 e001      	LDI  R16,LOW(1)
0011ea c111      	RJMP _0x200001B
                 _0x2000021:
0011eb 322b      	CPI  R18,43
0011ec f411      	BRNE _0x2000022
0011ed e24b      	LDI  R20,LOW(43)
0011ee c10d      	RJMP _0x200001B
                 _0x2000022:
0011ef 3220      	CPI  R18,32
0011f0 f411      	BRNE _0x2000023
0011f1 e240      	LDI  R20,LOW(32)
0011f2 c109      	RJMP _0x200001B
                 _0x2000023:
0011f3 c002      	RJMP _0x2000024
                 _0x200001F:
0011f4 30e2      	CPI  R30,LOW(0x2)
0011f5 f439      	BRNE _0x2000025
                 _0x2000024:
0011f6 e050      	LDI  R21,LOW(0)
0011f7 e013      	LDI  R17,LOW(3)
0011f8 3320      	CPI  R18,48
0011f9 f411      	BRNE _0x2000026
0011fa 6800      	ORI  R16,LOW(128)
0011fb c100      	RJMP _0x200001B
                 _0x2000026:
0011fc c003      	RJMP _0x2000027
                 _0x2000025:
0011fd 30e3      	CPI  R30,LOW(0x3)
0011fe f009      	BREQ PC+2
0011ff c0fc      	RJMP _0x200001B
                 _0x2000027:
001200 3320      	CPI  R18,48
001201 f010      	BRLO _0x200002A
001202 332a      	CPI  R18,58
001203 f008      	BRLO _0x200002B
                 _0x200002A:
001204 c007      	RJMP _0x2000029
                 _0x200002B:
001205 e0aa      	LDI  R26,LOW(10)
001206 9f5a      	MUL  R21,R26
001207 2d50      	MOV  R21,R0
001208 2fe2      	MOV  R30,R18
001209 53e0      	SUBI R30,LOW(48)
00120a 0f5e      	ADD  R21,R30
00120b c0f0      	RJMP _0x200001B
                 _0x2000029:
00120c 2fe2      	MOV  R30,R18
00120d 36e3      	CPI  R30,LOW(0x63)
00120e f449      	BRNE _0x200002F
00120f 940e 175a 	CALL SUBOPT_0x78
001211 89ea      	LDD  R30,Y+18
001212 89fb      	LDD  R31,Y+18+1
001213 81a4      	LDD  R26,Z+4
001214 93aa      	ST   -Y,R26
001215 940e 1760 	CALL SUBOPT_0x79
001217 c0e3      	RJMP _0x2000030
                 _0x200002F:
001218 37e3      	CPI  R30,LOW(0x73)
001219 f461      	BRNE _0x2000032
00121a 940e 175a 	CALL SUBOPT_0x78
00121c 940e 1766 	CALL SUBOPT_0x7A
00121e 83ee      	STD  Y+6,R30
00121f 83ff      	STD  Y+6+1,R31
001220 81ae      	LDD  R26,Y+6
001221 81bf      	LDD  R27,Y+6+1
001222 940e 1365 	CALL _strlen
001224 2f1e      	MOV  R17,R30
001225 c011      	RJMP _0x2000033
                 _0x2000032:
001226 37e0      	CPI  R30,LOW(0x70)
001227 f499      	BRNE _0x2000035
001228 940e 175a 	CALL SUBOPT_0x78
00122a 89aa      	LDD  R26,Y+18
00122b 89bb      	LDD  R27,Y+18+1
00122c 9614      	ADIW R26,4
00122d 940e 1841 	CALL __GETD1P
00122f 940e 14b6 	CALL SUBOPT_0x14
001231 940e 14bb 	CALL SUBOPT_0x15
001233 940e 1371 	CALL _strlenf
001235 2f1e      	MOV  R17,R30
001236 6008      	ORI  R16,LOW(8)
                 _0x2000033:
001237 6002      	ORI  R16,LOW(2)
001238 770f      	ANDI R16,LOW(127)
001239 e030      	LDI  R19,LOW(0)
00123a c03a      	RJMP _0x2000036
                 _0x2000035:
00123b 36e4      	CPI  R30,LOW(0x64)
00123c f011      	BREQ _0x2000039
00123d 36e9      	CPI  R30,LOW(0x69)
00123e f411      	BRNE _0x200003A
                 _0x2000039:
00123f 6004      	ORI  R16,LOW(4)
001240 c002      	RJMP _0x200003B
                 _0x200003A:
001241 37e5      	CPI  R30,LOW(0x75)
001242 f441      	BRNE _0x200003C
                 _0x200003B:
                +
001243 e5e0     +LDI R30 , LOW ( 2 * _tbl10_G100 + ( 0 ) )
001244 e0f1     +LDI R31 , HIGH ( 2 * _tbl10_G100 + ( 0 ) )
001245 e060     +LDI R22 , BYTE3 ( 2 * _tbl10_G100 + ( 0 ) )
001246 e070     +LDI R23 , BYTE4 ( 2 * _tbl10_G100 + ( 0 ) )
                 	__POINTD1FN _tbl10_G100,0
001247 940e 14b6 	CALL SUBOPT_0x14
001249 e015      	LDI  R17,LOW(5)
00124a c00e      	RJMP _0x200003D
                 _0x200003C:
00124b 35e8      	CPI  R30,LOW(0x58)
00124c f411      	BRNE _0x200003F
00124d 6008      	ORI  R16,LOW(8)
00124e c003      	RJMP _0x2000040
                 _0x200003F:
00124f 37e8      	CPI  R30,LOW(0x78)
001250 f009      	BREQ PC+2
001251 c0a9      	RJMP _0x2000071
                 _0x2000040:
                +
001252 e5ea     +LDI R30 , LOW ( 2 * _tbl16_G100 + ( 0 ) )
001253 e0f1     +LDI R31 , HIGH ( 2 * _tbl16_G100 + ( 0 ) )
001254 e060     +LDI R22 , BYTE3 ( 2 * _tbl16_G100 + ( 0 ) )
001255 e070     +LDI R23 , BYTE4 ( 2 * _tbl16_G100 + ( 0 ) )
                 	__POINTD1FN _tbl16_G100,0
001256 940e 14b6 	CALL SUBOPT_0x14
001258 e014      	LDI  R17,LOW(4)
                 _0x200003D:
001259 ff02      	SBRS R16,2
00125a c014      	RJMP _0x2000042
00125b 940e 175a 	CALL SUBOPT_0x78
00125d 940e 1766 	CALL SUBOPT_0x7A
00125f 87ec      	STD  Y+12,R30
001260 87fd      	STD  Y+12+1,R31
001261 85ad      	LDD  R26,Y+13
001262 23aa      	TST  R26
001263 f42a      	BRPL _0x2000043
001264 940e 17a6 	CALL __ANEGW1
001266 87ec      	STD  Y+12,R30
001267 87fd      	STD  Y+12+1,R31
001268 e24d      	LDI  R20,LOW(45)
                 _0x2000043:
001269 3040      	CPI  R20,0
00126a f011      	BREQ _0x2000044
00126b 5f1f      	SUBI R17,-LOW(1)
00126c c001      	RJMP _0x2000045
                 _0x2000044:
00126d 7f0b      	ANDI R16,LOW(251)
                 _0x2000045:
00126e c006      	RJMP _0x2000046
                 _0x2000042:
00126f 940e 175a 	CALL SUBOPT_0x78
001271 940e 1766 	CALL SUBOPT_0x7A
001273 87ec      	STD  Y+12,R30
001274 87fd      	STD  Y+12+1,R31
                 _0x2000046:
                 _0x2000036:
001275 fd00      	SBRC R16,0
001276 c011      	RJMP _0x2000047
                 _0x2000048:
001277 1715      	CP   R17,R21
001278 f478      	BRSH _0x200004A
001279 ff07      	SBRS R16,7
00127a c008      	RJMP _0x200004B
00127b ff02      	SBRS R16,2
00127c c004      	RJMP _0x200004C
00127d 7f0b      	ANDI R16,LOW(251)
00127e 2f24      	MOV  R18,R20
00127f 5011      	SUBI R17,LOW(1)
001280 c001      	RJMP _0x200004D
                 _0x200004C:
001281 e320      	LDI  R18,LOW(48)
                 _0x200004D:
001282 c001      	RJMP _0x200004E
                 _0x200004B:
001283 e220      	LDI  R18,LOW(32)
                 _0x200004E:
001284 940e 1753 	CALL SUBOPT_0x77
001286 5051      	SUBI R21,LOW(1)
001287 cfef      	RJMP _0x2000048
                 _0x200004A:
                 _0x2000047:
001288 2f31      	MOV  R19,R17
001289 ff01      	SBRS R16,1
00128a c018      	RJMP _0x200004F
                 _0x2000050:
00128b 3030      	CPI  R19,0
00128c f0a9      	BREQ _0x2000052
00128d ff03      	SBRS R16,3
00128e c007      	RJMP _0x2000053
00128f 01de      	MOVW R26,R28
001290 9616      	ADIW R26,6
001291 940e 174d 	CALL SUBOPT_0x76
                +
001293 bf6b     +OUT RAMPZ , R22
001294 9126     +ELPM R18 , Z
                 	__GETBRPF 18
001295 c005      	RJMP _0x2000054
                 _0x2000053:
001296 81ae      	LDD  R26,Y+6
001297 81bf      	LDD  R27,Y+6+1
001298 912d      	LD   R18,X+
001299 83ae      	STD  Y+6,R26
00129a 83bf      	STD  Y+6+1,R27
                 _0x2000054:
00129b 940e 1753 	CALL SUBOPT_0x77
00129d 3050      	CPI  R21,0
00129e f009      	BREQ _0x2000055
00129f 5051      	SUBI R21,LOW(1)
                 _0x2000055:
0012a0 5031      	SUBI R19,LOW(1)
0012a1 cfe9      	RJMP _0x2000050
                 _0x2000052:
0012a2 c04e      	RJMP _0x2000056
                 _0x200004F:
                 _0x2000058:
0012a3 e320      	LDI  R18,LOW(48)
0012a4 940e 14b1 	CALL SUBOPT_0x13
0012a6 940e 1856 	CALL __GETW1PF
0012a8 87ea      	STD  Y+10,R30
0012a9 87fb      	STD  Y+10+1,R31
0012aa 940e 14b1 	CALL SUBOPT_0x13
                +
0012ac 5fee     +SUBI R30 , LOW ( - 2 )
0012ad 4fff     +SBCI R31 , HIGH ( - 2 )
0012ae 4f6f     +SBCI R22 , BYTE3 ( - 2 )
0012af 4f7f     +SBCI R23 , BYTE4 ( - 2 )
                 	__ADDD1N 2
0012b0 940e 14b6 	CALL SUBOPT_0x14
                 _0x200005A:
0012b2 85ea      	LDD  R30,Y+10
0012b3 85fb      	LDD  R31,Y+10+1
0012b4 85ac      	LDD  R26,Y+12
0012b5 85bd      	LDD  R27,Y+12+1
0012b6 17ae      	CP   R26,R30
0012b7 07bf      	CPC  R27,R31
0012b8 f050      	BRLO _0x200005C
0012b9 5f2f      	SUBI R18,-LOW(1)
0012ba 85aa      	LDD  R26,Y+10
0012bb 85bb      	LDD  R27,Y+10+1
0012bc 85ec      	LDD  R30,Y+12
0012bd 85fd      	LDD  R31,Y+12+1
0012be 1bea      	SUB  R30,R26
0012bf 0bfb      	SBC  R31,R27
0012c0 87ec      	STD  Y+12,R30
0012c1 87fd      	STD  Y+12+1,R31
0012c2 cfef      	RJMP _0x200005A
                 _0x200005C:
0012c3 332a      	CPI  R18,58
0012c4 f028      	BRLO _0x200005D
0012c5 ff03      	SBRS R16,3
0012c6 c002      	RJMP _0x200005E
0012c7 5f29      	SUBI R18,-LOW(7)
0012c8 c001      	RJMP _0x200005F
                 _0x200005E:
0012c9 5d29      	SUBI R18,-LOW(39)
                 _0x200005F:
                 _0x200005D:
0012ca fd04      	SBRC R16,4
0012cb c01a      	RJMP _0x2000061
0012cc 3321      	CPI  R18,49
0012cd f420      	BRSH _0x2000063
0012ce 85aa      	LDD  R26,Y+10
0012cf 85bb      	LDD  R27,Y+10+1
0012d0 9711      	SBIW R26,1
0012d1 f409      	BRNE _0x2000062
                 _0x2000063:
0012d2 c009      	RJMP _0x20000CD
                 _0x2000062:
0012d3 1753      	CP   R21,R19
0012d4 f010      	BRLO _0x2000067
0012d5 ff00      	SBRS R16,0
0012d6 c001      	RJMP _0x2000068
                 _0x2000067:
0012d7 c013      	RJMP _0x2000066
                 _0x2000068:
0012d8 e220      	LDI  R18,LOW(32)
0012d9 ff07      	SBRS R16,7
0012da c00b      	RJMP _0x2000069
0012db e320      	LDI  R18,LOW(48)
                 _0x20000CD:
0012dc 6100      	ORI  R16,LOW(16)
0012dd ff02      	SBRS R16,2
0012de c007      	RJMP _0x200006A
0012df 7f0b      	ANDI R16,LOW(251)
0012e0 934a      	ST   -Y,R20
0012e1 940e 1760 	CALL SUBOPT_0x79
0012e3 3050      	CPI  R21,0
0012e4 f009      	BREQ _0x200006B
0012e5 5051      	SUBI R21,LOW(1)
                 _0x200006B:
                 _0x200006A:
                 _0x2000069:
                 _0x2000061:
0012e6 940e 1753 	CALL SUBOPT_0x77
0012e8 3050      	CPI  R21,0
0012e9 f009      	BREQ _0x200006C
0012ea 5051      	SUBI R21,LOW(1)
                 _0x200006C:
                 _0x2000066:
0012eb 5031      	SUBI R19,LOW(1)
0012ec 85aa      	LDD  R26,Y+10
0012ed 85bb      	LDD  R27,Y+10+1
0012ee 9712      	SBIW R26,2
0012ef f008      	BRLO _0x2000059
0012f0 cfb2      	RJMP _0x2000058
                 _0x2000059:
                 _0x2000056:
0012f1 ff00      	SBRS R16,0
0012f2 c008      	RJMP _0x200006D
                 _0x200006E:
0012f3 3050      	CPI  R21,0
0012f4 f031      	BREQ _0x2000070
0012f5 5051      	SUBI R21,LOW(1)
0012f6 e2e0      	LDI  R30,LOW(32)
0012f7 93ea      	ST   -Y,R30
0012f8 940e 1760 	CALL SUBOPT_0x79
0012fa cff8      	RJMP _0x200006E
                 _0x2000070:
                 _0x200006D:
                 _0x2000071:
                 _0x2000030:
                 _0x20000CC:
0012fb e010      	LDI  R17,LOW(0)
                 _0x200001B:
0012fc cecc      	RJMP _0x2000016
                 _0x2000018:
0012fd 85ae      	LDD  R26,Y+14
0012fe 85bf      	LDD  R27,Y+14+1
0012ff 940e 183d 	CALL __GETW1P
                 _0x20C0003:
001301 940e 18d5 	CALL __LOADLOCR6
001303 9668      	ADIW R28,24
001304 9508      	RET
                 ; .FEND
                 _printf:
                 ; .FSTART _printf
001305 92ff      	PUSH R15
001306 2ef8      	MOV  R15,R24
001307 9726      	SBIW R28,6
001308 931a      	ST   -Y,R17
001309 930a      	ST   -Y,R16
00130a 01de      	MOVW R26,R28
00130b 9614      	ADIW R26,4
00130c 940e 1784 	CALL __ADDW2R15
00130e 018d      	MOVW R16,R26
00130f e0e0      	LDI  R30,LOW(0)
001310 83ec      	STD  Y+4,R30
001311 83ed      	STD  Y+4+1,R30
001312 83ee      	STD  Y+6,R30
001313 83ef      	STD  Y+6+1,R30
001314 01de      	MOVW R26,R28
001315 9618      	ADIW R26,8
001316 940e 1784 	CALL __ADDW2R15
001318 940e 1841 	CALL __GETD1P
00131a 940e 1872 	CALL __PUTPARD1
00131c 931a      	ST   -Y,R17
00131d 930a      	ST   -Y,R16
00131e ebe2      	LDI  R30,LOW(_put_usart_G100)
00131f e1f1      	LDI  R31,HIGH(_put_usart_G100)
001320 93fa      	ST   -Y,R31
001321 93ea      	ST   -Y,R30
001322 01de      	MOVW R26,R28
001323 961a      	ADIW R26,10
001324 de9a      	RCALL __print_G100
001325 8119      	LDD  R17,Y+1
001326 8108      	LDD  R16,Y+0
001327 9628      	ADIW R28,8
001328 90ff      	POP  R15
001329 9508      	RET
                 ; .FEND
                 
                 	.CSEG
                 _itoa:
                 ; .FSTART _itoa
00132a 93ba      	ST   -Y,R27
00132b 93aa      	ST   -Y,R26
00132c 91a9          ld   r26,y+
00132d 91b9          ld   r27,y+
00132e 91e9          ld   r30,y+
00132f 91f9          ld   r31,y+
001330 9630          adiw r30,0
001331 f42a          brpl __itoa0
001332 95e0          com  r30
001333 95f0          com  r31
001334 9631          adiw r30,1
001335 e26d          ldi  r22,'-'
001336 936d          st   x+,r22
                 __itoa0:
001337 94e8          clt
001338 e180          ldi  r24,low(10000)
001339 e297          ldi  r25,high(10000)
00133a d00d          rcall __itoa1
00133b ee88          ldi  r24,low(1000)
00133c e093          ldi  r25,high(1000)
00133d d00a          rcall __itoa1
00133e e684          ldi  r24,100
00133f 2799          clr  r25
001340 d007          rcall __itoa1
001341 e08a          ldi  r24,10
001342 d005          rcall __itoa1
001343 2f6e          mov  r22,r30
001344 d010          rcall __itoa5
001345 2766          clr  r22
001346 936c          st   x,r22
001347 9508          ret
                 
                 __itoa1:
001348 2766          clr	 r22
                 __itoa2:
001349 17e8          cp   r30,r24
00134a 07f9          cpc  r31,r25
00134b f020          brlo __itoa3
00134c 9563          inc  r22
00134d 1be8          sub  r30,r24
00134e 0bf9          sbc  r31,r25
00134f f7c9          brne __itoa2
                 __itoa3:
001350 2366          tst  r22
001351 f411          brne __itoa4
001352 f016          brts __itoa5
001353 9508          ret
                 __itoa4:
001354 9468          set
                 __itoa5:
001355 5d60          subi r22,-0x30
001356 936d          st   x+,r22
001357 9508          ret
                 ; .FEND
                 
                 	.DSEG
                 
                 	.CSEG
                 
                 	.CSEG
                 _strcpy:
                 ; .FSTART _strcpy
001358 93ba      	ST   -Y,R27
001359 93aa      	ST   -Y,R26
00135a 91e9          ld   r30,y+
00135b 91f9          ld   r31,y+
00135c 91a9          ld   r26,y+
00135d 91b9          ld   r27,y+
00135e 01cd          movw r24,r26
                 strcpy0:
00135f 9161          ld   r22,z+
001360 936d          st   x+,r22
001361 2366          tst  r22
001362 f7e1          brne strcpy0
001363 01fc          movw r30,r24
001364 9508          ret
                 ; .FEND
                 _strlen:
                 ; .FSTART _strlen
001365 93ba      	ST   -Y,R27
001366 93aa      	ST   -Y,R26
001367 91a9          ld   r26,y+
001368 91b9          ld   r27,y+
001369 27ee          clr  r30
00136a 27ff          clr  r31
                 strlen0:
00136b 916d          ld   r22,x+
00136c 2366          tst  r22
00136d f011          breq strlen1
00136e 9631          adiw r30,1
00136f cffb          rjmp strlen0
                 strlen1:
001370 9508          ret
                 ; .FEND
                 _strlenf:
                 ; .FSTART _strlenf
001371 940e 1877 	CALL __PUTPARD2
001373 27aa          clr  r26
001374 27bb          clr  r27
001375 91e9          ld   r30,y+
001376 91f9          ld   r31,y+
001377 9169          ld   r22,y+
001378 9179          ld   r23,y+
001379 bf6b          out  rampz,r22
                 strlenf0:
00137a 9007          elpm r0,z+
00137b 2000          tst  r0
00137c f011          breq strlenf1
00137d 9611          adiw r26,1
00137e cffb          rjmp strlenf0
                 strlenf1:
00137f 01fd          movw r30,r26
001380 9508          ret
                 ; .FEND
                 	#ifndef __SLEEP_DEFINED__
                 	#endif
                 
                 	.DSEG
                 
                 	.CSEG
                 __lcd_write_nibble_G103:
                 ; .FSTART __lcd_write_nibble_G103
001381 93aa      	ST   -Y,R26
001382 b3e5      	IN   R30,0x15
001383 70ef      	ANDI R30,LOW(0xF)
001384 2fae      	MOV  R26,R30
001385 81e8      	LD   R30,Y
001386 7fe0      	ANDI R30,LOW(0xF0)
001387 2bea      	OR   R30,R26
001388 bbe5      	OUT  0x15,R30
                +
001389 e181     +LDI R24 , LOW ( 17 )
                +__DELAY_USB_LOOP :
00138a 958a     +DEC R24
00138b f7f1     +BRNE __DELAY_USB_LOOP
                 	__DELAY_USB 17
00138c 9aa9      	SBI  0x15,1
                +
00138d e181     +LDI R24 , LOW ( 17 )
                +__DELAY_USB_LOOP :
00138e 958a     +DEC R24
00138f f7f1     +BRNE __DELAY_USB_LOOP
                 	__DELAY_USB 17
001390 98a9      	CBI  0x15,1
                +
001391 e181     +LDI R24 , LOW ( 17 )
                +__DELAY_USB_LOOP :
001392 958a     +DEC R24
001393 f7f1     +BRNE __DELAY_USB_LOOP
                 	__DELAY_USB 17
001394 c092      	RJMP _0x20C0001
                 ; .FEND
                 __lcd_write_data:
                 ; .FSTART __lcd_write_data
001395 93aa      	ST   -Y,R26
001396 81a8      	LD   R26,Y
001397 dfe9      	RCALL __lcd_write_nibble_G103
001398 81e8          ld    r30,y
001399 95e2          swap  r30
00139a 83e8          st    y,r30
00139b 81a8      	LD   R26,Y
00139c dfe4      	RCALL __lcd_write_nibble_G103
                +
00139d ea87     +LDI R24 , LOW ( 167 )
                +__DELAY_USB_LOOP :
00139e 958a     +DEC R24
00139f f7f1     +BRNE __DELAY_USB_LOOP
                 	__DELAY_USB 167
0013a0 c086      	RJMP _0x20C0001
                 ; .FEND
                 _lcd_gotoxy:
                 ; .FSTART _lcd_gotoxy
0013a1 93aa      	ST   -Y,R26
0013a2 81e8      	LD   R30,Y
0013a3 e0f0      	LDI  R31,0
0013a4 5fea      	SUBI R30,LOW(-__base_y_G103)
0013a5 4ff4      	SBCI R31,HIGH(-__base_y_G103)
0013a6 81e0      	LD   R30,Z
0013a7 81a9      	LDD  R26,Y+1
0013a8 0fae      	ADD  R26,R30
0013a9 dfeb      	RCALL __lcd_write_data
0013aa 8069      	LDD  R6,Y+1
0013ab 81e8      	LD   R30,Y
0013ac 93e0 0b0a 	STS  __lcd_y,R30
0013ae 9622      	ADIW R28,2
0013af 9508      	RET
                 ; .FEND
                 _lcd_clear:
                 ; .FSTART _lcd_clear
0013b0 e0a2      	LDI  R26,LOW(2)
0013b1 940e 176c 	CALL SUBOPT_0x7B
0013b3 e0ac      	LDI  R26,LOW(12)
0013b4 dfe0      	RCALL __lcd_write_data
0013b5 e0a1      	LDI  R26,LOW(1)
0013b6 940e 176c 	CALL SUBOPT_0x7B
0013b8 e0e0      	LDI  R30,LOW(0)
0013b9 93e0 0b0a 	STS  __lcd_y,R30
0013bb 2e6e      	MOV  R6,R30
0013bc 9508      	RET
                 ; .FEND
                 _lcd_putchar:
                 ; .FSTART _lcd_putchar
0013bd 93aa      	ST   -Y,R26
0013be 81a8      	LD   R26,Y
0013bf 30aa      	CPI  R26,LOW(0xA)
0013c0 f021      	BREQ _0x2060005
0013c1 91e0 0b0b 	LDS  R30,__lcd_maxx
0013c3 166e      	CP   R6,R30
0013c4 f060      	BRLO _0x2060004
                 _0x2060005:
0013c5 e0e0      	LDI  R30,LOW(0)
0013c6 93ea      	ST   -Y,R30
0013c7 91a0 0b0a 	LDS  R26,__lcd_y
0013c9 5faf      	SUBI R26,-LOW(1)
0013ca 93a0 0b0a 	STS  __lcd_y,R26
0013cc dfd4      	RCALL _lcd_gotoxy
0013cd 81a8      	LD   R26,Y
0013ce 30aa      	CPI  R26,LOW(0xA)
0013cf f409      	BRNE _0x2060007
0013d0 c056      	RJMP _0x20C0001
                 _0x2060007:
                 _0x2060004:
0013d1 9463      	INC  R6
0013d2 9aaa      	SBI  0x15,2
0013d3 81a8      	LD   R26,Y
0013d4 dfc0      	RCALL __lcd_write_data
0013d5 98aa      	CBI  0x15,2
0013d6 c050      	RJMP _0x20C0001
                 ; .FEND
                 _lcd_puts:
                 ; .FSTART _lcd_puts
0013d7 93ba      	ST   -Y,R27
0013d8 93aa      	ST   -Y,R26
0013d9 931a      	ST   -Y,R17
                 _0x2060008:
0013da 81a9      	LDD  R26,Y+1
0013db 81ba      	LDD  R27,Y+1+1
0013dc 91ed      	LD   R30,X+
0013dd 83a9      	STD  Y+1,R26
0013de 83ba      	STD  Y+1+1,R27
0013df 2f1e      	MOV  R17,R30
0013e0 30e0      	CPI  R30,0
0013e1 f019      	BREQ _0x206000A
0013e2 2fa1      	MOV  R26,R17
0013e3 dfd9      	RCALL _lcd_putchar
0013e4 cff5      	RJMP _0x2060008
                 _0x206000A:
0013e5 8118      	LDD  R17,Y+0
                 _0x20C0002:
0013e6 9623      	ADIW R28,3
0013e7 9508      	RET
                 ; .FEND
                 _lcd_putsf:
                 ; .FSTART _lcd_putsf
0013e8 940e 1877 	CALL __PUTPARD2
0013ea 931a      	ST   -Y,R17
                 _0x206000B:
0013eb 01de      	MOVW R26,R28
0013ec 9611      	ADIW R26,1
0013ed 940e 174d 	CALL SUBOPT_0x76
                +
0013ef bf6b     +OUT RAMPZ , R22
0013f0 91e6     +ELPM R30 , Z
                 	__GETBRPF 30
0013f1 2f1e      	MOV  R17,R30
0013f2 30e0      	CPI  R30,0
0013f3 f019      	BREQ _0x206000D
0013f4 2fa1      	MOV  R26,R17
0013f5 dfc7      	RCALL _lcd_putchar
0013f6 cff4      	RJMP _0x206000B
                 _0x206000D:
0013f7 8118      	LDD  R17,Y+0
0013f8 9625      	ADIW R28,5
0013f9 9508      	RET
                 ; .FEND
                 _lcd_init:
                 ; .FSTART _lcd_init
0013fa 93aa      	ST   -Y,R26
0013fb b3e4      	IN   R30,0x14
0013fc 6fe0      	ORI  R30,LOW(0xF0)
0013fd bbe4      	OUT  0x14,R30
0013fe 9aa1      	SBI  0x14,1
0013ff 9aa2      	SBI  0x14,2
001400 9aa3      	SBI  0x14,3
001401 98a9      	CBI  0x15,1
001402 98aa      	CBI  0x15,2
001403 98ab      	CBI  0x15,3
001404 81e8      	LD   R30,Y
001405 93e0 0b0b 	STS  __lcd_maxx,R30
001407 58e0      	SUBI R30,-LOW(128)
                +
001408 93e0 0b08+STS __base_y_G103 + ( 2 ) , R30
                 	__PUTB1MN __base_y_G103,2
00140a 81e8      	LD   R30,Y
00140b 54e0      	SUBI R30,-LOW(192)
                +
00140c 93e0 0b09+STS __base_y_G103 + ( 3 ) , R30
                 	__PUTB1MN __base_y_G103,3
00140e e1a4      	LDI  R26,LOW(20)
00140f e0b0      	LDI  R27,0
001410 940e 177a 	CALL _delay_ms
001412 940e 1772 	CALL SUBOPT_0x7C
001414 940e 1772 	CALL SUBOPT_0x7C
001416 940e 1772 	CALL SUBOPT_0x7C
001418 e2a0      	LDI  R26,LOW(32)
001419 df67      	RCALL __lcd_write_nibble_G103
                +
00141a ef8a     +LDI R24 , LOW ( 250 )
00141b e090     +LDI R25 , HIGH ( 250 )
                +__DELAY_USW_LOOP :
00141c 9701     +SBIW R24 , 1
00141d f7f1     +BRNE __DELAY_USW_LOOP
                 	__DELAY_USW 250
00141e e2a8      	LDI  R26,LOW(40)
00141f df75      	RCALL __lcd_write_data
001420 e0a4      	LDI  R26,LOW(4)
001421 df73      	RCALL __lcd_write_data
001422 e8a5      	LDI  R26,LOW(133)
001423 df71      	RCALL __lcd_write_data
001424 e0a6      	LDI  R26,LOW(6)
001425 df6f      	RCALL __lcd_write_data
001426 df89      	RCALL _lcd_clear
                 _0x20C0001:
001427 9621      	ADIW R28,1
001428 9508      	RET
                 ; .FEND
                 
                 	.CSEG
                 
                 	.CSEG
                 
                 	.DSEG
                 _fat:
000980           	.BYTE 0x2C
                 _path:
0009ac           	.BYTE 0x40
                 _text:
0009ec           	.BYTE 0xC
                 _buffer:
0009f8           	.BYTE 0x100
                 _testChar_S0000005000:
000af8           	.BYTE 0x1
                 ___AddrToZ24ByteToSPMCR_SPM_E:
000af9           	.BYTE 0x2
                 ___AddrToZ24ByteToSPMCR_SPM_EW:
000afb           	.BYTE 0x2
                 
                 	.ESEG
                 
                 	.ORG 0xA
                 __EepromBackup:
00000a           	.BYTE 0x107
                 
                 	.ORG 0x0
                 
                 	.DSEG
                 _CardType_G002:
000afd           	.BYTE 0x1
                 _wc_S0020007000:
000afe           	.BYTE 0x2
                 _FatFs_G003:
000b00           	.BYTE 0x2
                 __seed_G101:
000b02           	.BYTE 0x4
                 __base_y_G103:
000b06           	.BYTE 0x4
                 __lcd_y:
000b0a           	.BYTE 0x1
                 __lcd_maxx:
000b0b           	.BYTE 0x1
                 
                 	.CSEG
                 ;OPTIMIZER ADDED SUBROUTINE, CALLED 2 TIMES, CODE SIZE REDUCTION:2 WORDS
                 SUBOPT_0x0:
001429 e0f0      	LDI  R31,0
00142a 93fa      	ST   -Y,R31
00142b 93ea      	ST   -Y,R30
00142c 01de      	MOVW R26,R28
00142d 9612      	ADIW R26,2
00142e 940c 132a 	JMP  _itoa
                 
                 ;OPTIMIZER ADDED SUBROUTINE, CALLED 2 TIMES, CODE SIZE REDUCTION:7 WORDS
                 SUBOPT_0x1:
001430 e8ac      	LDI  R26,LOW(_error_msg*2)
001431 e0b0      	LDI  R27,HIGH(_error_msg*2)
001432 e080      	LDI  R24,BYTE3(_error_msg*2)
001433 27ff      	CLR  R31
001434 2766      	CLR  R22
001435 2777      	CLR  R23
001436 940e 17c8 	CALL __LSLD1
001438 940e 17c8 	CALL __LSLD1
00143a 940e 1788 	CALL __ADDD12
00143c 9508      	RET
                 
                 ;OPTIMIZER ADDED SUBROUTINE, CALLED 5 TIMES, CODE SIZE REDUCTION:13 WORDS
                 SUBOPT_0x2:
00143d 940e 1872 	CALL __PUTPARD1
00143f e084      	LDI  R24,4
001440 940e 1305 	CALL _printf
001442 9628      	ADIW R28,8
001443 9508      	RET
                 
                 ;OPTIMIZER ADDED SUBROUTINE, CALLED 2 TIMES, CODE SIZE REDUCTION:3 WORDS
                 SUBOPT_0x3:
001444 940e 1872 	CALL __PUTPARD1
001446 eaec      	LDI  R30,LOW(_path)
001447 e0f9      	LDI  R31,HIGH(_path)
001448 2766      	CLR  R22
001449 2777      	CLR  R23
00144a cff2      	RJMP SUBOPT_0x2
                 
                 ;OPTIMIZER ADDED SUBROUTINE, CALLED 6 TIMES, CODE SIZE REDUCTION:7 WORDS
                 SUBOPT_0x4:
00144b 01fe      	MOVW R30,R28
00144c 93fa      	ST   -Y,R31
00144d 93ea      	ST   -Y,R30
00144e 9508      	RET
                 
                 ;OPTIMIZER ADDED SUBROUTINE, CALLED 8 TIMES, CODE SIZE REDUCTION:11 WORDS
                 SUBOPT_0x5:
00144f e0e0      	LDI  R30,LOW(0)
001450 e0f0      	LDI  R31,HIGH(0)
001451 93fa      	ST   -Y,R31
001452 93ea      	ST   -Y,R30
001453 9508      	RET
                 
                 ;OPTIMIZER ADDED SUBROUTINE, CALLED 6 TIMES, CODE SIZE REDUCTION:37 WORDS
                 SUBOPT_0x6:
001454 e0ea      	LDI  R30,LOW(10)
001455 e0f0      	LDI  R31,HIGH(10)
001456 93fa      	ST   -Y,R31
001457 93ea      	ST   -Y,R30
001458 e0a8      	LDI  R26,LOW(8)
001459 e0b0      	LDI  R27,HIGH(8)
00145a 940e 0f2e 	CALL _pf_write512
00145c 2e7e      	MOV  R7,R30
00145d 30e0      	CPI  R30,0
00145e 9508      	RET
                 
                 ;OPTIMIZER ADDED SUBROUTINE, CALLED 7 TIMES, CODE SIZE REDUCTION:111 WORDS
                 SUBOPT_0x7:
                +
00145f eeec     +LDI R30 , LOW ( 2 * _0x0 + ( 368 ) )
001460 e0f2     +LDI R31 , HIGH ( 2 * _0x0 + ( 368 ) )
001461 e060     +LDI R22 , BYTE3 ( 2 * _0x0 + ( 368 ) )
001462 e070     +LDI R23 , BYTE4 ( 2 * _0x0 + ( 368 ) )
                 	__POINTD1FN _0x0,368
001463 940e 1872 	CALL __PUTPARD1
001465 01f4      	MOVW R30,R8
001466 2766      	CLR  R22
001467 2777      	CLR  R23
001468 940e 1872 	CALL __PUTPARD1
                +
00146a e0eb     +LDI R30 , LOW ( 0xB )
00146b e0f0     +LDI R31 , HIGH ( 0xB )
00146c e060     +LDI R22 , BYTE3 ( 0xB )
00146d e070     +LDI R23 , BYTE4 ( 0xB )
                 	__GETD1N 0xB
00146e 940e 1872 	CALL __PUTPARD1
001470 e088      	LDI  R24,8
001471 940e 1305 	CALL _printf
001473 962c      	ADIW R28,12
001474 9508      	RET
                 
                 ;OPTIMIZER ADDED SUBROUTINE, CALLED 6 TIMES, CODE SIZE REDUCTION:7 WORDS
                 SUBOPT_0x8:
001475 927a      	ST   -Y,R7
001476 e5ad      	LDI  R26,LOW(93)
001477 940c 0228 	JMP  _error
                 
                 ;OPTIMIZER ADDED SUBROUTINE, CALLED 5 TIMES, CODE SIZE REDUCTION:5 WORDS
                 SUBOPT_0x9:
001479 93fa      	ST   -Y,R31
00147a 93ea      	ST   -Y,R30
00147b cfd8      	RJMP SUBOPT_0x6
                 
                 ;OPTIMIZER ADDED SUBROUTINE, CALLED 2 TIMES, CODE SIZE REDUCTION:1 WORDS
                 SUBOPT_0xA:
00147c 98a9      	CBI  0x15,1
00147d efa4      	LDI  R26,LOW(500)
00147e e0b1      	LDI  R27,HIGH(500)
00147f 940e 177a 	CALL _delay_ms
001481 9aa9      	SBI  0x15,1
001482 9508      	RET
                 
                 ;OPTIMIZER ADDED SUBROUTINE, CALLED 4 TIMES, CODE SIZE REDUCTION:3 WORDS
                 SUBOPT_0xB:
001483 efa4      	LDI  R26,LOW(500)
001484 e0b1      	LDI  R27,HIGH(500)
001485 940c 177a 	JMP  _delay_ms
                 
                 ;OPTIMIZER ADDED SUBROUTINE, CALLED 2 TIMES, CODE SIZE REDUCTION:1 WORDS
                 SUBOPT_0xC:
                +
001487 e0e2     +LDI R30 , LOW ( 0x2 )
001488 e0f0     +LDI R31 , HIGH ( 0x2 )
001489 e060     +LDI R22 , BYTE3 ( 0x2 )
00148a e070     +LDI R23 , BYTE4 ( 0x2 )
                 	__GETD1N 0x2
00148b 940e 1872 	CALL __PUTPARD1
00148d 9508      	RET
                 
                 ;OPTIMIZER ADDED SUBROUTINE, CALLED 4 TIMES, CODE SIZE REDUCTION:15 WORDS
                 SUBOPT_0xD:
00148e efe8      	LDI  R30,LOW(_testChar_S0000005000)
00148f e0fa      	LDI  R31,HIGH(_testChar_S0000005000)
001490 93fa      	ST   -Y,R31
001491 93ea      	ST   -Y,R30
001492 e0a1      	LDI  R26,LOW(1)
001493 e0b0      	LDI  R27,0
001494 940c 0422 	JMP  _ReadFlashBytes
                 
                 ;OPTIMIZER ADDED SUBROUTINE, CALLED 3 TIMES, CODE SIZE REDUCTION:1 WORDS
                 SUBOPT_0xE:
001496 940e 1872 	CALL __PUTPARD1
001498 cff5      	RJMP SUBOPT_0xD
                 
                 ;OPTIMIZER ADDED SUBROUTINE, CALLED 3 TIMES, CODE SIZE REDUCTION:1 WORDS
                 SUBOPT_0xF:
001499 940e 1868 	CALL __GETD1S0
00149b 9508      	RET
                 
                 ;OPTIMIZER ADDED SUBROUTINE, CALLED 4 TIMES, CODE SIZE REDUCTION:3 WORDS
                 SUBOPT_0x10:
00149c 93ba      	ST   -Y,R27
00149d 93aa      	ST   -Y,R26
00149e 931a      	ST   -Y,R17
00149f 930a      	ST   -Y,R16
0014a0 9508      	RET
                 
                 ;OPTIMIZER ADDED SUBROUTINE, CALLED 9 TIMES, CODE SIZE REDUCTION:13 WORDS
                 SUBOPT_0x11:
                +
0014a1 81ec     +LDD R30 , Y + 4
0014a2 81fd     +LDD R31 , Y + 4 + 1
0014a3 816e     +LDD R22 , Y + 4 + 2
0014a4 817f     +LDD R23 , Y + 4 + 3
                 	__GETD1S 4
0014a5 9508      	RET
                 
                 ;OPTIMIZER ADDED SUBROUTINE, CALLED 2 TIMES, CODE SIZE REDUCTION:6 WORDS
                 SUBOPT_0x12:
0014a6 01f8      	MOVW R30,R16
                +
0014a7 81ac     +LDD R26 , Y + 4
0014a8 81bd     +LDD R27 , Y + 4 + 1
0014a9 818e     +LDD R24 , Y + 4 + 2
0014aa 819f     +LDD R25 , Y + 4 + 3
                 	__GETD2S 4
0014ab 2766      	CLR  R22
0014ac 2777      	CLR  R23
0014ad 940e 178d 	CALL __ADDD21
0014af 940c 03f4 	JMP  _ReadFlashByte
                 
                 ;OPTIMIZER ADDED SUBROUTINE, CALLED 5 TIMES, CODE SIZE REDUCTION:5 WORDS
                 SUBOPT_0x13:
                +
0014b1 81ee     +LDD R30 , Y + 6
0014b2 81ff     +LDD R31 , Y + 6 + 1
0014b3 8568     +LDD R22 , Y + 6 + 2
0014b4 8579     +LDD R23 , Y + 6 + 3
                 	__GETD1S 6
0014b5 9508      	RET
                 
                 ;OPTIMIZER ADDED SUBROUTINE, CALLED 7 TIMES, CODE SIZE REDUCTION:9 WORDS
                 SUBOPT_0x14:
                +
0014b6 83ee     +STD Y + 6 , R30
0014b7 83ff     +STD Y + 6 + 1 , R31
0014b8 8768     +STD Y + 6 + 2 , R22
0014b9 8779     +STD Y + 6 + 3 , R23
                 	__PUTD1S 6
0014ba 9508      	RET
                 
                 ;OPTIMIZER ADDED SUBROUTINE, CALLED 3 TIMES, CODE SIZE REDUCTION:1 WORDS
                 SUBOPT_0x15:
                +
0014bb 81ae     +LDD R26 , Y + 6
0014bc 81bf     +LDD R27 , Y + 6 + 1
0014bd 8588     +LDD R24 , Y + 6 + 2
0014be 8599     +LDD R25 , Y + 6 + 3
                 	__GETD2S 6
0014bf 9508      	RET
                 
                 ;OPTIMIZER ADDED SUBROUTINE, CALLED 3 TIMES, CODE SIZE REDUCTION:5 WORDS
                 SUBOPT_0x16:
                +
0014c0 01fe     +MOVW R30 , R28
0014c1 5fe4     +SUBI R30 , LOW ( - 268 )
0014c2 4ffe     +SBCI R31 , HIGH ( - 268 )
0014c3 9001     +LD R0 , Z +
0014c4 81f0     +LD R31 , Z
0014c5 2de0     +MOV R30 , R0
                 	__GETW1SX 268
0014c6 9508      	RET
                 
                 ;OPTIMIZER ADDED SUBROUTINE, CALLED 2 TIMES, CODE SIZE REDUCTION:7 WORDS
                 SUBOPT_0x17:
                +
0014c7 01fe     +MOVW R30 , R28
0014c8 5fe0     +SUBI R30 , LOW ( - 272 )
0014c9 4ffe     +SBCI R31 , HIGH ( - 272 )
0014ca 9001     +LD R0 , Z +
0014cb 9011     +LD R1 , Z +
0014cc 9161     +LD R22 , Z +
0014cd 8170     +LD R23 , Z
0014ce 01f0     +MOVW R30 , R0
                 	__GETD1SX 272
                +
0014cf 7fef     +ANDI R30 , LOW ( 0xFF )
0014d0 70f0     +ANDI R31 , HIGH ( 0xFF )
0014d1 7060     +ANDI R22 , BYTE3 ( 0xFF )
0014d2 7070     +ANDI R23 , BYTE4 ( 0xFF )
                 	__ANDD1N 0xFF
0014d3 9508      	RET
                 
                 ;OPTIMIZER ADDED SUBROUTINE, CALLED 2 TIMES, CODE SIZE REDUCTION:3 WORDS
                 SUBOPT_0x18:
                +
0014d4 01de     +MOVW R26 , R28
0014d5 5fa0     +SUBI R26 , LOW ( - 272 )
0014d6 4fbe     +SBCI R27 , HIGH ( - 272 )
0014d7 900d     +LD R0 , X +
0014d8 901d     +LD R1 , X +
0014d9 918d     +LD R24 , X +
0014da 919c     +LD R25 , X
0014db 01d0     +MOVW R26 , R0
                 	__GETD2SX 272
0014dc 9508      	RET
                 
                 ;OPTIMIZER ADDED SUBROUTINE, CALLED 6 TIMES, CODE SIZE REDUCTION:7 WORDS
                 SUBOPT_0x19:
                +
0014dd 85e8     +LDD R30 , Y + 8
0014de 85f9     +LDD R31 , Y + 8 + 1
0014df 856a     +LDD R22 , Y + 8 + 2
0014e0 857b     +LDD R23 , Y + 8 + 3
                 	__GETD1S 8
0014e1 9508      	RET
                 
                 ;OPTIMIZER ADDED SUBROUTINE, CALLED 3 TIMES, CODE SIZE REDUCTION:1 WORDS
                 SUBOPT_0x1A:
                +
0014e2 83ec     +STD Y + 4 , R30
0014e3 83fd     +STD Y + 4 + 1 , R31
0014e4 836e     +STD Y + 4 + 2 , R22
0014e5 837f     +STD Y + 4 + 3 , R23
                 	__PUTD1S 4
0014e6 9508      	RET
                 
                 ;OPTIMIZER ADDED SUBROUTINE, CALLED 8 TIMES, CODE SIZE REDUCTION:11 WORDS
                 SUBOPT_0x1B:
0014e7 2766      	CLR  R22
0014e8 2777      	CLR  R23
0014e9 940e 1788 	CALL __ADDD12
0014eb 9508      	RET
                 
                 ;OPTIMIZER ADDED SUBROUTINE, CALLED 8 TIMES, CODE SIZE REDUCTION:11 WORDS
                 SUBOPT_0x1C:
                +
0014ec 85ea     +LDD R30 , Y + 10
0014ed 85fb     +LDD R31 , Y + 10 + 1
0014ee 856c     +LDD R22 , Y + 10 + 2
0014ef 857d     +LDD R23 , Y + 10 + 3
                 	__GETD1S 10
0014f0 9508      	RET
                 
                 ;OPTIMIZER ADDED SUBROUTINE, CALLED 6 TIMES, CODE SIZE REDUCTION:7 WORDS
                 SUBOPT_0x1D:
                +
0014f1 85aa     +LDD R26 , Y + 10
0014f2 85bb     +LDD R27 , Y + 10 + 1
0014f3 858c     +LDD R24 , Y + 10 + 2
0014f4 859d     +LDD R25 , Y + 10 + 3
                 	__GETD2S 10
0014f5 9508      	RET
                 
                 ;OPTIMIZER ADDED SUBROUTINE, CALLED 2 TIMES, CODE SIZE REDUCTION:3 WORDS
                 SUBOPT_0x1E:
0014f6 81ea      	LDD  R30,Y+2
0014f7 81fb      	LDD  R31,Y+2+1
0014f8 9731      	SBIW R30,1
0014f9 81a8      	LD   R26,Y
0014fa 81b9      	LDD  R27,Y+1
0014fb 0fae      	ADD  R26,R30
0014fc 1fbf      	ADC  R27,R31
0014fd 91ec      	LD   R30,X
0014fe 9508      	RET
                 
                 ;OPTIMIZER ADDED SUBROUTINE, CALLED 4 TIMES, CODE SIZE REDUCTION:12 WORDS
                 SUBOPT_0x1F:
0014ff 93ea      	ST   -Y,R30
                +
001500 e0a0     +LDI R26 , LOW ( 0x0 )
001501 e0b0     +LDI R27 , HIGH ( 0x0 )
001502 e080     +LDI R24 , BYTE3 ( 0x0 )
001503 e090     +LDI R25 , BYTE4 ( 0x0 )
                 	__GETD2N 0x0
001504 940c 0605 	JMP  _send_cmd_G002
                 
                 ;OPTIMIZER ADDED SUBROUTINE, CALLED 2 TIMES, CODE SIZE REDUCTION:1 WORDS
                 SUBOPT_0x20:
001506 940e 05f3 	CALL _xmit_spi
                +
001508 81aa     +LDD R26 , Y + 2
001509 81bb     +LDD R27 , Y + 2 + 1
00150a 818c     +LDD R24 , Y + 2 + 2
00150b 819d     +LDD R25 , Y + 2 + 3
                 	__GETD2S 2
00150c 9508      	RET
                 
                 ;OPTIMIZER ADDED SUBROUTINE, CALLED 10 TIMES, CODE SIZE REDUCTION:15 WORDS
                 SUBOPT_0x21:
                +
00150d 81ea     +LDD R30 , Y + 2
00150e 81fb     +LDD R31 , Y + 2 + 1
00150f 816c     +LDD R22 , Y + 2 + 2
001510 817d     +LDD R23 , Y + 2 + 3
                 	__GETD1S 2
001511 9508      	RET
                 
                 ;OPTIMIZER ADDED SUBROUTINE, CALLED 2 TIMES, CODE SIZE REDUCTION:1 WORDS
                 SUBOPT_0x22:
001512 2fe1      	MOV  R30,R17
001513 e0f0      	LDI  R31,0
001514 01de      	MOVW R26,R28
001515 9616      	ADIW R26,6
001516 0fea      	ADD  R30,R26
001517 1ffb      	ADC  R31,R27
001518 9508      	RET
                 
                 ;OPTIMIZER ADDED SUBROUTINE, CALLED 4 TIMES, CODE SIZE REDUCTION:3 WORDS
                 SUBOPT_0x23:
                +
001519 e0a0     +LDI R26 , LOW ( 0x0 )
00151a e0b0     +LDI R27 , HIGH ( 0x0 )
00151b e080     +LDI R24 , BYTE3 ( 0x0 )
00151c e090     +LDI R25 , BYTE4 ( 0x0 )
                 	__GETD2N 0x0
00151d 9508      	RET
                 
                 ;OPTIMIZER ADDED SUBROUTINE, CALLED 5 TIMES, CODE SIZE REDUCTION:5 WORDS
                 SUBOPT_0x24:
                +
00151e e0a0     +LDI R26 , LOW ( 0x200 )
00151f e0b2     +LDI R27 , HIGH ( 0x200 )
001520 e080     +LDI R24 , BYTE3 ( 0x200 )
001521 e090     +LDI R25 , BYTE4 ( 0x200 )
                 	__GETD2N 0x200
001522 9508      	RET
                 
                 ;OPTIMIZER ADDED SUBROUTINE, CALLED 3 TIMES, CODE SIZE REDUCTION:1 WORDS
                 SUBOPT_0x25:
001523 93ba      	ST   -Y,R27
001524 93aa      	ST   -Y,R26
001525 940e 18d0 	CALL __SAVELOCR4
001527 9508      	RET
                 
                 ;OPTIMIZER ADDED SUBROUTINE, CALLED 3 TIMES, CODE SIZE REDUCTION:1 WORDS
                 SUBOPT_0x26:
001528 dff5      	RCALL SUBOPT_0x24
001529 940e 17e1 	CALL __MULD12U
00152b 9508      	RET
                 
                 ;OPTIMIZER ADDED SUBROUTINE, CALLED 3 TIMES, CODE SIZE REDUCTION:1 WORDS
                 SUBOPT_0x27:
                +
00152c 85a9     +LDD R26 , Y + 9
00152d 85ba     +LDD R27 , Y + 9 + 1
00152e 858b     +LDD R24 , Y + 9 + 2
00152f 859c     +LDD R25 , Y + 9 + 3
                 	__GETD2S 9
001530 9508      	RET
                 
                 ;OPTIMIZER ADDED SUBROUTINE, CALLED 3 TIMES, CODE SIZE REDUCTION:1 WORDS
                 SUBOPT_0x28:
001531 93ba      	ST   -Y,R27
001532 93aa      	ST   -Y,R26
001533 940e 18ce 	CALL __SAVELOCR6
001535 9508      	RET
                 
                 ;OPTIMIZER ADDED SUBROUTINE, CALLED 4 TIMES, CODE SIZE REDUCTION:3 WORDS
                 SUBOPT_0x29:
001536 91e0 0b00 	LDS  R30,_FatFs_G003
001538 91f0 0b01 	LDS  R31,_FatFs_G003+1
00153a 9508      	RET
                 
                 ;OPTIMIZER ADDED SUBROUTINE, CALLED 3 TIMES, CODE SIZE REDUCTION:1 WORDS
                 SUBOPT_0x2A:
                +
00153b 85ac     +LDD R26 , Y + 12
00153c 85bd     +LDD R27 , Y + 12 + 1
00153d 858e     +LDD R24 , Y + 12 + 2
00153e 859f     +LDD R25 , Y + 12 + 3
                 	__GETD2S 12
00153f 9508      	RET
                 
                 ;OPTIMIZER ADDED SUBROUTINE, CALLED 5 TIMES, CODE SIZE REDUCTION:17 WORDS
                 SUBOPT_0x2B:
                +
001540 30a2     +CPI R26 , LOW ( 0x2 )
001541 e0e0     +LDI R30 , HIGH ( 0x2 )
001542 07be     +CPC R27 , R30
001543 e0e0     +LDI R30 , BYTE3 ( 0x2 )
001544 078e     +CPC R24 , R30
001545 e0e0     +LDI R30 , BYTE4 ( 0x2 )
001546 079e     +CPC R25 , R30
                 	__CPD2N 0x2
001547 9508      	RET
                 
                 ;OPTIMIZER ADDED SUBROUTINE, CALLED 2 TIMES, CODE SIZE REDUCTION:8 WORDS
                 SUBOPT_0x2C:
001548 01fe      	MOVW R30,R28
001549 9638      	ADIW R30,8
00154a 93fa      	ST   -Y,R31
00154b 93ea      	ST   -Y,R30
00154c 85e8      	LDD  R30,Y+8
00154d 85f9      	LDD  R31,Y+8+1
                +
00154e 85a4     +LDD R26 , Z + 12
00154f 85b5     +LDD R27 , Z + 12 + 1
001550 8586     +LDD R24 , Z + 12 + 2
001551 8597     +LDD R25 , Z + 12 + 3
                 	__GETD2Z 12
001552 01f9      	MOVW R30,R18
001553 cf93      	RJMP SUBOPT_0x1B
                 
                 ;OPTIMIZER ADDED SUBROUTINE, CALLED 5 TIMES, CODE SIZE REDUCTION:9 WORDS
                 SUBOPT_0x2D:
001554 e0a2      	LDI  R26,LOW(2)
001555 e0b0      	LDI  R27,0
001556 940e 06e0 	CALL _disk_readp
001558 30e0      	CPI  R30,0
001559 9508      	RET
                 
                 ;OPTIMIZER ADDED SUBROUTINE, CALLED 7 TIMES, CODE SIZE REDUCTION:9 WORDS
                 SUBOPT_0x2E:
00155a e0b0      	LDI  R27,0
00155b 940e 06e0 	CALL _disk_readp
00155d 30e0      	CPI  R30,0
00155e 9508      	RET
                 
                 ;OPTIMIZER ADDED SUBROUTINE, CALLED 3 TIMES, CODE SIZE REDUCTION:9 WORDS
                 SUBOPT_0x2F:
00155f 93fa      	ST   -Y,R31
001560 93ea      	ST   -Y,R30
001561 85e8      	LDD  R30,Y+8
001562 85f9      	LDD  R31,Y+8+1
                +
001563 85a4     +LDD R26 , Z + 12
001564 85b5     +LDD R27 , Z + 12 + 1
001565 8586     +LDD R24 , Z + 12 + 2
001566 8597     +LDD R25 , Z + 12 + 3
                 	__GETD2Z 12
001567 9508      	RET
                 
                 ;OPTIMIZER ADDED SUBROUTINE, CALLED 4 TIMES, CODE SIZE REDUCTION:3 WORDS
                 SUBOPT_0x30:
                +
001568 5fef     +SUBI R30 , LOW ( - 1 )
001569 4fff     +SBCI R31 , HIGH ( - 1 )
00156a 4f6f     +SBCI R22 , BYTE3 ( - 1 )
00156b 4f7f     +SBCI R23 , BYTE4 ( - 1 )
                 	__ADDD1N 1
00156c 9508      	RET
                 
                 ;OPTIMIZER ADDED SUBROUTINE, CALLED 7 TIMES, CODE SIZE REDUCTION:9 WORDS
                 SUBOPT_0x31:
                +
00156d 85ae     +LDD R26 , Y + 14
00156e 85bf     +LDD R27 , Y + 14 + 1
00156f 8988     +LDD R24 , Y + 14 + 2
001570 8999     +LDD R25 , Y + 14 + 3
                 	__GETD2S 14
001571 9508      	RET
                 
                 ;OPTIMIZER ADDED SUBROUTINE, CALLED 2 TIMES, CODE SIZE REDUCTION:1 WORDS
                 SUBOPT_0x32:
001572 940e 1788 	CALL __ADDD12
001574 940e 1872 	CALL __PUTPARD1
001576 89ea      	LDD  R30,Y+18
001577 89fb      	LDD  R31,Y+18+1
001578 9508      	RET
                 
                 ;OPTIMIZER ADDED SUBROUTINE, CALLED 4 TIMES, CODE SIZE REDUCTION:3 WORDS
                 SUBOPT_0x33:
001579 93fa      	ST   -Y,R31
00157a 93ea      	ST   -Y,R30
00157b cfd8      	RJMP SUBOPT_0x2D
                 
                 ;OPTIMIZER ADDED SUBROUTINE, CALLED 3 TIMES, CODE SIZE REDUCTION:5 WORDS
                 SUBOPT_0x34:
00157c 931a      	ST   -Y,R17
00157d 930a      	ST   -Y,R16
                +
00157e 9100 0b00+LDS R16 , 0 + ( _FatFs_G003 )
001580 9110 0b01+LDS R17 , 0 + ( _FatFs_G003 ) + 1
                 	__GETWRMN 16,17,0,_FatFs_G003
001582 9508      	RET
                 
                 ;OPTIMIZER ADDED SUBROUTINE, CALLED 4 TIMES, CODE SIZE REDUCTION:3 WORDS
                 SUBOPT_0x35:
                +
001583 83ea     +STD Y + 2 , R30
001584 83fb     +STD Y + 2 + 1 , R31
001585 836c     +STD Y + 2 + 2 , R22
001586 837d     +STD Y + 2 + 3 , R23
                 	__PUTD1S 2
001587 9508      	RET
                 
                 ;OPTIMIZER ADDED SUBROUTINE, CALLED 6 TIMES, CODE SIZE REDUCTION:7 WORDS
                 SUBOPT_0x36:
                +
001588 81aa     +LDD R26 , Y + 2
001589 81bb     +LDD R27 , Y + 2 + 1
00158a 818c     +LDD R24 , Y + 2 + 2
00158b 819d     +LDD R25 , Y + 2 + 3
                 	__GETD2S 2
00158c 9508      	RET
                 
                 ;OPTIMIZER ADDED SUBROUTINE, CALLED 7 TIMES, CODE SIZE REDUCTION:9 WORDS
                 SUBOPT_0x37:
                +
00158d e0e0     +LDI R30 , LOW ( 0x0 )
00158e e0f0     +LDI R31 , HIGH ( 0x0 )
00158f e060     +LDI R22 , BYTE3 ( 0x0 )
001590 e070     +LDI R23 , BYTE4 ( 0x0 )
                 	__GETD1N 0x0
001591 9508      	RET
                 
                 ;OPTIMIZER ADDED SUBROUTINE, CALLED 4 TIMES, CODE SIZE REDUCTION:3 WORDS
                 SUBOPT_0x38:
001592 e0e0      	LDI  R30,LOW(0)
001593 e0f0      	LDI  R31,HIGH(0)
001594 93ed      	ST   X+,R30
001595 93fc      	ST   X,R31
001596 9508      	RET
                 
                 ;OPTIMIZER ADDED SUBROUTINE, CALLED 3 TIMES, CODE SIZE REDUCTION:1 WORDS
                 SUBOPT_0x39:
001597 940e 1841 	CALL __GETD1P
001599 cfe9      	RJMP SUBOPT_0x35
                 
                 ;OPTIMIZER ADDED SUBROUTINE, CALLED 4 TIMES, CODE SIZE REDUCTION:9 WORDS
                 SUBOPT_0x3A:
00159a 940e 18d0 	CALL __SAVELOCR4
                +
00159c 9120 0b00+LDS R18 , 0 + ( _FatFs_G003 )
00159e 9130 0b01+LDS R19 , 0 + ( _FatFs_G003 ) + 1
                 	__GETWRMN 18,19,0,_FatFs_G003
0015a0 9508      	RET
                 
                 ;OPTIMIZER ADDED SUBROUTINE, CALLED 2 TIMES, CODE SIZE REDUCTION:2 WORDS
                 SUBOPT_0x3B:
0015a1 85a8      	LDD  R26,Y+8
0015a2 85b9      	LDD  R27,Y+8+1
0015a3 961c      	ADIW R26,12
0015a4 940e 1841 	CALL __GETD1P
0015a6 940e 18b6 	CALL __CPD10
0015a8 9508      	RET
                 
                 ;OPTIMIZER ADDED SUBROUTINE, CALLED 3 TIMES, CODE SIZE REDUCTION:1 WORDS
                 SUBOPT_0x3C:
                +
0015a9 81ac     +LDD R26 , Y + 4
0015aa 81bd     +LDD R27 , Y + 4 + 1
0015ab 818e     +LDD R24 , Y + 4 + 2
0015ac 819f     +LDD R25 , Y + 4 + 3
                 	__GETD2S 4
0015ad 9508      	RET
                 
                 ;OPTIMIZER ADDED SUBROUTINE, CALLED 4 TIMES, CODE SIZE REDUCTION:6 WORDS
                 SUBOPT_0x3D:
0015ae 91a0 0b00 	LDS  R26,_FatFs_G003
0015b0 91b0 0b01 	LDS  R27,_FatFs_G003+1
0015b2 9616      	ADIW R26,6
0015b3 9508      	RET
                 
                 ;OPTIMIZER ADDED SUBROUTINE, CALLED 2 TIMES, CODE SIZE REDUCTION:1 WORDS
                 SUBOPT_0x3E:
                +
0015b4 85a4     +LDD R26 , Z + 12
0015b5 85b5     +LDD R27 , Z + 12 + 1
0015b6 8586     +LDD R24 , Z + 12 + 2
0015b7 8597     +LDD R25 , Z + 12 + 3
                 	__GETD2Z 12
0015b8 940e 1877 	CALL __PUTPARD2
0015ba 9508      	RET
                 
                 ;OPTIMIZER ADDED SUBROUTINE, CALLED 2 TIMES, CODE SIZE REDUCTION:7 WORDS
                 SUBOPT_0x3F:
0015bb 940e 183d 	CALL __GETW1P
0015bd 70ef      	ANDI R30,LOW(0xF)
0015be 70f0      	ANDI R31,HIGH(0xF)
0015bf 0fee      	LSL  R30
0015c0 940e 17b6 	CALL __LSLW4
0015c2 93fa      	ST   -Y,R31
0015c3 93ea      	ST   -Y,R30
0015c4 e2a0      	LDI  R26,LOW(32)
0015c5 cf94      	RJMP SUBOPT_0x2E
                 
                 ;OPTIMIZER ADDED SUBROUTINE, CALLED 3 TIMES, CODE SIZE REDUCTION:3 WORDS
                 SUBOPT_0x40:
0015c6 961c      	ADIW R26,12
0015c7 dfc5      	RCALL SUBOPT_0x37
0015c8 940e 184c 	CALL __PUTDP1
0015ca 9508      	RET
                 
                 ;OPTIMIZER ADDED SUBROUTINE, CALLED 2 TIMES, CODE SIZE REDUCTION:2 WORDS
                 SUBOPT_0x41:
0015cb 2fe2      	MOV  R30,R18
0015cc 5f2f      	SUBI R18,-1
0015cd 81ae      	LDD  R26,Y+6
0015ce 81bf      	LDD  R27,Y+6+1
0015cf e0f0      	LDI  R31,0
0015d0 0fae      	ADD  R26,R30
0015d1 1fbf      	ADC  R27,R31
0015d2 9508      	RET
                 
                 ;OPTIMIZER ADDED SUBROUTINE, CALLED 3 TIMES, CODE SIZE REDUCTION:7 WORDS
                 SUBOPT_0x42:
0015d3 2fe5      	MOV  R30,R21
0015d4 5f5f      	SUBI R21,-1
0015d5 85a8      	LDD  R26,Y+8
0015d6 85b9      	LDD  R27,Y+8+1
0015d7 e0f0      	LDI  R31,0
0015d8 0fea      	ADD  R30,R26
0015d9 1ffb      	ADC  R31,R27
0015da 9508      	RET
                 
                 ;OPTIMIZER ADDED SUBROUTINE, CALLED 2 TIMES, CODE SIZE REDUCTION:1 WORDS
                 SUBOPT_0x43:
0015db 01d9      	MOVW R26,R18
0015dc 27ee      	CLR  R30
0015dd 0fa1      	ADD  R26,R17
0015de 1fbe      	ADC  R27,R30
0015df 910c      	LD   R16,X
0015e0 3200      	CPI  R16,32
0015e1 9508      	RET
                 
                 ;OPTIMIZER ADDED SUBROUTINE, CALLED 3 TIMES, CODE SIZE REDUCTION:1 WORDS
                 SUBOPT_0x44:
0015e2 dfaa      	RCALL SUBOPT_0x37
0015e3 940e 184c 	CALL __PUTDP1
0015e5 9508      	RET
                 
                 ;OPTIMIZER ADDED SUBROUTINE, CALLED 2 TIMES, CODE SIZE REDUCTION:2 WORDS
                 SUBOPT_0x45:
0015e6 81ae      	LDD  R26,Y+6
0015e7 81bf      	LDD  R27,Y+6+1
0015e8 9612      	ADIW R26,2
0015e9 940e 183d 	CALL __GETW1P
0015eb 85e3      	LDD  R30,Z+11
0015ec 30e0      	CPI  R30,0
0015ed 9508      	RET
                 
                 ;OPTIMIZER ADDED SUBROUTINE, CALLED 3 TIMES, CODE SIZE REDUCTION:1 WORDS
                 SUBOPT_0x46:
0015ee 940e 183d 	CALL __GETW1P
0015f0 2766      	CLR  R22
0015f1 2777      	CLR  R23
0015f2 9508      	RET
                 
                 ;OPTIMIZER ADDED SUBROUTINE, CALLED 3 TIMES, CODE SIZE REDUCTION:1 WORDS
                 SUBOPT_0x47:
0015f3 2766      	CLR  R22
0015f4 2777      	CLR  R23
0015f5 940e 17a1 	CALL __ORD12
0015f7 9508      	RET
                 
                 ;OPTIMIZER ADDED SUBROUTINE, CALLED 3 TIMES, CODE SIZE REDUCTION:9 WORDS
                 SUBOPT_0x48:
0015f8 81ec      	LDD  R30,Y+4
0015f9 81fd      	LDD  R31,Y+4+1
0015fa 93fa      	ST   -Y,R31
0015fb 93ea      	ST   -Y,R30
0015fc df10      	RCALL SUBOPT_0x21
0015fd 940e 1872 	CALL __PUTPARD1
0015ff 9508      	RET
                 
                 ;OPTIMIZER ADDED SUBROUTINE, CALLED 3 TIMES, CODE SIZE REDUCTION:1 WORDS
                 SUBOPT_0x49:
001600 81ac      	LDD  R26,Y+4
001601 81bd      	LDD  R27,Y+4+1
001602 940e 183d 	CALL __GETW1P
001604 9508      	RET
                 
                 ;OPTIMIZER ADDED SUBROUTINE, CALLED 4 TIMES, CODE SIZE REDUCTION:3 WORDS
                 SUBOPT_0x4A:
001605 01fe      	MOVW R30,R28
001606 9671      	ADIW R30,17
001607 93fa      	ST   -Y,R31
001608 93ea      	ST   -Y,R30
001609 9508      	RET
                 
                 ;OPTIMIZER ADDED SUBROUTINE, CALLED 2 TIMES, CODE SIZE REDUCTION:2 WORDS
                 SUBOPT_0x4B:
                +
00160a 85af     +LDD R26 , Y + 15
00160b 89b8     +LDD R27 , Y + 15 + 1
00160c 8989     +LDD R24 , Y + 15 + 2
00160d 899a     +LDD R25 , Y + 15 + 3
                 	__GETD2S 15
00160e 940e 0b8f 	CALL _check_fs_G003
001610 2f1e      	MOV  R17,R30
001611 9508      	RET
                 
                 ;OPTIMIZER ADDED SUBROUTINE, CALLED 2 TIMES, CODE SIZE REDUCTION:1 WORDS
                 SUBOPT_0x4C:
                +
001612 85ef     +LDD R30 , Y + 15
001613 89f8     +LDD R31 , Y + 15 + 1
001614 8969     +LDD R22 , Y + 15 + 2
001615 897a     +LDD R23 , Y + 15 + 3
                 	__GETD1S 15
001616 940e 1872 	CALL __PUTPARD1
001618 9508      	RET
                 
                 ;OPTIMIZER ADDED SUBROUTINE, CALLED 3 TIMES, CODE SIZE REDUCTION:1 WORDS
                 SUBOPT_0x4D:
                +
001619 87e9     +STD Y + 9 , R30
00161a 87fa     +STD Y + 9 + 1 , R31
00161b 876b     +STD Y + 9 + 2 , R22
00161c 877c     +STD Y + 9 + 3 , R23
                 	__PUTD1S 9
00161d 9508      	RET
                 
                 ;OPTIMIZER ADDED SUBROUTINE, CALLED 3 TIMES, CODE SIZE REDUCTION:1 WORDS
                 SUBOPT_0x4E:
                +
00161e 85e9     +LDD R30 , Y + 9
00161f 85fa     +LDD R31 , Y + 9 + 1
001620 856b     +LDD R22 , Y + 9 + 2
001621 857c     +LDD R23 , Y + 9 + 3
                 	__GETD1S 9
001622 9508      	RET
                 
                 ;OPTIMIZER ADDED SUBROUTINE, CALLED 2 TIMES, CODE SIZE REDUCTION:1 WORDS
                 SUBOPT_0x4F:
001623 01fe      	MOVW R30,R28
001624 967f      	ADIW R30,31
001625 973d      	SBIW R30,13
001626 01df      	MOVW R26,R30
001627 940e 183d 	CALL __GETW1P
001629 9508      	RET
                 
                 ;OPTIMIZER ADDED SUBROUTINE, CALLED 2 TIMES, CODE SIZE REDUCTION:2 WORDS
                 SUBOPT_0x50:
00162a a9ed      	LDD  R30,Y+53
00162b a9fe      	LDD  R31,Y+53+1
00162c 81a4      	LDD  R26,Z+4
00162d 81b5      	LDD  R27,Z+5
00162e 01fd      	MOVW R30,R26
00162f 940e 17bf 	CALL __LSRW4
001631 9508      	RET
                 
                 ;OPTIMIZER ADDED SUBROUTINE, CALLED 4 TIMES, CODE SIZE REDUCTION:3 WORDS
                 SUBOPT_0x51:
001632 81e1      	LDD  R30,Z+1
001633 e0f0      	LDI  R31,0
001634 940e 17d7 	CALL __CWD1
001636 9508      	RET
                 
                 ;OPTIMIZER ADDED SUBROUTINE, CALLED 2 TIMES, CODE SIZE REDUCTION:5 WORDS
                 SUBOPT_0x52:
001637 a9ed      	LDD  R30,Y+53
001638 a9fe      	LDD  R31,Y+53+1
                +
001639 85a4     +LDD R26 , Z + 12
00163a 85b5     +LDD R27 , Z + 12 + 1
00163b 8586     +LDD R24 , Z + 12 + 2
00163c 8597     +LDD R25 , Z + 12 + 3
                 	__GETD2Z 12
00163d dfe0      	RCALL SUBOPT_0x4E
00163e 940e 1788 	CALL __ADDD12
001640 9508      	RET
                 
                 ;OPTIMIZER ADDED SUBROUTINE, CALLED 3 TIMES, CODE SIZE REDUCTION:9 WORDS
                 SUBOPT_0x53:
001641 01fe      	MOVW R30,R28
001642 9634      	ADIW R30,4
                +
001643 01d9     +MOVW R26 , R18
001644 9616     +ADIW R26 , 6
001645 93ed     +ST X + , R30
001646 93fc     +ST X , R31
                 	__PUTW1RNS 18,6
001647 01fe      	MOVW R30,R28
001648 96b4      	ADIW R30,36
001649 9508      	RET
                 
                 ;OPTIMIZER ADDED SUBROUTINE, CALLED 2 TIMES, CODE SIZE REDUCTION:7 WORDS
                 SUBOPT_0x54:
00164a 8de8      	LDD  R30,Y+24
00164b 8df9      	LDD  R31,Y+24+1
00164c 2766      	CLR  R22
00164d 2777      	CLR  R23
00164e 940e 17d2 	CALL __LSLD16
001650 01df      	MOVW R26,R30
001651 01cb      	MOVW R24,R22
001652 8dee      	LDD  R30,Y+30
001653 8dff      	LDD  R31,Y+30+1
001654 cf9e      	RJMP SUBOPT_0x47
                 
                 ;OPTIMIZER ADDED SUBROUTINE, CALLED 6 TIMES, CODE SIZE REDUCTION:17 WORDS
                 SUBOPT_0x55:
001655 81ee      	LDD  R30,Y+6
001656 81ff      	LDD  R31,Y+6+1
                +
001657 8da0     +LDD R26 , Z + 24
001658 8db1     +LDD R27 , Z + 24 + 1
001659 8d82     +LDD R24 , Z + 24 + 2
00165a 8d93     +LDD R25 , Z + 24 + 3
                 	__GETD2Z 24
00165b 9508      	RET
                 
                 ;OPTIMIZER ADDED SUBROUTINE, CALLED 2 TIMES, CODE SIZE REDUCTION:3 WORDS
                 SUBOPT_0x56:
                +
00165c e0e0     +LDI R30 , LOW ( 0x200 )
00165d e0f2     +LDI R31 , HIGH ( 0x200 )
00165e e060     +LDI R22 , BYTE3 ( 0x200 )
00165f e070     +LDI R23 , BYTE4 ( 0x200 )
                 	__GETD1N 0x200
001660 940e 1814 	CALL __DIVD21U
001662 01df      	MOVW R26,R30
001663 01cb      	MOVW R24,R22
001664 9508      	RET
                 
                 ;OPTIMIZER ADDED SUBROUTINE, CALLED 2 TIMES, CODE SIZE REDUCTION:1 WORDS
                 SUBOPT_0x57:
001665 81ee      	LDD  R30,Y+6
001666 81ff      	LDD  R31,Y+6+1
                +
001667 a1a4     +LDD R26 , Z + 36
001668 a1b5     +LDD R27 , Z + 36 + 1
001669 a186     +LDD R24 , Z + 36 + 2
00166a a197     +LDD R25 , Z + 36 + 3
                 	__GETD2Z 36
00166b 9508      	RET
                 
                 ;OPTIMIZER ADDED SUBROUTINE, CALLED 3 TIMES, CODE SIZE REDUCTION:5 WORDS
                 SUBOPT_0x58:
00166c 9613      	ADIW R26,3
00166d 91ec      	LD   R30,X
00166e 5fef      	SUBI R30,-LOW(1)
00166f 93ec      	ST   X,R30
001670 50e1      	SUBI R30,LOW(1)
001671 e0f0      	LDI  R31,0
001672 9508      	RET
                 
                 ;OPTIMIZER ADDED SUBROUTINE, CALLED 3 TIMES, CODE SIZE REDUCTION:1 WORDS
                 SUBOPT_0x59:
001673 940e 17d7 	CALL __CWD1
001675 940e 1788 	CALL __ADDD12
001677 9508      	RET
                 
                 ;OPTIMIZER ADDED SUBROUTINE, CALLED 4 TIMES, CODE SIZE REDUCTION:3 WORDS
                 SUBOPT_0x5A:
001678 8da0      	LDD  R26,Z+24
001679 8db1      	LDD  R27,Z+25
00167a 01fd      	MOVW R30,R26
00167b 70f1      	ANDI R31,HIGH(0x1FF)
00167c 9508      	RET
                 
                 ;OPTIMIZER ADDED SUBROUTINE, CALLED 4 TIMES, CODE SIZE REDUCTION:6 WORDS
                 SUBOPT_0x5B:
00167d 9678      	ADIW R30,24
00167e 010f      	MOVW R0,R30
00167f 01df      	MOVW R26,R30
001680 940e 1841 	CALL __GETD1P
001682 9508      	RET
                 
                 ;OPTIMIZER ADDED SUBROUTINE, CALLED 3 TIMES, CODE SIZE REDUCTION:1 WORDS
                 SUBOPT_0x5C:
001683 9612      	ADIW R26,2
001684 e0e0      	LDI  R30,LOW(0)
001685 93ec      	ST   X,R30
001686 e0e1      	LDI  R30,LOW(1)
001687 9508      	RET
                 
                 ;OPTIMIZER ADDED SUBROUTINE, CALLED 3 TIMES, CODE SIZE REDUCTION:3 WORDS
                 SUBOPT_0x5D:
001688 01fa      	MOVW R30,R20
                +
001689 8da0     +LDD R26 , Z + 24
00168a 8db1     +LDD R27 , Z + 24 + 1
00168b 8d82     +LDD R24 , Z + 24 + 2
00168c 8d93     +LDD R25 , Z + 24 + 3
                 	__GETD2Z 24
00168d 9508      	RET
                 
                 ;OPTIMIZER ADDED SUBROUTINE, CALLED 4 TIMES, CODE SIZE REDUCTION:3 WORDS
                 SUBOPT_0x5E:
                +
00168e 87ee     +STD Y + 14 , R30
00168f 87ff     +STD Y + 14 + 1 , R31
001690 8b68     +STD Y + 14 + 2 , R22
001691 8b79     +STD Y + 14 + 3 , R23
                 	__PUTD1S 14
001692 9508      	RET
                 
                 ;OPTIMIZER ADDED SUBROUTINE, CALLED 3 TIMES, CODE SIZE REDUCTION:1 WORDS
                 SUBOPT_0x5F:
                +
001693 85ee     +LDD R30 , Y + 14
001694 85ff     +LDD R31 , Y + 14 + 1
001695 8968     +LDD R22 , Y + 14 + 2
001696 8979     +LDD R23 , Y + 14 + 3
                 	__GETD1S 14
001697 9508      	RET
                 
                 ;OPTIMIZER ADDED SUBROUTINE, CALLED 2 TIMES, CODE SIZE REDUCTION:2 WORDS
                 SUBOPT_0x60:
                +
001698 01fe     +MOVW R30 , R28
001699 5fe4     +SUBI R30 , LOW ( - 524 )
00169a 4ffd     +SBCI R31 , HIGH ( - 524 )
00169b 9001     +LD R0 , Z +
00169c 81f0     +LD R31 , Z
00169d 2de0     +MOV R30 , R0
                 	__GETW1SX 524
00169e 70f1      	ANDI R31,HIGH(0x1FF)
00169f 9508      	RET
                 
                 ;OPTIMIZER ADDED SUBROUTINE, CALLED 2 TIMES, CODE SIZE REDUCTION:1 WORDS
                 SUBOPT_0x61:
                +
0016a0 01de     +MOVW R26 , R28
0016a1 5fa6     +SUBI R26 , LOW ( - 522 )
0016a2 4fbd     +SBCI R27 , HIGH ( - 522 )
0016a3 900d     +LD R0 , X +
0016a4 91bc     +LD R27 , X
0016a5 2da0     +MOV R26 , R0
                 	__GETW2SX 522
0016a6 9508      	RET
                 
                 ;OPTIMIZER ADDED SUBROUTINE, CALLED 5 TIMES, CODE SIZE REDUCTION:13 WORDS
                 SUBOPT_0x62:
                +
0016a7 01de     +MOVW R26 , R28
0016a8 5fa4     +SUBI R26 , LOW ( - 524 )
0016a9 4fbd     +SBCI R27 , HIGH ( - 524 )
0016aa 900d     +LD R0 , X +
0016ab 91bc     +LD R27 , X
0016ac 2da0     +MOV R26 , R0
                 	__GETW2SX 524
0016ad 9508      	RET
                 
                 ;OPTIMIZER ADDED SUBROUTINE, CALLED 4 TIMES, CODE SIZE REDUCTION:21 WORDS
                 SUBOPT_0x63:
0016ae 01fe      	MOVW R30,R28
0016af 9638      	ADIW R30,8
0016b0 93fa      	ST   -Y,R31
0016b1 93ea      	ST   -Y,R30
0016b2 e0e0      	LDI  R30,LOW(512)
0016b3 e0f2      	LDI  R31,HIGH(512)
0016b4 93fa      	ST   -Y,R31
0016b5 93ea      	ST   -Y,R30
0016b6 cff0      	RJMP SUBOPT_0x62
                 
                 ;OPTIMIZER ADDED SUBROUTINE, CALLED 2 TIMES, CODE SIZE REDUCTION:13 WORDS
                 SUBOPT_0x64:
0016b7 01f9      	MOVW R30,R18
0016b8 01de      	MOVW R26,R28
0016b9 9618      	ADIW R26,8
0016ba 0fea      	ADD  R30,R26
0016bb 1ffb      	ADC  R31,R27
0016bc 01bf      	MOVW R22,R30
0016bd 01fa      	MOVW R30,R20
                +
0016be 01de     +MOVW R26 , R28
0016bf 5fa2     +SUBI R26 , LOW ( - 526 )
0016c0 4fbd     +SBCI R27 , HIGH ( - 526 )
0016c1 900d     +LD R0 , X +
0016c2 91bc     +LD R27 , X
0016c3 2da0     +MOV R26 , R0
                 	__GETW2SX 526
0016c4 0fae      	ADD  R26,R30
0016c5 1fbf      	ADC  R27,R31
0016c6 91ec      	LD   R30,X
0016c7 01db      	MOVW R26,R22
0016c8 93ec      	ST   X,R30
0016c9 9508      	RET
                 
                 ;OPTIMIZER ADDED SUBROUTINE, CALLED 2 TIMES, CODE SIZE REDUCTION:2 WORDS
                 SUBOPT_0x65:
                +
0016ca 50a0     +SUBI R26 , LOW ( 512 )
0016cb 40b2     +SBCI R27 , HIGH ( 512 )
0016cc 4080     +SBCI R24 , BYTE3 ( 512 )
0016cd 4090     +SBCI R25 , BYTE4 ( 512 )
                 	__SUBD2N 512
0016ce 940e 0fa5 	CALL _pf_lseek
0016d0 2f1e      	MOV  R17,R30
0016d1 9508      	RET
                 
                 ;OPTIMIZER ADDED SUBROUTINE, CALLED 2 TIMES, CODE SIZE REDUCTION:1 WORDS
                 SUBOPT_0x66:
0016d2 940e 1841 	CALL __GETD1P
                +
0016d4 89aa     +LDD R26 , Y + 18
0016d5 89bb     +LDD R27 , Y + 18 + 1
0016d6 898c     +LDD R24 , Y + 18 + 2
0016d7 899d     +LDD R25 , Y + 18 + 3
                 	__GETD2S 18
0016d8 9508      	RET
                 
                 ;OPTIMIZER ADDED SUBROUTINE, CALLED 4 TIMES, CODE SIZE REDUCTION:3 WORDS
                 SUBOPT_0x67:
                +
0016d9 89aa     +LDD R26 , Y + 18
0016da 89bb     +LDD R27 , Y + 18 + 1
0016db 898c     +LDD R24 , Y + 18 + 2
0016dc 899d     +LDD R25 , Y + 18 + 3
                 	__GETD2S 18
0016dd 9508      	RET
                 
                 ;OPTIMIZER ADDED SUBROUTINE, CALLED 3 TIMES, CODE SIZE REDUCTION:1 WORDS
                 SUBOPT_0x68:
                +
0016de 89ea     +LDD R30 , Y + 18
0016df 89fb     +LDD R31 , Y + 18 + 1
0016e0 896c     +LDD R22 , Y + 18 + 2
0016e1 897d     +LDD R23 , Y + 18 + 3
                 	__GETD1S 18
0016e2 9508      	RET
                 
                 ;OPTIMIZER ADDED SUBROUTINE, CALLED 2 TIMES, CODE SIZE REDUCTION:5 WORDS
                 SUBOPT_0x69:
                +
0016e3 50e1     +SUBI R30 , LOW ( 1 )
0016e4 40f0     +SBCI R31 , HIGH ( 1 )
0016e5 4060     +SBCI R22 , BYTE3 ( 1 )
0016e6 4070     +SBCI R23 , BYTE4 ( 1 )
                 	__SUBD1N 1
0016e7 01df      	MOVW R26,R30
0016e8 01cb      	MOVW R24,R22
0016e9 de02      	RCALL SUBOPT_0x1C
0016ea 940e 1814 	CALL __DIVD21U
0016ec 9508      	RET
                 
                 ;OPTIMIZER ADDED SUBROUTINE, CALLED 5 TIMES, CODE SIZE REDUCTION:5 WORDS
                 SUBOPT_0x6A:
                +
0016ed 50e1     +SUBI R30 , LOW ( 1 )
0016ee 40f0     +SBCI R31 , HIGH ( 1 )
0016ef 4060     +SBCI R22 , BYTE3 ( 1 )
0016f0 4070     +SBCI R23 , BYTE4 ( 1 )
                 	__SUBD1N 1
0016f1 9508      	RET
                 
                 ;OPTIMIZER ADDED SUBROUTINE, CALLED 2 TIMES, CODE SIZE REDUCTION:2 WORDS
                 SUBOPT_0x6B:
0016f2 dfa0      	RCALL SUBOPT_0x5F
                +
0016f3 01d8     +MOVW R26 , R16
0016f4 9694     +ADIW R26 , 36
0016f5 940e 184c+CALL __PUTDP1
                 	__PUTD1RNS 16,36
0016f7 9508      	RET
                 
                 ;OPTIMIZER ADDED SUBROUTINE, CALLED 2 TIMES, CODE SIZE REDUCTION:1 WORDS
                 SUBOPT_0x6C:
0016f8 a9ea      	LDD  R30,Y+50
0016f9 a9fb      	LDD  R31,Y+50+1
0016fa 93fa      	ST   -Y,R31
0016fb 93ea      	ST   -Y,R30
0016fc a9aa      	LDD  R26,Y+50
0016fd a9bb      	LDD  R27,Y+50+1
0016fe 9508      	RET
                 
                 ;OPTIMIZER ADDED SUBROUTINE, CALLED 4 TIMES, CODE SIZE REDUCTION:6 WORDS
                 SUBOPT_0x6D:
0016ff 01fe      	MOVW R30,R28
001700 5fea      	SUBI R30,LOW(-(518))
001701 4ffd      	SBCI R31,HIGH(-(518))
001702 93fa      	ST   -Y,R31
001703 93ea      	ST   -Y,R30
001704 9508      	RET
                 
                 ;OPTIMIZER ADDED SUBROUTINE, CALLED 2 TIMES, CODE SIZE REDUCTION:5 WORDS
                 SUBOPT_0x6E:
                +
001705 01de     +MOVW R26 , R28
001706 5cae     +SUBI R26 , LOW ( - 562 )
001707 4fbd     +SBCI R27 , HIGH ( - 562 )
001708 900d     +LD R0 , X +
001709 91bc     +LD R27 , X
00170a 2da0     +MOV R26 , R0
                 	__GETW2SX 562
00170b 940e 108a 	CALL _pf_opendir
00170d 2f1e      	MOV  R17,R30
00170e 3010      	CPI  R17,0
00170f 9508      	RET
                 
                 ;OPTIMIZER ADDED SUBROUTINE, CALLED 2 TIMES, CODE SIZE REDUCTION:1 WORDS
                 SUBOPT_0x6F:
                +
001710 01de     +MOVW R26 , R28
001711 5da2     +SUBI R26 , LOW ( - 558 )
001712 4fbd     +SBCI R27 , HIGH ( - 558 )
001713 900d     +LD R0 , X +
001714 91bc     +LD R27 , X
001715 2da0     +MOV R26 , R0
                 	__GETW2SX 558
001716 9508      	RET
                 
                 ;OPTIMIZER ADDED SUBROUTINE, CALLED 2 TIMES, CODE SIZE REDUCTION:2 WORDS
                 SUBOPT_0x70:
001717 01de      	MOVW R26,R28
001718 5ea8      	SUBI R26,LOW(-(536))
001719 4fbd      	SBCI R27,HIGH(-(536))
00171a 940e 10ba 	CALL _pf_readdir
00171c 2f1e      	MOV  R17,R30
00171d 3010      	CPI  R17,0
00171e 9508      	RET
                 
                 ;OPTIMIZER ADDED SUBROUTINE, CALLED 2 TIMES, CODE SIZE REDUCTION:3 WORDS
                 SUBOPT_0x71:
00171f 01fe      	MOVW R30,R28
001720 5eea      	SUBI R30,LOW(-(534))
001721 4ffd      	SBCI R31,HIGH(-(534))
001722 9639      	ADIW R30,9
001723 0fe4      	ADD  R30,R20
001724 1ff5      	ADC  R31,R21
001725 8010      	LD   R1,Z
001726 01fa      	MOVW R30,R20
001727 9508      	RET
                 
                 ;OPTIMIZER ADDED SUBROUTINE, CALLED 2 TIMES, CODE SIZE REDUCTION:2 WORDS
                 SUBOPT_0x72:
001728 01fe      	MOVW R30,R28
001729 5fe8      	SUBI R30,LOW(-(520))
00172a 4ffd      	SBCI R31,HIGH(-(520))
00172b 963c      	ADIW R30,12
00172c 01df      	MOVW R26,R30
00172d 940e 1841 	CALL __GETD1P
00172f 9508      	RET
                 
                 ;OPTIMIZER ADDED SUBROUTINE, CALLED 3 TIMES, CODE SIZE REDUCTION:5 WORDS
                 SUBOPT_0x73:
                +
001730 01de     +MOVW R26 , R28
001731 5da4     +SUBI R26 , LOW ( - 556 )
001732 4fbd     +SBCI R27 , HIGH ( - 556 )
001733 900d     +LD R0 , X +
001734 91bc     +LD R27 , X
001735 2da0     +MOV R26 , R0
                 	__GETW2SX 556
001736 9508      	RET
                 
                 ;OPTIMIZER ADDED SUBROUTINE, CALLED 2 TIMES, CODE SIZE REDUCTION:11 WORDS
                 SUBOPT_0x74:
                +
001737 01fe     +MOVW R30 , R28
001738 5fea     +SUBI R30 , LOW ( - 518 )
001739 4ffd     +SBCI R31 , HIGH ( - 518 )
00173a 9001     +LD R0 , Z +
00173b 81f0     +LD R31 , Z
00173c 2de0     +MOV R30 , R0
                 	__GETW1SX 518
00173d 9731      	SBIW R30,1
00173e 0fee      	LSL  R30
00173f 1fff      	ROL  R31
001740 940e 17b6 	CALL __LSLW4
001742 70f1      	ANDI R31,HIGH(0x1FF)
001743 0fe4      	ADD  R30,R20
001744 1ff5      	ADC  R31,R21
001745 01de      	MOVW R26,R28
001746 9616      	ADIW R26,6
001747 9508      	RET
                 
                 ;OPTIMIZER ADDED SUBROUTINE, CALLED 3 TIMES, CODE SIZE REDUCTION:1 WORDS
                 SUBOPT_0x75:
001748 940e 0743 	CALL _disk_writep
00174a 2f1e      	MOV  R17,R30
00174b 3010      	CPI  R17,0
00174c 9508      	RET
                 
                 ;OPTIMIZER ADDED SUBROUTINE, CALLED 3 TIMES, CODE SIZE REDUCTION:9 WORDS
                 SUBOPT_0x76:
00174d 940e 1847 	CALL __GETD1P_INC
00174f de18      	RCALL SUBOPT_0x30
001750 940e 1851 	CALL __PUTDP1_DEC
001752 cf9a      	RJMP SUBOPT_0x6A
                 
                 ;OPTIMIZER ADDED SUBROUTINE, CALLED 5 TIMES, CODE SIZE REDUCTION:13 WORDS
                 SUBOPT_0x77:
001753 932a      	ST   -Y,R18
001754 85af      	LDD  R26,Y+15
001755 89b8      	LDD  R27,Y+15+1
001756 89e9      	LDD  R30,Y+17
001757 89fa      	LDD  R31,Y+17+1
001758 9509      	ICALL
001759 9508      	RET
                 
                 ;OPTIMIZER ADDED SUBROUTINE, CALLED 5 TIMES, CODE SIZE REDUCTION:9 WORDS
                 SUBOPT_0x78:
00175a 89ea      	LDD  R30,Y+18
00175b 89fb      	LDD  R31,Y+18+1
00175c 9734      	SBIW R30,4
00175d 8bea      	STD  Y+18,R30
00175e 8bfb      	STD  Y+18+1,R31
00175f 9508      	RET
                 
                 ;OPTIMIZER ADDED SUBROUTINE, CALLED 3 TIMES, CODE SIZE REDUCTION:3 WORDS
                 SUBOPT_0x79:
001760 85af      	LDD  R26,Y+15
001761 89b8      	LDD  R27,Y+15+1
001762 89e9      	LDD  R30,Y+17
001763 89fa      	LDD  R31,Y+17+1
001764 9509      	ICALL
001765 9508      	RET
                 
                 ;OPTIMIZER ADDED SUBROUTINE, CALLED 3 TIMES, CODE SIZE REDUCTION:3 WORDS
                 SUBOPT_0x7A:
001766 89aa      	LDD  R26,Y+18
001767 89bb      	LDD  R27,Y+18+1
001768 9614      	ADIW R26,4
001769 940e 183d 	CALL __GETW1P
00176b 9508      	RET
                 
                 ;OPTIMIZER ADDED SUBROUTINE, CALLED 2 TIMES, CODE SIZE REDUCTION:1 WORDS
                 SUBOPT_0x7B:
00176c 940e 1395 	CALL __lcd_write_data
00176e e0a3      	LDI  R26,LOW(3)
00176f e0b0      	LDI  R27,0
001770 940c 177a 	JMP  _delay_ms
                 
                 ;OPTIMIZER ADDED SUBROUTINE, CALLED 3 TIMES, CODE SIZE REDUCTION:7 WORDS
                 SUBOPT_0x7C:
001772 e3a0      	LDI  R26,LOW(48)
001773 940e 1381 	CALL __lcd_write_nibble_G103
                +
001775 ef8a     +LDI R24 , LOW ( 250 )
001776 e090     +LDI R25 , HIGH ( 250 )
                +__DELAY_USW_LOOP :
001777 9701     +SBIW R24 , 1
001778 f7f1     +BRNE __DELAY_USW_LOOP
                 	__DELAY_USW 250
001779 9508      	RET
                 
                 
                 	.CSEG
                 _delay_ms:
00177a 9610      	adiw r26,0
00177b f039      	breq __delay_ms1
                 __delay_ms0:
                +
00177c ec84     +LDI R24 , LOW ( 0x9C4 )
00177d e099     +LDI R25 , HIGH ( 0x9C4 )
                +__DELAY_USW_LOOP :
00177e 9701     +SBIW R24 , 1
00177f f7f1     +BRNE __DELAY_USW_LOOP
                 	__DELAY_USW 0x9C4
001780 95a8      	wdr
001781 9711      	sbiw r26,1
001782 f7c9      	brne __delay_ms0
                 __delay_ms1:
001783 9508      	ret
                 
                 __ADDW2R15:
001784 2400      	CLR  R0
001785 0daf      	ADD  R26,R15
001786 1db0      	ADC  R27,R0
001787 9508      	RET
                 
                 __ADDD12:
001788 0fea      	ADD  R30,R26
001789 1ffb      	ADC  R31,R27
00178a 1f68      	ADC  R22,R24
00178b 1f79      	ADC  R23,R25
00178c 9508      	RET
                 
                 __ADDD21:
00178d 0fae      	ADD  R26,R30
00178e 1fbf      	ADC  R27,R31
00178f 1f86      	ADC  R24,R22
001790 1f97      	ADC  R25,R23
001791 9508      	RET
                 
                 __SUBD12:
001792 1bea      	SUB  R30,R26
001793 0bfb      	SBC  R31,R27
001794 0b68      	SBC  R22,R24
001795 0b79      	SBC  R23,R25
001796 9508      	RET
                 
                 __SUBD21:
001797 1bae      	SUB  R26,R30
001798 0bbf      	SBC  R27,R31
001799 0b86      	SBC  R24,R22
00179a 0b97      	SBC  R25,R23
00179b 9508      	RET
                 
                 __ANDD12:
00179c 23ea      	AND  R30,R26
00179d 23fb      	AND  R31,R27
00179e 2368      	AND  R22,R24
00179f 2379      	AND  R23,R25
0017a0 9508      	RET
                 
                 __ORD12:
0017a1 2bea      	OR   R30,R26
0017a2 2bfb      	OR   R31,R27
0017a3 2b68      	OR   R22,R24
0017a4 2b79      	OR   R23,R25
0017a5 9508      	RET
                 
                 __ANEGW1:
0017a6 95f1      	NEG  R31
0017a7 95e1      	NEG  R30
0017a8 40f0      	SBCI R31,0
0017a9 9508      	RET
                 
                 __LSRD12:
0017aa 23ee      	TST  R30
0017ab 2e0e      	MOV  R0,R30
0017ac 01fd      	MOVW R30,R26
0017ad 01bc      	MOVW R22,R24
0017ae f031      	BREQ __LSRD12R
                 __LSRD12L:
0017af 9576      	LSR  R23
0017b0 9567      	ROR  R22
0017b1 95f7      	ROR  R31
0017b2 95e7      	ROR  R30
0017b3 940a      	DEC  R0
0017b4 f7d1      	BRNE __LSRD12L
                 __LSRD12R:
0017b5 9508      	RET
                 
                 __LSLW4:
0017b6 0fee      	LSL  R30
0017b7 1fff      	ROL  R31
                 __LSLW3:
0017b8 0fee      	LSL  R30
0017b9 1fff      	ROL  R31
                 __LSLW2:
0017ba 0fee      	LSL  R30
0017bb 1fff      	ROL  R31
0017bc 0fee      	LSL  R30
0017bd 1fff      	ROL  R31
0017be 9508      	RET
                 
                 __LSRW4:
0017bf 95f6      	LSR  R31
0017c0 95e7      	ROR  R30
                 __LSRW3:
0017c1 95f6      	LSR  R31
0017c2 95e7      	ROR  R30
                 __LSRW2:
0017c3 95f6      	LSR  R31
0017c4 95e7      	ROR  R30
0017c5 95f6      	LSR  R31
0017c6 95e7      	ROR  R30
0017c7 9508      	RET
                 
                 __LSLD1:
0017c8 0fee      	LSL  R30
0017c9 1fff      	ROL  R31
0017ca 1f66      	ROL  R22
0017cb 1f77      	ROL  R23
0017cc 9508      	RET
                 
                 __LSRD16:
0017cd 2fe6      	MOV  R30,R22
0017ce 2ff7      	MOV  R31,R23
0017cf e060      	LDI  R22,0
0017d0 e070      	LDI  R23,0
0017d1 9508      	RET
                 
                 __LSLD16:
0017d2 2f6e      	MOV  R22,R30
0017d3 2f7f      	MOV  R23,R31
0017d4 e0e0      	LDI  R30,0
0017d5 e0f0      	LDI  R31,0
0017d6 9508      	RET
                 
                 __CWD1:
0017d7 2f6f      	MOV  R22,R31
0017d8 0f66      	ADD  R22,R22
0017d9 0b66      	SBC  R22,R22
0017da 2f76      	MOV  R23,R22
0017db 9508      	RET
                 
                 __COMD1:
0017dc 95e0      	COM  R30
0017dd 95f0      	COM  R31
0017de 9560      	COM  R22
0017df 9570      	COM  R23
0017e0 9508      	RET
                 
                 __MULD12U:
0017e1 9f7a      	MUL  R23,R26
0017e2 2d70      	MOV  R23,R0
0017e3 9f6b      	MUL  R22,R27
0017e4 0d70      	ADD  R23,R0
0017e5 9ff8      	MUL  R31,R24
0017e6 0d70      	ADD  R23,R0
0017e7 9fe9      	MUL  R30,R25
0017e8 0d70      	ADD  R23,R0
0017e9 9f6a      	MUL  R22,R26
0017ea 2d60      	MOV  R22,R0
0017eb 0d71      	ADD  R23,R1
0017ec 9ffb      	MUL  R31,R27
0017ed 0d60      	ADD  R22,R0
0017ee 1d71      	ADC  R23,R1
0017ef 9fe8      	MUL  R30,R24
0017f0 0d60      	ADD  R22,R0
0017f1 1d71      	ADC  R23,R1
0017f2 2788      	CLR  R24
0017f3 9ffa      	MUL  R31,R26
0017f4 2df0      	MOV  R31,R0
0017f5 0d61      	ADD  R22,R1
0017f6 1f78      	ADC  R23,R24
0017f7 9feb      	MUL  R30,R27
0017f8 0df0      	ADD  R31,R0
0017f9 1d61      	ADC  R22,R1
0017fa 1f78      	ADC  R23,R24
0017fb 9fea      	MUL  R30,R26
0017fc 2de0      	MOV  R30,R0
0017fd 0df1      	ADD  R31,R1
0017fe 1f68      	ADC  R22,R24
0017ff 1f78      	ADC  R23,R24
001800 9508      	RET
                 
                 __DIVW21U:
001801 2400      	CLR  R0
001802 2411      	CLR  R1
001803 e190      	LDI  R25,16
                 __DIVW21U1:
001804 0faa      	LSL  R26
001805 1fbb      	ROL  R27
001806 1c00      	ROL  R0
001807 1c11      	ROL  R1
001808 1a0e      	SUB  R0,R30
001809 0a1f      	SBC  R1,R31
00180a f418      	BRCC __DIVW21U2
00180b 0e0e      	ADD  R0,R30
00180c 1e1f      	ADC  R1,R31
00180d c001      	RJMP __DIVW21U3
                 __DIVW21U2:
00180e 60a1      	SBR  R26,1
                 __DIVW21U3:
00180f 959a      	DEC  R25
001810 f799      	BRNE __DIVW21U1
001811 01fd      	MOVW R30,R26
001812 01d0      	MOVW R26,R0
001813 9508      	RET
                 
                 __DIVD21U:
001814 933f      	PUSH R19
001815 934f      	PUSH R20
001816 935f      	PUSH R21
001817 2400      	CLR  R0
001818 2411      	CLR  R1
001819 2744      	CLR  R20
00181a 2755      	CLR  R21
00181b e230      	LDI  R19,32
                 __DIVD21U1:
00181c 0faa      	LSL  R26
00181d 1fbb      	ROL  R27
00181e 1f88      	ROL  R24
00181f 1f99      	ROL  R25
001820 1c00      	ROL  R0
001821 1c11      	ROL  R1
001822 1f44      	ROL  R20
001823 1f55      	ROL  R21
001824 1a0e      	SUB  R0,R30
001825 0a1f      	SBC  R1,R31
001826 0b46      	SBC  R20,R22
001827 0b57      	SBC  R21,R23
001828 f428      	BRCC __DIVD21U2
001829 0e0e      	ADD  R0,R30
00182a 1e1f      	ADC  R1,R31
00182b 1f46      	ADC  R20,R22
00182c 1f57      	ADC  R21,R23
00182d c001      	RJMP __DIVD21U3
                 __DIVD21U2:
00182e 60a1      	SBR  R26,1
                 __DIVD21U3:
00182f 953a      	DEC  R19
001830 f759      	BRNE __DIVD21U1
001831 01fd      	MOVW R30,R26
001832 01bc      	MOVW R22,R24
001833 01d0      	MOVW R26,R0
001834 01ca      	MOVW R24,R20
001835 915f      	POP  R21
001836 914f      	POP  R20
001837 913f      	POP  R19
001838 9508      	RET
                 
                 __MODD21U:
001839 dfda      	RCALL __DIVD21U
00183a 01fd      	MOVW R30,R26
00183b 01bc      	MOVW R22,R24
00183c 9508      	RET
                 
                 __GETW1P:
00183d 91ed      	LD   R30,X+
00183e 91fc      	LD   R31,X
00183f 9711      	SBIW R26,1
001840 9508      	RET
                 
                 __GETD1P:
001841 91ed      	LD   R30,X+
001842 91fd      	LD   R31,X+
001843 916d      	LD   R22,X+
001844 917c      	LD   R23,X
001845 9713      	SBIW R26,3
001846 9508      	RET
                 
                 __GETD1P_INC:
001847 91ed      	LD   R30,X+
001848 91fd      	LD   R31,X+
001849 916d      	LD   R22,X+
00184a 917d      	LD   R23,X+
00184b 9508      	RET
                 
                 __PUTDP1:
00184c 93ed      	ST   X+,R30
00184d 93fd      	ST   X+,R31
00184e 936d      	ST   X+,R22
00184f 937c      	ST   X,R23
001850 9508      	RET
                 
                 __PUTDP1_DEC:
001851 937e      	ST   -X,R23
001852 936e      	ST   -X,R22
001853 93fe      	ST   -X,R31
001854 93ee      	ST   -X,R30
001855 9508      	RET
                 
                 __GETW1PF:
001856 bf6b      	OUT  RAMPZ,R22
001857 9007      	ELPM R0,Z+
001858 91f6      	ELPM R31,Z
001859 2de0      	MOV  R30,R0
00185a 9508      	RET
                 
                 __GETD1PF:
00185b bf6b      	OUT  RAMPZ,R22
00185c 9007      	ELPM R0,Z+
00185d 9017      	ELPM R1,Z+
00185e 9167      	ELPM R22,Z+
00185f 9176      	ELPM R23,Z
001860 01f0      	MOVW R30,R0
001861 9508      	RET
                 
                 __GETD2PF:
001862 bf6b      	OUT  RAMPZ,R22
001863 91a7      	ELPM R26,Z+
001864 91b7      	ELPM R27,Z+
001865 9187      	ELPM R24,Z+
001866 9196      	ELPM R25,Z
001867 9508      	RET
                 
                 __GETD1S0:
001868 81e8      	LD   R30,Y
001869 81f9      	LDD  R31,Y+1
00186a 816a      	LDD  R22,Y+2
00186b 817b      	LDD  R23,Y+3
00186c 9508      	RET
                 
                 __GETD2S0:
00186d 81a8      	LD   R26,Y
00186e 81b9      	LDD  R27,Y+1
00186f 818a      	LDD  R24,Y+2
001870 819b      	LDD  R25,Y+3
001871 9508      	RET
                 
                 __PUTPARD1:
001872 937a      	ST   -Y,R23
001873 936a      	ST   -Y,R22
001874 93fa      	ST   -Y,R31
001875 93ea      	ST   -Y,R30
001876 9508      	RET
                 
                 __PUTPARD2:
001877 939a      	ST   -Y,R25
001878 938a      	ST   -Y,R24
001879 93ba      	ST   -Y,R27
00187a 93aa      	ST   -Y,R26
00187b 9508      	RET
                 
                 __SWAPD12:
00187c 2e18      	MOV  R1,R24
00187d 2f86      	MOV  R24,R22
00187e 2d61      	MOV  R22,R1
00187f 2e19      	MOV  R1,R25
001880 2f97      	MOV  R25,R23
001881 2d71      	MOV  R23,R1
                 
                 __SWAPW12:
001882 2e1b      	MOV  R1,R27
001883 2fbf      	MOV  R27,R31
001884 2df1      	MOV  R31,R1
                 
                 __SWAPB12:
001885 2e1a      	MOV  R1,R26
001886 2fae      	MOV  R26,R30
001887 2de1      	MOV  R30,R1
001888 9508      	RET
                 
                 __EEPROMRDB:
001889 99e1      	SBIC EECR,EEWE
00188a cffe      	RJMP __EEPROMRDB
00188b 93ff      	PUSH R31
00188c b7ff      	IN   R31,SREG
00188d 94f8      	CLI
00188e bbae      	OUT  EEARL,R26
00188f bbbf      	OUT  EEARH,R27
001890 9ae0      	SBI  EECR,EERE
001891 b3ed      	IN   R30,EEDR
001892 bfff      	OUT  SREG,R31
001893 91ff      	POP  R31
001894 9508      	RET
                 
                 __EEPROMWRD:
001895 d007      	RCALL __EEPROMWRW
001896 9612      	ADIW R26,2
001897 010f      	MOVW R0,R30
001898 01fb      	MOVW R30,R22
001899 d003      	RCALL __EEPROMWRW
00189a 01f0      	MOVW R30,R0
00189b 9712      	SBIW R26,2
00189c 9508      	RET
                 
                 __EEPROMWRW:
00189d d007      	RCALL __EEPROMWRB
00189e 9611      	ADIW R26,1
00189f 93ef      	PUSH R30
0018a0 2fef      	MOV  R30,R31
0018a1 d003      	RCALL __EEPROMWRB
0018a2 91ef      	POP  R30
0018a3 9711      	SBIW R26,1
0018a4 9508      	RET
                 
                 __EEPROMWRB:
0018a5 9be1      	SBIS EECR,EEWE
0018a6 c002      	RJMP __EEPROMWRB1
0018a7 95a8      	WDR
0018a8 cffc      	RJMP __EEPROMWRB
                 __EEPROMWRB1:
0018a9 b79f      	IN   R25,SREG
0018aa 94f8      	CLI
0018ab bbae      	OUT  EEARL,R26
0018ac bbbf      	OUT  EEARH,R27
0018ad 9ae0      	SBI  EECR,EERE
0018ae b38d      	IN   R24,EEDR
0018af 17e8      	CP   R30,R24
0018b0 f019      	BREQ __EEPROMWRB0
0018b1 bbed      	OUT  EEDR,R30
0018b2 9ae2      	SBI  EECR,EEMWE
0018b3 9ae1      	SBI  EECR,EEWE
                 __EEPROMWRB0:
0018b4 bf9f      	OUT  SREG,R25
0018b5 9508      	RET
                 
                 __CPD10:
0018b6 9730      	SBIW R30,0
0018b7 4060      	SBCI R22,0
0018b8 4070      	SBCI R23,0
0018b9 9508      	RET
                 
                 __CPW02:
0018ba 2400      	CLR  R0
0018bb 160a      	CP   R0,R26
0018bc 060b      	CPC  R0,R27
0018bd 9508      	RET
                 
                 __CPD02:
0018be 2400      	CLR  R0
0018bf 160a      	CP   R0,R26
0018c0 060b      	CPC  R0,R27
0018c1 0608      	CPC  R0,R24
0018c2 0609      	CPC  R0,R25
0018c3 9508      	RET
                 
                 __CPD12:
0018c4 17ea      	CP   R30,R26
0018c5 07fb      	CPC  R31,R27
0018c6 0768      	CPC  R22,R24
0018c7 0779      	CPC  R23,R25
0018c8 9508      	RET
                 
                 __CPD21:
0018c9 17ae      	CP   R26,R30
0018ca 07bf      	CPC  R27,R31
0018cb 0786      	CPC  R24,R22
0018cc 0797      	CPC  R25,R23
0018cd 9508      	RET
                 
                 __SAVELOCR6:
0018ce 935a      	ST   -Y,R21
                 __SAVELOCR5:
0018cf 934a      	ST   -Y,R20
                 __SAVELOCR4:
0018d0 933a      	ST   -Y,R19
                 __SAVELOCR3:
0018d1 932a      	ST   -Y,R18
                 __SAVELOCR2:
0018d2 931a      	ST   -Y,R17
0018d3 930a      	ST   -Y,R16
0018d4 9508      	RET
                 
                 __LOADLOCR6:
0018d5 815d      	LDD  R21,Y+5
                 __LOADLOCR5:
0018d6 814c      	LDD  R20,Y+4
                 __LOADLOCR4:
0018d7 813b      	LDD  R19,Y+3
                 __LOADLOCR3:
0018d8 812a      	LDD  R18,Y+2
                 __LOADLOCR2:
0018d9 8119      	LDD  R17,Y+1
0018da 8108      	LD   R16,Y
0018db 9508      	RET
                 
                 __INITLOCB:
                 __INITLOCW:
0018dc 0fac      	ADD  R26,R28
0018dd 1fbd      	ADC  R27,R29
0018de bf6b      	OUT  RAMPZ,R22
                 __INITLOC0:
0018df 9007      	ELPM R0,Z+
0018e0 920d      	ST   X+,R0
0018e1 958a      	DEC  R24
0018e2 f7e1      	BRNE __INITLOC0
0018e3 9508      	RET
                 
                 ;END OF CODE MARKER
                 __END_OF_CODE:


RESOURCE USE INFORMATION
------------------------

Notice:
The register and instruction counts are symbol table hit counts,
and hence implicitly used resources are not counted, eg, the
'lpm' instruction without operands implicitly uses r0 and z,
none of which are counted.

x,y,z are separate entities in the symbol table and are
counted separately from r26..r31 here.

.dseg memory usage only counts static data declared with .byte

ATmega128 register use summary:
r0 : 118 r1 :  31 r2 :   0 r3 :   0 r4 :   0 r5 :   0 r6 :   4 r7 :  18 
r8 :   3 r9 :   0 r10:   1 r11:   0 r12:   1 r13:   0 r14:   0 r15:   4 
r16: 141 r17: 206 r18: 119 r19:  71 r20:  96 r21:  72 r22: 180 r23: 130 
r24: 143 r25:  98 r26: 684 r27: 326 r28: 117 r29:  13 r30:1108 r31: 438 
x  : 161 y  : 907 z  : 136 
Registers used: 27 out of 35 (77.1%)

ATmega128 instruction use summary:
.lds  :   0 .lds.l:   0 .sts  :   0 .sts.l:   0 adc   :  50 add   :  49 
adiw  : 160 and   :   6 andi  :  52 asr   :   0 bclr  :   0 bld   :   0 
brbc  :   0 brbs  :   0 brcc  :   2 brcs  :   0 break :   0 breq  : 107 
brge  :   6 brhc  :   0 brhs  :   0 brid  :   0 brie  :   0 brlo  :  32 
brlt  :   0 brmi  :   0 brne  : 153 brpl  :   2 brsh  :  30 brtc  :   0 
brts  :   1 brvc  :   0 brvs  :   0 bset  :   0 bst   :   0 call  : 686 
cbi   :  17 cbr   :   0 clc   :   0 clh   :   0 cli   :   4 cln   :   0 
clr   :  70 cls   :   0 clt   :   1 clv   :   0 clz   :   0 com   :   6 
cp    :  28 cpc   :  56 cpi   : 164 cpse  :   0 dec   :   9 des   :   0 
elpm  :  26 eor   :   0 fmul  :   0 fmuls :   0 fmulsu:   0 icall :   5 
ijmp  :   0 in    :  13 inc   :   2 jmp   :  51 ld    : 131 ldd   : 618 
ldi   : 588 lds   :  24 lpm   :   0 lsl   :  11 lsr   :   6 mov   : 137 
movw  : 260 mul   :  11 muls  :   0 mulsu :   0 neg   :   2 nop   :   0 
or    :  19 ori   :  10 out   :  39 pop   :  59 push  :  59 rcall : 112 
ret   : 191 reti  :   0 rjmp  : 274 rol   :  20 ror   :   8 sbc   :  22 
sbci  :  92 sbi   :  15 sbic  :   2 sbis  :   4 sbiw  :  77 sbr   :   2 
sbrc  :   2 sbrs  :  12 sec   :   0 seh   :   0 sei   :   1 sen   :   0 
ser   :   0 ses   :   0 set   :   1 sev   :   0 sez   :   0 sleep :   0 
spm   :   0 st    : 284 std   : 145 sts   :  14 sub   :  15 subi  : 102 
swap  :   1 tst   :   8 wdr   :   2 
Instructions used: 67 out of 117 (57.3%)

ATmega128 memory use summary [bytes]:
Segment   Begin    End      Code   Data   Used    Size   Use%
---------------------------------------------------------------
[.cseg] 0x000000 0x0031c8  11886    858  12744  131072   9.7%
[.dseg] 0x000100 0x000b0c      0    492    492    4096  12.0%
[.eseg] 0x000000 0x000111      0    263    263    4096   6.4%

Assembly complete, 0 errors, 13 warnings
